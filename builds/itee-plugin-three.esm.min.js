import{DefaultLogger as e,TBinaryReader as t,Endianness as s,Keys as i,Mouse as r,TDataBaseManager as n}from"itee-client";import{toEnum as o,ringClockwise as a,ringContainsSome as h,degreesToRadians as l}from"itee-utils";import{Shape as c}from"three-full/sources/core/Shape";import{FileLoader as d}from"three-full/sources/loaders/FileLoader";import{DefaultLoadingManager as u}from"three-full/sources/loaders/LoadingManager";import{Vector3 as p}from"three-full/sources/math/Vector3";import{BufferAttribute as m,Float32BufferAttribute as f}from"three-full/sources/core/BufferAttribute";import{BufferGeometry as _}from"three-full/sources/core/BufferGeometry";import{PointsMaterial as g}from"three-full/sources/materials/PointsMaterial";import{Box3 as b}from"three-full/sources/math/Box3";import{Group as w}from"three-full/sources/objects/Group";import{Points as v}from"three-full/sources/objects/Points";import{isNull as y,isUndefined as x,isNotBoolean as E,isEmptyArray as M,isNotDefined as A,isArray as P,isDefined as T,isNotArray as S,isObject as D,isNotString as C,isEmptyString as O,isBlankString as k,isString as I,isNotEmptyString as z,isNotEmptyArray as F}from"itee-validators";import{EventDispatcher as B}from"three-full/sources/core/EventDispatcher";import{Object3D as L}from"three-full/sources/core/Object3D";import{Spherical as G}from"three-full/sources/math/Spherical";import{Vector2 as U}from"three-full/sources/math/Vector2";import{Camera as j}from"three-full/sources/cameras/Camera";import{DoubleSide as H,LinearFilter as R,VertexColors as N}from"three-full/sources/constants";import{Raycaster as X}from"three-full/sources/core/Raycaster";import{BoxBufferGeometry as Y,BoxGeometry as Z}from"three-full/sources/geometries/BoxGeometry";import{ConeBufferGeometry as V,ConeGeometry as W}from"three-full/sources/geometries/ConeGeometry";import{CylinderBufferGeometry as q,CylinderGeometry as $}from"three-full/sources/geometries/CylinderGeometry";import{EdgesGeometry as Q}from"three-full/sources/geometries/EdgesGeometry";import{OctahedronBufferGeometry as K,OctahedronGeometry as J}from"three-full/sources/geometries/OctahedronGeometry";import{PlaneBufferGeometry as ee,PlaneGeometry as te}from"three-full/sources/geometries/PlaneGeometry";import{SphereBufferGeometry as se,SphereGeometry as ie}from"three-full/sources/geometries/SphereGeometry";import{TorusBufferGeometry as re,TorusGeometry as ne}from"three-full/sources/geometries/TorusGeometry";import{LineBasicMaterial as oe}from"three-full/sources/materials/LineBasicMaterial";import{MeshBasicMaterial as ae}from"three-full/sources/materials/MeshBasicMaterial";import{Euler as he}from"three-full/sources/math/Euler";import{Plane as le}from"three-full/sources/math/Plane";import{Quaternion as ce}from"three-full/sources/math/Quaternion";import{Line as de}from"three-full/sources/objects/Line";import{LineSegments as ue}from"three-full/sources/objects/LineSegments";import{Mesh as pe}from"three-full/sources/objects/Mesh";import{CurvePath as me}from"three-full/sources/core/CurvePath";import{Path as fe}from"three-full/sources/core/Path";import{ArcCurve as _e}from"three-full/sources/curves/ArcCurve";import{CatmullRomCurve3 as ge}from"three-full/sources/curves/CatmullRomCurve3";import{CubicBezierCurve as be}from"three-full/sources/curves/CubicBezierCurve";import{CubicBezierCurve3 as we}from"three-full/sources/curves/CubicBezierCurve3";import{Curve as ve}from"three-full/sources/curves/Curve";import{EllipseCurve as ye}from"three-full/sources/curves/EllipseCurve";import{LineCurve as xe}from"three-full/sources/curves/LineCurve";import{LineCurve3 as Ee}from"three-full/sources/curves/LineCurve3";import{QuadraticBezierCurve as Me}from"three-full/sources/curves/QuadraticBezierCurve";import{QuadraticBezierCurve3 as Ae}from"three-full/sources/curves/QuadraticBezierCurve3";import{SplineCurve as Pe}from"three-full/sources/curves/SplineCurve";import{Face3 as Te}from"three-full/sources/core/Face3";import{Geometry as Se}from"three-full/sources/core/Geometry";import{InstancedBufferGeometry as De}from"three-full/sources/core/InstancedBufferGeometry";import{CircleGeometry as Ce,CircleBufferGeometry as Oe}from"three-full/sources/geometries/CircleGeometry";import{DodecahedronGeometry as ke,DodecahedronBufferGeometry as Ie}from"three-full/sources/geometries/DodecahedronGeometry";import{ExtrudeGeometry as ze,ExtrudeBufferGeometry as Fe}from"three-full/sources/geometries/ExtrudeGeometry";import{IcosahedronGeometry as Be,IcosahedronBufferGeometry as Le}from"three-full/sources/geometries/IcosahedronGeometry";import{LatheGeometry as Ge,LatheBufferGeometry as Ue}from"three-full/sources/geometries/LatheGeometry";import{ParametricGeometry as je,ParametricBufferGeometry as He}from"three-full/sources/geometries/ParametricGeometry";import{PolyhedronGeometry as Re,PolyhedronBufferGeometry as Ne}from"three-full/sources/geometries/PolyhedronGeometry";import{RingGeometry as Xe,RingBufferGeometry as Ye}from"three-full/sources/geometries/RingGeometry";import{ShapeGeometry as Ze}from"three-full/sources/geometries/ShapeGeometry";import{TetrahedronGeometry as Ve,TetrahedronBufferGeometry as We}from"three-full/sources/geometries/TetrahedronGeometry";import{TextGeometry as qe,TextBufferGeometry as $e}from"three-full/sources/geometries/TextGeometry";import{TorusKnotGeometry as Qe,TorusKnotBufferGeometry as Ke}from"three-full/sources/geometries/TorusKnotGeometry";import{TubeGeometry as Je,TubeBufferGeometry as et}from"three-full/sources/geometries/TubeGeometry";import{WireframeGeometry as tt}from"three-full/sources/geometries/WireframeGeometry";import{ImageLoader as st}from"three-full/sources/loaders/ImageLoader";import{TextureLoader as it}from"three-full/sources/loaders/TextureLoader";import{MeshLambertMaterial as rt}from"three-full/sources/materials/MeshLambertMaterial";import{MeshPhongMaterial as nt}from"three-full/sources/materials/MeshPhongMaterial";import{Color as ot}from"three-full/sources/math/Color";import{OrthographicCamera as at}from"three-full/sources/cameras/OrthographicCamera";import{PerspectiveCamera as ht}from"three-full/sources/cameras/PerspectiveCamera";import{AmbientLight as lt}from"three-full/sources/lights/AmbientLight";import{DirectionalLight as ct}from"three-full/sources/lights/DirectionalLight";import{HemisphereLight as dt}from"three-full/sources/lights/HemisphereLight";import{PointLight as ut}from"three-full/sources/lights/PointLight";import{RectAreaLight as pt}from"three-full/sources/lights/RectAreaLight";import{SpotLight as mt}from"three-full/sources/lights/SpotLight";import{LineLoop as ft}from"three-full/sources/objects/LineLoop";import{LOD as _t}from"three-full/sources/objects/LOD";import{SkinnedMesh as gt}from"three-full/sources/objects/SkinnedMesh";import{Sprite as bt}from"three-full/sources/objects/Sprite";import{Fog as wt}from"three-full/sources/scenes/Fog";import{FogExp2 as vt}from"three-full/sources/scenes/FogExp2";import{Scene as yt}from"three-full/sources/scenes/Scene";
/**
 * @module Loader/SHPLoader
 * @desc Export SHPLoader to load .shp files
 *
 * @requires {@link https://github.com/Itee/itee-client itee-client}
 * @requires {@link https://github.com/Itee/itee-utils itee-utils}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 * @example Todo...
 *
 */
const xt=o({NullShape:0,Point:1,Polyline:3,Polygon:5,MultiPoint:8,PointZ:11,PolyLineZ:13,PolygonZ:15,MultiPointZ:18,PointM:21,PolylineM:23,PolygonM:25,MultiPointM:28,MultiPatch:31});class Et{constructor(s={}){const i={manager:u,logger:e,reader:new t,globalOffset:new p(0,0,0),worldAxis:{from:"zUp",to:"zForward"},...s};this.manager=i.manager,this.logger=i.logger,this.reader=i.reader,this.globalOffset=i.globalOffset,this.worldAxis=i.worldAxis}get globalOffset(){return this._globalOffset}set globalOffset(e){this._globalOffset=e}get worldAxis(){return this._worldAxis}set worldAxis(e){this._worldAxis=e}get manager(){return this._manager}set manager(e){this._manager=e}get logger(){return this._logger}set logger(e){this._logger=e}get reader(){return this._reader}set reader(e){this._reader=e}setGlobalOffset(e){return this.globalOffset=e,this}setWorldAxis(e){return this.worldAxis=e,this}setManager(e){return this.manager=e,this}setLogger(e){return this.logger=e,this}setReader(e){return this.reader=e,this}load(e,t,s,i){const r=this,n=new d(r.manager);n.setResponseType("arraybuffer"),n.load(e,(e=>{t(r.parse(e))}),s,i)}parse(e){this._reader.setEndianess(s.Big).setBuffer(e);const t=this._parseHeader();if(t.fileCode!==Et.FileCode)return this.logger.error("SHPLoader: Invalide Shape file code !"),null;if(t.fileLength<Et.MinFileLength)return this.logger.error("SHPLoader: Shape file have an incorrect length !"),null;if(!Object.values(xt).includes(t.shapeType))return this.logger.error("SHPLoader: Shape file have an incorrect shape type !"),null;t.version<Et.MinVersion&&this.logger.warn("SHPLoader: Version of shape file below than 1000 could be incorrectly parsed !");const i=this._parseDatas(t);return this._convertToObjects(i)}_parseHeader(){const e=this._reader.getInt32();this._reader.skipOffsetOf(20);const t=this._reader.getInt32();this._reader.setEndianess(s.Little);const i=this._reader.getInt32(),r=this._reader.getInt32(),n=this._reader.getInt32(),o=this._reader.getInt32();return{fileCode:e,fileLength:t,version:i,shapeType:r,boundingBox:{xMin:n,xMax:this._reader.getInt32(),yMin:o,yMax:this._reader.getInt32(),zMin:this._reader.getInt32(),zMax:this._reader.getInt32(),mMin:this._reader.getInt32(),mMax:this._reader.getInt32()}}}_parseDatas(e){this._reader.skipOffsetTo(100);let t,i,r,n=[];for(;!this._reader.isEndOfFile();)switch(t=this._parseRecordHeader(),i=this._reader.getOffset()+2*t.contentLength,this._reader.setEndianess(s.Little),e.shapeType){case xt.NullShape:this._reader.skipOffsetTo(i);break;case xt.Point:case xt.PointZ:case xt.PointM:for(;this._reader.getOffset()<i;)r=this._parsePoint(),r&&n.push(r);break;case xt.Polyline:case xt.PolyLineZ:case xt.PolylineM:for(;this._reader.getOffset()<i;)r=this._parsePolyLine(),r&&n.push(r);break;case xt.Polygon:case xt.PolygonZ:case xt.PolygonM:for(;this._reader.getOffset()<i;)r=this._parsePolyLine(),r&&n.push(r);break;case xt.MultiPoint:case xt.MultiPointZ:case xt.MultiPointM:for(;this._reader.getOffset()<i;)r=this._parseMultiPoint(),r&&n.push(r);break;case xt.MultiPatch:for(;this._reader.getOffset()<i;)r=this._parseMultiPatch(),r&&n.push(r);break;default:this.logger.error(`SHPLoader: Invalid switch parameter: ${e.shapeType}`)}return n}_parseRecordHeader(){this._reader.setEndianess(s.Big);return{recordNumber:this._reader.getInt32(),contentLength:this._reader.getInt32()}}_parseNull(){return this._reader.getInt32(),null}_parsePoint(){const e=this._reader.getInt32();if(e===xt.NullShape)return null;return{shapeType:e,x:this._reader.getFloat64(),y:this._reader.getFloat64()}}_parsePolyLine(){const e=this._reader.getInt32();if(e===xt.NullShape)return null;const t={xMin:this._reader.getFloat64(),yMin:this._reader.getFloat64(),xMax:this._reader.getFloat64(),yMax:this._reader.getFloat64()},s=this._reader.getInt32(),i=this._reader.getInt32(),r=new Array(s);for(let e=0;e<s;e++)r[e]=this._reader.getInt32();const n=new Array(i);for(let e=0;e<i;e++)n[e]={x:this._reader.getFloat64(),y:this._reader.getFloat64()};return{shapeType:e,boundingBox:t,numberOfParts:s,numberOfPoints:i,parts:r,points:n}}_parsePolygon(){const e=this._reader.getInt32();if(e===xt.NullShape)return null;const t={xMin:this._reader.getFloat64(),yMin:this._reader.getFloat64(),xMax:this._reader.getFloat64(),yMax:this._reader.getFloat64()},s=this._reader.getInt32(),i=this._reader.getInt32();let r=new Array(s);for(let e=0;e<s;e++)r[e]=this._reader.getInt32();let n=new Array(i);for(let e=0;e<i;e++)n[e]={x:this._reader.getFloat64(),y:this._reader.getFloat64()};const o=[],l=[];return r.forEach(((e,t)=>{const s=n.slice(e,r[t+1]);a(s)?o.push(s):l.push(s)})),l.forEach((e=>{o.some((t=>{if(h(t[0],e))return t.push(e),!0}))||o.push([e])})),{shapeType:e,boundingBox:t,numberOfParts:s,numberOfPoints:i,parts:r,polygons:o}}_parseMultiPoint(){const e=this._reader.getInt32();if(e===xt.NullShape)return null;const t={xMin:this._reader.getFloat64(),xMax:this._reader.getFloat64(),yMin:this._reader.getFloat64(),yMax:this._reader.getFloat64()},s=this._reader.getInt32(),i=new Array(s);for(let e=0;e<s;e++)i.push([this._reader.getFloat64(),this._reader.getFloat64()]);return{shapeType:e,boundingBox:t,numberOfPoints:s,points:i}}_parseMultiPatch(){const e=this._reader.getInt32();return e===xt.NullShape?null:{shapeType:e}}_convertToObjects(e){let t=[];for(let t=0,r=e.length;t<r;t++){let r=e[t];r.shapeType!==xt.Polygon&&r.shapeType!==xt.PolygonZ&&r.shapeType!==xt.PolygonM||(r.points&&Array.isArray(r.points[0])?s(r.points):i(r.points))}function s(e){for(let t=0,r=e.length;t<r;t++){let r=e[t];r?Array.isArray(r[0])?s(r):i(r):this.logger.log("no array, oups !")}}function i(e){t.push(new c(e))}return t}}Et.FileCode=9994,Et.MinFileLength=100,Et.MinVersion=1e3;
/**
 * @module Loader/DBFLoader
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 * From:
 * https://www.clicketyclick.dk/databases/xbase/format/db2_dbf.html#DBII_DBF_STRUCT
 * http://web.archive.org/web/20150323061445/http://ulisse.elettra.trieste.it/services/doc/dbase/DBFstruct.htm
 * http://www.dbase.com/Knowledgebase/INT/db7_file_fmt.htm
 *
 *
 */
const Mt=o({FoxPro:48,FoxPro_Autoincrement:49,dBASE_II:2,FoxPro_Var:50,dBASE_III_plus:3,dBASE_III_plus_memo:131,dBASE_IV_SQL_table:67,dBASE_IV_SQL_system:99,dBASE_IV_memo:139,dBASE_IV_memo_SQL_table:203,FoxBase:251,dBase_v_7:4,FoxPro_2_x:245,HiPerSix_memo:229}),At=o({Binary:"B",Character:"C",Date:"D",Numeric:"N",Logical:"L",Memo:"M",Timestamp:"@",Long:"I",Autoincrement:"+",Float:"F",Double:"O",OLE:"G"});class Pt{constructor(s={}){const i={manager:u,logger:e,reader:new t,...s};this.manager=i.manager,this.logger=i.logger,this.reader=i.reader}get manager(){return this._manager}set manager(e){this._manager=e}get logger(){return this._logger}set logger(e){this._logger=e}get reader(){return this._reader}set reader(e){this._reader=e}setManager(e){return this.manager=e,this}setLogger(e){return this.logger=e,this}setReader(e){return this.reader=e,this}load(e,t,s,i){const r=this,n=new d(r.manager);n.setResponseType("arraybuffer"),n.load(e,(e=>{t(r.parse(e))}),s,i)}parse(e){this.reader.setEndianess(s.Big).setBuffer(e);const t=this.reader.getInt8();if(!this._isValidVersion(t))return this.logger.error(`DBFLoader: Invalid version number: ${t}`),null;const i=this._parseHeader(t);return{header:i,datas:this._parseDatas(t,i)}}_isValidVersion(e){return Mt.includes(e)}_parseHeader(e){let t={};switch(e){case Mt.FoxPro:case Mt.FoxPro_Autoincrement:case Mt.FoxPro_Var:case Mt.dBASE_II:t=this._parseHeaderV2();break;case Mt.dBASE_III_plus:case Mt.dBASE_III_plus_memo:t=this._parseHeaderV2_5();break;case Mt.dBASE_IV_memo:case Mt.dBASE_IV_memo_SQL_table:case Mt.dBASE_IV_SQL_system:case Mt.dBASE_IV_SQL_table:t=this._parseHeaderV3();break;case Mt.dBase_v_7:case Mt.FoxPro_2_x:case Mt.HiPerSix_memo:t=this._parseHeaderV4();break;default:throw new RangeError(`Invalid version parameter: ${e}`)}return this.reader.getUint8()!==Pt.Terminator&&this.logger.error("DBFLoader: Invalid terminator after field descriptors !!!"),t}_parseHeaderV2(){const e=this.reader.getInt16(),t=this.reader.getInt8()+Pt.YearOffset,s=this.reader.getInt8(),i=this.reader.getInt8(),r=this.reader.getInt16();let n,o,a,h,l,c=[];for(let t=0;t<e;t++)n=this.reader.getString(11),o=this.reader.getChar(),a=this.reader.getUint8(),h=this.reader.getInt16(),l=this.reader.getInt8(),c.push({name:n,type:o,length:a,memoryAddress:h,decimalCount:l});return{numberOfRecords:e,year:t,month:s,day:i,lengthOfEachRecords:r,fields:c}}_parseHeaderV2_5(){const e=this.reader.getInt8()+Pt.YearOffset,t=this.reader.getInt8(),i=this.reader.getInt8();this.reader.setEndianess(s.Little);const r=this.reader.getInt32(),n=this.reader.getInt16(),o=this.reader.getInt16();this.reader.setEndianess(s.Big),this.reader.skipOffsetOf(20);let a,h,l,c,d,u,p,m=[];for(let e=0;e<r;e++)a=this.reader.getString(11),h=this.reader.getChar(),c=this.reader.getInt32(),l=this.reader.getUint8(),d=this.reader.getUint8(),this.reader.skipOffsetOf(2),u=this.reader.getInt8(),this.reader.skipOffsetOf(2),p=this.reader.getInt8(),this.reader.skipOffsetOf(1),m.push({name:a,type:h,length:l,memoryAddress:c,decimalCount:d,workAreaId:u,MDXFlag:p});return{year:e,month:t,day:i,numberOfRecords:r,numberOfByteInHeader:n,numberOfByteInRecord:o,fields:m}}_parseHeaderV3(){const e=this.reader.getInt8()+Pt.YearOffset,t=this.reader.getInt8(),i=this.reader.getInt8();this.reader.setEndianess(s.Little);const r=this.reader.getInt32(),n=this.reader.getInt16(),o=this.reader.getInt16();this.reader.setEndianess(s.Big),this.reader.skipOffsetOf(2);const a=this.reader.getInt8(),h=this.reader.getInt8();this.reader.skipOffsetOf(12);const l=this.reader.getInt8(),c=this.reader.getInt8();this.reader.skipOffsetOf(2);let d,u,p,m,f,_,g=[];for(;this.reader.getOffset()<n-1;)d=this.reader.getString(11),u=this.reader.getChar(),this.reader.skipOffsetOf(4),p=this.reader.getUint8(),m=this.reader.getUint8(),this.reader.skipOffsetOf(2),f=this.reader.getInt8(),this.reader.skipOffsetOf(10),_=this.reader.getInt8(),g.push({name:d,type:u,length:p,decimalCount:m,workAreaId:f,MDXFieldFlag:_});return{year:e,month:t,day:i,numberOfRecords:r,numberOfByteInHeader:n,numberOfByteInRecord:o,incompleteTransactionFlag:a,encryptionFlag:h,MDXFlag:l,languageDriverId:c,fields:g}}_parseHeaderV4(){const e=this.reader.getInt8()+Pt.YearOffset,t=this.reader.getInt8(),i=this.reader.getInt8();this.reader.setEndianess(s.Little);const r=this.reader.getInt32(),n=this.reader.getInt16(),o=this.reader.getInt16();this.reader.setEndianess(s.Big),this.reader.skipOffsetOf(2);const a=this.reader.getInt8(),h=this.reader.getInt8();this.reader.skipOffsetOf(12);const l=this.reader.getInt8(),c=this.reader.getInt8();this.reader.skipOffsetOf(2);const d=this.reader.getString(32);this.reader.skipOffsetOf(4);let u,p,m,f,_,g,b=[];for(let e=0;e<r;e++)u=this.reader.getString(32),p=this.reader.getChar(),m=this.reader.getUint8(),f=this.reader.getUint8(),this.reader.skipOffsetOf(2),_=this.reader.getInt8(),this.reader.skipOffsetOf(2),g=this.reader.getInt32(),this.reader.skipOffsetOf(4),b.push({name:u,type:p,length:m,decimalCount:f,MDXFieldFlag:_,nextAutoincrementValue:g});return{year:e,month:t,day:i,numberOfRecords:r,numberOfByteInHeader:n,numberOfByteInRecord:o,incompleteTransactionFlag:a,encryptionFlag:h,MDXFlag:l,languageDriverId:c,languageDriverName:d,fields:b}}_parseDatas(e,t){const s=t.numberOfRecords,i=t.fields;let r=[],n=null,o=null;for(let e=0;e<s;e++){n={},n.deleted=this.reader.getUint8()===Pt.DeletedRecord;for(let e=0,t=i.length;e<t;e++)switch(o=i[e],o.type){case At.Binary:{const e=this.reader.getString(o.length);n[o.name]=parseInt(e)}break;case At.Numeric:{const e=this.reader.getString(o.length);n[o.name]=parseInt(e)}break;case At.Character:case At.Date:n[o.name]=this.reader.getString(o.length);break;case At.Logical:{const e=this.reader.getChar().toLowerCase();n[o.name]="t"===e||"y"===e||"f"!==e&&"n"!==e&&null}break;case At.Memo:n[o.name]=this.reader.getString(o.length);break;case At.Timestamp:break;case At.Long:case At.Autoincrement:n[o.name]=this.reader.getInt32();break;case At.Float:{const e=this.reader.getString(o.length);n[o.name]=parseInt(e)}break;case At.Double:n[o.name]=this.reader.getFloat64();break;case At.OLE:n[o.name]=this.reader.getString(o.length);break;default:throw new RangeError(`Invalid data type parameter: ${o.type}`)}r.push(n)}return r}_parseFieldProperties(){const e=this.reader.getInt16(),t=this.reader.getInt16(),s=this.reader.getInt16(),i=this.reader.getInt16(),r=this.reader.getInt16(),n=this.reader.getInt16(),o=this.reader.getInt16(),a=this.reader.getInt16();let h=[];for(let t=0;t<e;t++)h.push(this._getStandardProperties());let l=[];for(let e=0;e<s;e++)l.push(this._getCustomProperties());let c=[];for(let e=0;e<r;e++)c.push(this._getReferentialIntegrityProperties());return{numberOfStandardProperties:e,startOfStandardPropertiesDescriptor:t,numberOfCustomProperties:s,startOfCustomPropertiesDescriptor:i,numberOfReferentialIntegrityProperties:r,startOfReferentialIntegrityDescriptor:n,startOfData:o,sizeOfPropertiesStructure:a,standardProperties:h,customProperties:l,referentialIntegrityProperties:c}}_getStandardProperties(){const e=this.reader.getInt16(),t=this.reader.getInt16(),s=this.reader.getInt8(),i=this.reader.getInt8(),r=this.reader.getInt8();this.reader.skipOffsetOf(4);return{generationalNumber:e,tableFieldOffset:t,propertyDescribed:s,type:i,isConstraint:r,offsetFromStart:this.reader.getInt16(),widthOfDatabaseField:this.reader.getInt16()}}_getCustomProperties(){const e=this.reader.getInt16(),t=this.reader.getInt16(),s=this.reader.getInt8();this.reader.skipOffsetOf(1);return{generationalNumber:e,tableFieldOffset:t,type:s,offsetFromStartOfName:this.reader.getInt16(),lengthOfName:this.reader.getInt16(),offsetFromStartOfData:this.reader.getInt16(),lengthOfData:this.reader.getInt16()}}_getReferentialIntegrityProperties(){return{databaseState:this.reader.getInt8(),sequentialNumberRule:this.reader.getInt16(),offsetOfTheRIRuleName:this.reader.getInt16(),sizeOfTheRIRuleName:this.reader.getInt16(),offsetOfNameOfForeignTable:this.reader.getInt16(),sizeOfNameOfForeignTable:this.reader.getInt16(),stateBehaviour:this.reader.getInt8(),numberOfFieldsInLinkingKey:this.reader.getInt16(),offsetOfLocalTableTagName:this.reader.getInt16(),sizeOfTheLocalTableTagName:this.reader.getInt16(),offsetOfForeignTableTagName:this.reader.getInt16(),sizeOfTheForeignTableTagName:this.reader.getInt16()}}}Pt.Terminator=13,Pt.DeletedRecord=26,Pt.YearOffset=1900;
/**
 * @module Loader/ASCLoader
 * @desc A loader for ASC cloud point files.
 *
 * @requires {@link https://github.com/Itee/itee-client itee-client}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 * @example
 *
 * import { ASCLoader } from 'itee-plugin-three'
 *
 * const loader = new ASCLoader();
 *
 * // If the ASC file need to be offseted, it can be set before loading file.
 * loader.setOffset( {
 *      x: 1.0,
 *      y: 52.0,
 *      z: -5.0
 * } );
 *
 * // Then load the file and get the threejs Point Geometry
 * loader.load('/path/to/file.asc', function (geometry) {
 *
 *      scene.add( new Mesh( geometry ) );
 *
 * } );
 *
 */
class Tt{constructor(t=u,s=e){this.manager=t,this.logger=s,this._boundingBox=new b,this._points=[],this._numberOfPoints=0,this._coloredPoints=!1,this._autoOffset=!1,this._offset={x:0,y:0,z:0},this._positions=null,this._bufferIndex=0,this._positionsC=null,this._bufferIndexC=0,this.wrongPoints=0}load(e,t,s,i,r){const n=new d(this.manager);n.setResponseType("blob"),n.load(e,function(e){const n=new w;this._parse(e,n,t,s,i,r),t(n)}.bind(this),s,i)}setOffset(e){this._offset=e,this._autoOffset=!1}_parse(e,t,s,i,r,n){const o=this,a=n||100,h=new FileReader,l=134217728;let c=0;function d(){if(c>=e.size)return;const t=e.slice(c,c+l,"text/plain");h.readAsText(t)}h.onabort=e=>{this.logger.log("abortEvent:"),this.logger.log(e)},h.onerror=e=>{this.logger.log("errorEvent:"),this.logger.log(e),r&&r(e)},h.onloadstart=e=>{this.logger.log("loadStartEvent:"),this.logger.log(e)},h.onprogress=e=>{this.logger.log("progressEvent:"),this.logger.log(e),i&&i(e)},h.onload=e=>{this.logger.log("loadEvent:"),this.logger.log(e);const t=e.target.result.split("\n"),s=t.length;c-=t[s-1].length;const i=Math.round(100/a);for(let e=0;e<s-1;e++)e%i==0&&o._parseLine(t[e])},h.onloadend=s=>{this.logger.log("loadEndEvent"),this.logger.log(s),(this._points.length>1e6||c+l>=e.size)&&(this._offsetPoints(),this._createSubCloudPoint(t)),c+=l,d()},d()}_parseLine(e){const t=e.split(/\s/g).filter(Boolean),s=t.length;3===s?this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2])}):4===s?(this._pointsHaveIntensity=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3])})):6===s?(this._pointsHaveColor=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),r:parseFloat(t[3]),g:parseFloat(t[4]),b:parseFloat(t[5])})):7===s?(this._pointsHaveIntensity=!0,this._pointsHaveColor=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),r:parseFloat(t[4]),g:parseFloat(t[5]),b:parseFloat(t[6])})):9===s?(this._pointsHaveColor=!0,this._pointsHaveNormals=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),r:parseFloat(t[3]),g:parseFloat(t[4]),b:parseFloat(t[5]),nx:parseFloat(t[6]),ny:parseFloat(t[7]),nz:parseFloat(t[8])})):10===s?(this._pointsHaveIntensity=!0,this._pointsHaveColor=!0,this._pointsHaveNormals=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),r:parseFloat(t[4]),g:parseFloat(t[5]),b:parseFloat(t[6]),nx:parseFloat(t[7]),ny:parseFloat(t[8]),nz:parseFloat(t[9])})):this.logger.error(`Invalid data line: ${e}`)}_parseLines(e){const t=e[0].split(/\s/g).filter(Boolean).length;3===t?this._parseLinesAsXYZ(e):4===t?this._parseLinesAsXYZI(e):6===t?this._parseLinesAsXYZRGB(e):7===t?this._parseLinesAsXYZIRGB(e):9===t?this._parseLinesAsXYZRGBnXnYnZ(e):10===t?this._parseLinesAsXYZIRGBnXnYnZ(e):this.logger.error(`Invalid data line: ${e}`)}_parseLinesAsXYZ(e){let t=[];for(let s=0,i=e.length;s<i;s++)t=e[s].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2])})}_parseLinesAsXYZI(e){this._pointsHaveIntensity=!0;let t=[];for(let s=0,i=e.length;s<i;s++)t=e[s].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3])})}_parseLinesAsXYZRGB(e){this._pointsHaveColor=!0;let t=[];for(let s=0,i=e.length;s<i;s++)t=e[s].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),r:parseFloat(t[3]),g:parseFloat(t[4]),b:parseFloat(t[5])})}_parseLinesAsXYZnXnYnZ(e){let t=[];for(let s=0,i=e.length;s<i;s++)t=e[s].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),nx:parseFloat(t[7]),ny:parseFloat(t[8]),nz:parseFloat(t[9])})}_parseLinesAsXYZIRGB(e){this._pointsHaveIntensity=!0,this._pointsHaveColor=!0;let t=[];for(let s=0,i=e.length;s<i;s++)t=e[s].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),r:parseFloat(t[4]),g:parseFloat(t[5]),b:parseFloat(t[6])})}_parseLinesAsXYZInXnYnZ(e){let t=[];for(let s=0,i=e.length;s<i;s++)t=e[s].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),nx:parseFloat(t[7]),ny:parseFloat(t[8]),nz:parseFloat(t[9])})}_parseLinesAsXYZRGBnXnYnZ(e){this._pointsHaveColor=!0,this._pointsHaveNormals=!0;let t=[];for(let s=0,i=e.length;s<i;s++)t=e[s].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),r:parseFloat(t[3]),g:parseFloat(t[4]),b:parseFloat(t[5]),nx:parseFloat(t[6]),ny:parseFloat(t[7]),nz:parseFloat(t[8])})}_parseLinesAsXYZIRGBnXnYnZ(e){this._pointsHaveIntensity=!0,this._pointsHaveColor=!0,this._pointsHaveNormals=!0;let t=[];for(let s=0,i=e.length;s<i;s++)t=e[s].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),r:parseFloat(t[4]),g:parseFloat(t[5]),b:parseFloat(t[6]),nx:parseFloat(t[7]),ny:parseFloat(t[8]),nz:parseFloat(t[9])})}_parseLineB(e){const t=e.split(/\s/g).filter(Boolean),s=t.length,i=this._bufferIndex;3===s&&(this._positions[i]=parseFloat(t[0]),this._positions[i+1]=parseFloat(t[1]),this._positions[i+2]=parseFloat(t[2]),this._bufferIndex+=3)}_parseLineC(e){const t=e.split(/\s/g).filter(Boolean),s=t.length,i=this._bufferIndexC;3===s&&(this._positionsC[i]=Number.parseFloat(t[0]),this._positionsC[i+1]=Number.parseFloat(t[1]),this._positionsC[i+2]=Number.parseFloat(t[2]),this._bufferIndexC+=3)}_offsetPoints(){this._autoOffset&&(this._boundingBox.setFromPoints(this._points),this.setOffset(this._boundingBox.getCenter()));const e=this._offset.x,t=this._offset.y,s=this._offset.z;let i=null;for(let r=0,n=this._points.length;r<n;++r)i=this._points[r],i.x-=e,i.y-=t,i.z-=s}_createCloudPoint(e){const t=1e6,s=this._points.length,i=Math.ceil(s/t);let r=null,n=0,o=null;for(let s=0;s<i;++s){r=this._points.splice(0,t),n=r.length;const s=new _,i=new Float32Array(3*n),a=new Float32Array(3*n);let h=0,l=null;for(let e=0;e<n;++e)l=r[e],i[h]=l.x,i[h+1]=l.y,i[h+2]=l.z,this._pointsHaveColor?(a[h]=l.r/255,a[h+1]=l.g/255,a[h+2]=l.b/255):(a[h]=.1,a[h+1]=.2,a[h+2]=.5),h+=3;s.setAttribute("position",new m(i,3)),s.setAttribute("color",new m(a,3));const c=new g({size:.01,vertexColors:!0});o=new v(s,c),e.children.push(o)}}_createSubCloudPoint(e){const t=this._points.length,s=new _,i=new Float32Array(3*t),r=new Float32Array(3*t);let n=0,o=null;for(let e=0;e<t;++e)o=this._points[e],i[n]=o.x,i[n+1]=o.y,i[n+2]=o.z,this._pointsHaveColor?(r[n]=o.r/255,r[n+1]=o.g/255,r[n+2]=o.b/255):(r[n]=.1,r[n+1]=.2,r[n+2]=.5),n+=3;s.setAttribute("position",new m(i,3)),s.setAttribute("color",new m(r,3));const a=new g({size:.005,vertexColors:!0}),h=new v(s,a);h.rotation.x-=Math.PI/2,e.children.push(h),this._points=[]}}
/**
 * @module Controllers/CameraControls
 * @desc This module export CameraControls class and CameraControlMode enum values.
 *
 * @requires {@link module: [itee-client]{@link https://github.com/Itee/itee-client}}
 * @requires {@link module: [itee-utils]{@link https://github.com/Itee/itee-utils}}
 * @requires {@link module: [itee-validators]{@link https://github.com/Itee/itee-validators}}
 * @requires {@link module: [three-full]{@link https://github.com/Itee/three-full}}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 * @example
 *
 * import { CameraControls, CameraControlMode } from 'itee-plugin-three'
 *
 */const St=new p(0,0,-1),Dt=new p(0,0,1),Ct=new p(0,1,0),Ot=new p(0,-1,0),kt=new p(1,0,0),It=new p(-1,0,0),zt=o({None:0,Rotating:1,Panning:2,Rolling:3,Zooming:4,Moving:5}),Ft=o({FirstPerson:1,Orbit:2,Fly:3,Path:4});class Bt extends B{constructor(t={}){const s={logger:e,camera:null,target:new L,mode:Ft.Orbit,domElement:"function"==typeof importScripts?null:window,...t};super(),this._handlers={onMouseEnter:this._onMouseEnter.bind(this),onMouseLeave:this._onMouseLeave.bind(this),onMouseDown:this._onMouseDown.bind(this),onMouseMove:this._onMouseMove.bind(this),onMouseWheel:this._onMouseWheel.bind(this),onMouseUp:this._onMouseUp.bind(this),onDblClick:this._onDblClick.bind(this),onTouchStart:this._onTouchStart.bind(this),onTouchEnd:this._onTouchEnd.bind(this),onTouchCancel:this._onTouchCancel.bind(this),onTouchLeave:this._onTouchLeave.bind(this),onTouchMove:this._onTouchMove.bind(this),onKeyDown:this._onKeyDown.bind(this),onKeyUp:this._onKeyUp.bind(this)},this.logger=s.logger,this.camera=s.camera,this.target=s.target,this.mode=s.mode,this.domElement=s.domElement,this.enabled=!0,this._paths=[],this._trackPath=!1,this._cameraJump=.1,this._currentPathPosition=null,this._currentPathOffset=0,this._currentPathIndex=0,this._currentPath=null,this._maxJump=1,this._lockedTarget=!0,this.previousTouches=[],this.canMove=!0,this.moveSpeed=1,this.canFront=!0,this.frontMinimum=-1/0,this.frontMaximum=-1/0,this.frontMinSpeed=0,this.frontSpeed=1,this.frontMaxSpeed=1/0,this.frontAcceleration=1,this.canBack=!0,this.backMinimum=-1/0,this.backMaximum=-1/0,this.backMinSpeed=0,this.backSpeed=1,this.backMaxSpeed=1/0,this.backAcceleration=1,this.canUp=!0,this.upMinimum=-1/0,this.upMaximum=-1/0,this.upMinSpeed=0,this.upSpeed=1,this.upMaxSpeed=1/0,this.upAcceleration=1,this.canDown=!0,this.downMinimum=-1/0,this.downMaximum=-1/0,this.downMinSpeed=0,this.downSpeed=1,this.downMaxSpeed=1/0,this.downAcceleration=1,this.canLeft=!0,this.leftMinimum=-1/0,this.leftMaximum=-1/0,this.leftMinSpeed=0,this.leftSpeed=1,this.leftMaxSpeed=1/0,this.leftAcceleration=1,this.canRight=!0,this.rightMinimum=-1/0,this.rightMaximum=-1/0,this.rightMinSpeed=0,this.rightSpeed=1,this.rightMaxSpeed=1/0,this.rightAcceleration=1,this.canRotate=!0,this.minPolarAngle=.001,this.maxPolarAngle=Math.PI-.001,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.rotateMinSpeed=0,this.rotateSpeed=1,this.rotateMaxSpeed=1/0,this.rotateAcceleration=1,this.canPan=!0,this.panMinimum=-1/0,this.panMaximum=-1/0,this.panMinSpeed=0,this.panSpeed=.001,this.panMaxSpeed=1/0,this.panAcceleration=1,this.canRoll=!0,this.rollMinimum=-1/0,this.rollMaximum=-1/0,this.rollMinSpeed=0,this.rollSpeed=.1,this.rollMaxSpeed=1/0,this.rollAcceleration=1,this.canZoom=!0,this.zoomMinimum=0,this.zoomMaximum=1/0,this.zoomMinSpeed=0,this.zoomSpeed=.001,this.zoomMaxSpeed=1/0,this.zoomAcceleration=1,this.canLookAt=!0,this.actionsMap={front:[i.Z.value,i.UP_ARROW.value],back:[i.S.value,i.DOWN_ARROW.value],up:[i.A.value,i.PAGE_UP.value],down:[i.E.value,i.PAGE_DOWN.value],left:[i.Q.value,i.LEFT_ARROW.value],right:[i.D.value,i.RIGHT_ARROW.value],rotate:[r.Left.value],pan:[r.Middle.value],roll:{left:[i.R.value],right:[i.T.value]},zoom:[r.Wheel.value],lookAtFront:[i.NUMPAD_2.value],lookAtFrontLeft:[i.NUMPAD_3.value],lookAtFrontRight:[i.NUMPAD_1.value],lookAtBack:[i.NUMPAD_8.value],lookAtBackLeft:[i.NUMPAD_9.value],lookAtBackRight:[i.NUMPAD_7.value],lookAtUp:[i.NUMPAD_5.value],lookAtDown:[i.NUMPAD_0.value],lookAtLeft:[i.NUMPAD_6.value],lookAtRight:[i.NUMPAD_4.value]},this._state=zt.None}get camera(){return this._camera}set camera(e){if(y(e))throw new Error("Camera cannot be null ! Expect an instance of Camera");if(x(e))throw new Error("Camera cannot be undefined ! Expect an instance of Camera");if(!e.isCamera)throw new Error(`Camera cannot be an instance of ${e.constructor.name}. Expect an instance of Camera.`);this._camera=e}get target(){return this._target}set target(e){if(y(e))throw new Error("Target cannot be null ! Expect an instance of Object3D.");if(x(e))throw new Error("Target cannot be undefined ! Expect an instance of Object3D.");if(!e.isObject3D)throw new Error(`Target cannot be an instance of ${e.constructor.name}. Expect an instance of Object3D.`);this._target=e}get mode(){return this._mode}set mode(e){if(y(e))throw new Error("Mode cannot be null ! Expect a value from CameraControlMode enum.");if(x(e))throw new Error("Mode cannot be undefined ! Expect a value from CameraControlMode enum.");if(!Ft.includes(e))throw new Error(`Mode cannot be an instance of ${e.constructor.name}. Expect a value from TCameraControlMode enum.`);this._mode=e,this._trackPath&&this._initPathDisplacement()}get paths(){return this._paths}set paths(e){this._paths=e}get trackPath(){return this._trackPath}set trackPath(e){if(E(e))throw new Error(`Track path cannot be an instance of ${e.constructor.name}. Expect a boolean.`);this._trackPath=e,this._trackPath&&this._initPathDisplacement()}get domElement(){return this._domElement}set domElement(e){if(y(e))throw new Error("DomElement cannot be null ! Expect an instance of HTMLDocument.");if(x(e))throw new Error("DomElement cannot be undefined ! Expect an instance of HTMLDocument.");if(!["Window","HTMLDocument","HTMLDivElement","HTMLCanvasElement","OffscreenCanvas"].includes(e.constructor.name))throw new Error(`DomElement cannot be an instance of ${e.constructor.name}. Expect an instance of Window, HTMLDocument or HTMLDivElement.`);this._domElement&&(this._domElement.removeEventListener("mouseenter",this._handlers.onMouseEnter,!1),this._domElement.removeEventListener("mouseleave",this._handlers.onMouseLeave,!1),this.dispose()),this._domElement=e,this._domElement.addEventListener("mouseenter",this._handlers.onMouseEnter,!1),this._domElement.addEventListener("mouseleave",this._handlers.onMouseLeave,!1),this.impose()}get handlers(){return this._handlers}setCamera(e){return this.camera=e,this}setTarget(e){return this.target=e,this}setMode(e){return this.mode=e,this}setPaths(e){return this.paths=e,this}addPath(e){return this._paths.push(e),this}setTrackPath(e){return this.trackPath=e,this}setDomElement(e){return this.domElement=e,this}impose(){this._domElement.addEventListener("keydown",this._handlers.onKeyDown,!1),this._domElement.addEventListener("keyup",this._handlers.onKeyUp,!1),this._domElement.addEventListener("dblclick",this._handlers.onDblClick,!1),this._domElement.addEventListener("mousedown",this._handlers.onMouseDown,!1),this._domElement.addEventListener("mousemove",this._handlers.onMouseMove,!1),this._domElement.addEventListener("mouseup",this._handlers.onMouseUp,!1),this._domElement.addEventListener("wheel",this._handlers.onMouseWheel,{capture:!0,once:!1,passive:!1}),this._domElement.addEventListener("touchcancel",this._handlers.onTouchCancel,!1),this._domElement.addEventListener("touchend",this._handlers.onTouchEnd,!1),this._domElement.addEventListener("touchleave",this._handlers.onTouchLeave,!1),this._domElement.addEventListener("touchmove",this._handlers.onTouchMove,{capture:!0,once:!1,passive:!1}),this._domElement.addEventListener("touchstart",this._handlers.onTouchStart,{capture:!0,once:!1,passive:!1}),this.dispatchEvent({type:"impose"})}dispose(){this._domElement.removeEventListener("keydown",this._handlers.onKeyDown,!1),this._domElement.removeEventListener("keyup",this._handlers.onKeyUp,!1),this._domElement.removeEventListener("dblclick",this._handlers.onDblClick,!1),this._domElement.removeEventListener("mousedown",this._handlers.onMouseDown,!1),this._domElement.removeEventListener("mousemove",this._handlers.onMouseMove,!1),this._domElement.removeEventListener("mouseup",this._handlers.onMouseUp,!1),this._domElement.removeEventListener("wheel",this._handlers.onMouseWheel,{capture:!0,once:!1,passive:!1}),this._domElement.removeEventListener("touchcancel",this._handlers.onTouchCancel,!1),this._domElement.removeEventListener("touchend",this._handlers.onTouchEnd,!1),this._domElement.removeEventListener("touchleave",this._handlers.onTouchLeave,!1),this._domElement.removeEventListener("touchmove",this._handlers.onTouchMove,{capture:!0,once:!1,passive:!1}),this._domElement.removeEventListener("touchstart",this._handlers.onTouchStart,{capture:!0,once:!1,passive:!1}),this.dispatchEvent({type:"dispose"})}update(){}setCameraPosition(e){return this._camera.position.copy(e),this._camera.lookAt(this._target.position),this}setTargetPosition(e){return this._target.position.copy(e),this._camera.lookAt(this._target.position),this}_preventEvent(e){e.preventDefault&&e.preventDefault()}_consumeEvent(e){e.cancelable&&e.stopImmediatePropagation&&e.stopImmediatePropagation()}_onKeyDown(e){if(!this.enabled)return;this._preventEvent(e);const t=this.actionsMap,s=e.keyCode;t.front.includes(s)?(this._front(),this._consumeEvent(e)):t.back.includes(s)?(this._back(),this._consumeEvent(e)):t.up.includes(s)?(this._up(),this._consumeEvent(e)):t.down.includes(s)?(this._down(),this._consumeEvent(e)):t.left.includes(s)?(this._left(),this._consumeEvent(e)):t.right.includes(s)?(this._right(),this._consumeEvent(e)):t.rotate.includes(s)?this._rotate(1):t.pan.includes(s)?(this._pan(1),this._consumeEvent(e)):t.roll.left.includes(s)?(this._roll(1),this._consumeEvent(e)):t.roll.right.includes(s)?(this._roll(-1),this._consumeEvent(e)):t.zoom.includes(s)?(this._zoom(1),this._consumeEvent(e)):t.lookAtFront.includes(s)?(this._lookAt(St),this._consumeEvent(e)):t.lookAtFrontLeft.includes(s)?(this._lookAt(new p(-1,0,-1).normalize()),this._consumeEvent(e)):t.lookAtFrontRight.includes(s)?(this._lookAt(new p(1,0,-1).normalize()),this._consumeEvent(e)):t.lookAtBack.includes(s)?(this._lookAt(Dt),this._consumeEvent(e)):t.lookAtBackLeft.includes(s)?(this._lookAt(new p(-1,0,1).normalize()),this._consumeEvent(e)):t.lookAtBackRight.includes(s)?(this._lookAt(new p(1,0,1).normalize()),this._consumeEvent(e)):t.lookAtUp.includes(s)?(this._lookAt(Ct),this._consumeEvent(e)):t.lookAtDown.includes(s)?(this._lookAt(Ot),this._consumeEvent(e)):t.lookAtLeft.includes(s)?(this._lookAt(It),this._consumeEvent(e)):t.lookAtRight.includes(s)&&(this._lookAt(kt),this._consumeEvent(e))}_onKeyUp(e){this.enabled&&this._preventEvent(e)}_onTouchStart(e){this.enabled&&(this._preventEvent(e),this.previousTouches=e.touches)}_onTouchEnd(e){this.enabled&&(this._preventEvent(e),this.previousTouches=[],this._state=zt.None)}_onTouchCancel(e){this.enabled&&(this._preventEvent(e),this.previousTouches=[],this._state=zt.None)}_onTouchLeave(e){this.enabled&&(this._preventEvent(e),this.previousTouches=[],this._state=zt.None)}_onTouchMove(e){if(!this.enabled)return;this._preventEvent(e);const t=this.previousTouches,s=e.changedTouches,i=t.length,r=s.length;if(2===i&&2===r){const i=new U(t[0].clientX,t[0].clientY),r=new U(t[1].clientX,t[1].clientY),n=i.distanceTo(r),o=(new U).addVectors(i,r).divideScalar(2),a=(new U).subVectors(i,r).normalize(),h=new U(s[0].clientX,s[0].clientY),l=new U(s[1].clientX,s[1].clientY),c=h.distanceTo(l),d=(new U).addVectors(h,l).divideScalar(2),u=(new U).subVectors(i,r).normalize(),p=(new U).subVectors(d,o),m=c-n,f=u.dot(a);this._pan(p),this._zoom(m),this._roll(f),this._consumeEvent(e)}else if(1===i&&1===r){const i=new U(s[0].clientX-t[0].clientX,s[0].clientY-t[0].clientY).divideScalar(10);this._rotate(i),this._consumeEvent(e)}else this.logger.warn("Ignoring inconsistent touches event.");this.previousTouches=s}_onMouseEnter(e){this.enabled&&(this._preventEvent(e),this.impose(),e.target.constructor!==HTMLDocument&&this._domElement.focus())}_onMouseLeave(e){this.enabled&&(this._preventEvent(e),e.target.constructor!==HTMLDocument&&this._domElement.blur(),this.dispose(),this._state=zt.None)}_onMouseDown(e){if(!this.enabled)return;this._preventEvent(e);const t=this.actionsMap,s=e.button;t.front.includes(s)?(this._state=zt.Moving,this._front(),this._consumeEvent(e)):t.back.includes(s)?(this._state=zt.Moving,this._back(),this._consumeEvent(e)):t.up.includes(s)?(this._state=zt.Moving,this._up(),this._consumeEvent(e)):t.down.includes(s)?(this._state=zt.Moving,this._down(),this._consumeEvent(e)):t.left.includes(s)?(this._state=zt.Moving,this._left(),this._consumeEvent(e)):t.right.includes(s)?(this._state=zt.Moving,this._right(),this._consumeEvent(e)):t.rotate.includes(s)?(this._state=zt.Rotating,this._consumeEvent(e)):t.pan.includes(s)?(this._state=zt.Panning,this._consumeEvent(e)):t.roll.left.includes(s)||t.roll.right.includes(s)?(this._state=zt.Rolling,this._consumeEvent(e)):t.zoom.includes(s)?(this._state=zt.Zooming,this._consumeEvent(e)):this._state=zt.None}_onMouseMove(e){if(!this.enabled||this._state===zt.None)return;this._preventEvent(e);const t=this._state,s={x:e.movementX||e.mozMovementX||e.webkitMovementX||0,y:e.movementY||e.mozMovementY||e.webkitMovementY||0};switch(t){case zt.Moving:break;case zt.Rotating:this._rotate(s),this._consumeEvent(e);break;case zt.Panning:this._pan(s),this._consumeEvent(e);break;case zt.Rolling:this._roll(s),this._consumeEvent(e);break;case zt.Zooming:this._zoom(s),this._consumeEvent(e);break;default:throw new RangeError(`Unknown state: ${t}`)}}_onMouseWheel(e){if(!this.enabled)return;this._preventEvent(e);const t=e.wheelDelta||e.deltaY;this._zoom(t),this._consumeEvent(e)}_onMouseUp(e){this.enabled&&(this._preventEvent(e),this._state=zt.None,this._consumeEvent(e))}_onDblClick(e){this.enabled&&(this._preventEvent(e),this.logger.warn("CameraControls: Double click events is not implemented yet, sorry for the disagreement."))}_front(){if(this.canMove&&this.canFront){if(this._camera.isPerspectiveCamera){const e=St.clone().applyQuaternion(this._camera.quaternion),t=this._trackPath?this._getPathDisplacement(e):e.multiplyScalar(this.frontSpeed);this._camera.position.add(t),this._target.position.add(t)}else if(this._camera.isOrthographicCamera){const e=St.clone().applyQuaternion(this._camera.quaternion),t=this._trackPath?this._getPathDisplacement(e):e.multiplyScalar(this.frontSpeed);this._camera.position.add(t),this._target.position.add(t);const s=this.frontSpeed*this.zoomSpeed;this._camera.zoom+=s,this._camera.updateProjectionMatrix()}else this.logger.error(`Unmanaged displacement for camera of type ${this._camera.type}`);this.dispatchEvent({type:"move"}),this.dispatchEvent({type:"change"})}}_back(){if(this.canMove&&this.canBack){if(this._camera.isPerspectiveCamera){const e=Dt.clone().applyQuaternion(this._camera.quaternion),t=this._trackPath?this._getPathDisplacement(e):e.multiplyScalar(this.backSpeed);this._camera.position.add(t),this._target.position.add(t)}else if(this._camera.isOrthographicCamera){const e=Dt.clone().applyQuaternion(this._camera.quaternion),t=this._trackPath?this._getPathDisplacement(e):e.multiplyScalar(this.backSpeed);this._camera.position.add(t),this._target.position.add(t);const s=this.backSpeed*this.zoomSpeed;this._camera.zoom-s<=0?this._camera.zoom=.01:this._camera.zoom-=s,this._camera.updateProjectionMatrix()}else this.logger.error(`Unmanaged displacement for camera of type ${this._camera.type}`);this.dispatchEvent({type:"move"}),this.dispatchEvent({type:"change"})}}_up(){if(this.canMove&&this.canUp){if(this._camera.isPerspectiveCamera||this._camera.isOrthographicCamera){const e=Ct.clone().applyQuaternion(this._camera.quaternion).multiplyScalar(this.upSpeed);this._camera.position.add(e),this._target.position.add(e)}else this.logger.error(`Unmanaged displacement for camera of type ${this._camera.type}`);this.dispatchEvent({type:"move"}),this.dispatchEvent({type:"change"})}}_down(){if(this.canMove&&this.canDown){if(this._camera.isPerspectiveCamera||this._camera.isOrthographicCamera){const e=Ot.clone().applyQuaternion(this._camera.quaternion).multiplyScalar(this.downSpeed);this._camera.position.add(e),this._target.position.add(e)}else this.logger.error(`Unmanaged displacement for camera of type ${this._camera.type}`);this.dispatchEvent({type:"move"}),this.dispatchEvent({type:"change"})}}_left(){if(this.canMove&&this.canLeft){if(this._camera.isPerspectiveCamera||this._camera.isOrthographicCamera){const e=It.clone().applyQuaternion(this._camera.quaternion).multiplyScalar(this.leftSpeed);this._camera.position.add(e),this._target.position.add(e)}else this.logger.error(`Unmanaged displacement for camera of type ${this._camera.type}`);this.dispatchEvent({type:"move"}),this.dispatchEvent({type:"change"})}}_right(){if(this.canMove&&this.canRight){if(this._camera.isPerspectiveCamera||this._camera.isOrthographicCamera){const e=kt.clone().applyQuaternion(this._camera.quaternion).multiplyScalar(this.rightSpeed);this._camera.position.add(e),this._target.position.add(e)}this.dispatchEvent({type:"move"}),this.dispatchEvent({type:"change"})}}_rotate(e){if(this.canRotate){if(this._camera.isPerspectiveCamera||this._camera.isOrthographicCamera){const t=this._camera.position,s=this._target.position,i=t.distanceTo(s),r=(new p).subVectors(t,s).normalize(),n=this.rotateSpeed;switch(this._mode){case Ft.FirstPerson:{const i=e.x,r=e.y,o=new p(-i,r,0).applyQuaternion(this._camera.quaternion).multiplyScalar(n).add(s),a=(new p).subVectors(o,t).normalize(),h=Ct.clone().dot(a),l=kt.clone().dot(a),c=.97;if(h<-c||h>c||l<-2||l>2)return;const d=a.multiplyScalar(1).add(t);this.setTargetPosition(d)}break;case Ft.Orbit:{const t=(new G).setFromVector3(r),o=t.theta+l(-e.x)*n,a=t.phi+l(-e.y)*n;t.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,o)),t.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,a));const h=(new p).setFromSpherical(t).multiplyScalar(i).add(s);this.setCameraPosition(h)}break;default:throw new RangeError(`Unamanaged rotation for camera mode ${this._mode}`)}}this.dispatchEvent({type:"rotate"}),this.dispatchEvent({type:"change"})}}_pan(e){if(this.canPan){if(this._camera.isPerspectiveCamera||this._camera.isOrthographicCamera){const t=this._camera.position,s=this._target.position,i=t.distanceTo(s),r=new p(-e.x,e.y,0).applyQuaternion(this._camera.quaternion).multiplyScalar(this.panSpeed*i);this._camera.position.add(r),this._target.position.add(r)}this.dispatchEvent({type:"pan"}),this.dispatchEvent({type:"change"})}}_roll(e){if(this.canRoll){if(this._camera.isPerspectiveCamera||this._camera.isOrthographicCamera){const t=this._camera.position,s=this._target.position,i=(new p).subVectors(t,s).normalize(),r=e*this.rollSpeed;this._camera.up.applyAxisAngle(i,r),this._camera.lookAt(s)}this.dispatchEvent({type:"roll"}),this.dispatchEvent({type:"change"})}}_zoom(e){if(this.canZoom){if(this._camera.isPerspectiveCamera)switch(this._mode){case Ft.FirstPerson:e>0?this._camera.fov--:this._camera.fov++,this._camera.updateProjectionMatrix();break;case Ft.Orbit:{const t=this._camera.position,s=this._target.position,i=t.distanceTo(s),r=St.clone().applyQuaternion(this._camera.quaternion).multiplyScalar(e*this.zoomSpeed*i);let n=t.clone().add(r);const o=(new p).subVectors(n,t).normalize(),a=(new p).subVectors(t,s).normalize(),h=(new p).subVectors(n,s).normalize(),l=o.dot(a),c=o.dot(h),d=n.distanceToSquared(s);l<0&&(d<this.zoomMinimum*this.zoomMinimum||c>0)&&(n=a.clone().multiplyScalar(this.zoomMinimum).add(s)),this._camera.position.copy(n)}break;default:throw new RangeError(`Invalid camera control mode parameter: ${this._mode}`)}else if(this._camera.isOrthographicCamera){const t=this.domElement.offsetWidth/this.domElement.offsetHeight,s=this._camera.position,i=this._target.position,r=s.distanceTo(i),n=(e>0?St.clone():Dt.clone()).applyQuaternion(this._camera.quaternion).normalize().multiplyScalar(this.zoomSpeed*r);s.add(n);const o=s.distanceTo(i),a=o/2,h=o*t/2;this._camera.top=a,this._camera.bottom=-a,this._camera.right=h,this._camera.left=-h,this._camera.updateProjectionMatrix()}this.dispatchEvent({type:"zoom"}),this.dispatchEvent({type:"change"})}}_lookAt(e){if(this.canLookAt){if(this._camera.isPerspectiveCamera||this._camera.isOrthographicCamera){const t=e.clone(),s=this._camera.position,i=this._target.position,r=s.distanceTo(i);switch(this.mode){case Ft.FirstPerson:{t.y=-t.y;const e=t.multiplyScalar(r).add(s);this.setTargetPosition(e)}break;case Ft.Orbit:{const e=t.multiplyScalar(r).add(i);this.setCameraPosition(e)}break;default:throw new RangeError(`Invalid camera control mode parameter: ${this._mode}`)}}this.dispatchEvent({type:"lookAt"}),this.dispatchEvent({type:"change"})}}_initPathDisplacement(){if(M(this._paths))this.logger.warn("Try to init path displacement without any paths");else switch(A(this._currentPath)&&(this._currentPathIndex=0,this._currentPathOffset=0,this._currentPath=this._paths[0]),this._currentPathPosition=this._currentPath.getPointAt(this._currentPathOffset),this._mode){case Ft.FirstPerson:if(this._lockedTarget){const e=(new p).subVectors(this._currentPathPosition,this.camera.position);this._camera.position.add(e),this._target.position.add(e)}else this.setCameraPosition(this._currentPathPosition);break;case Ft.Orbit:if(this._lockedTarget){const e=(new p).subVectors(this._currentPathPosition,this.target.position);this._camera.position.add(e),this._target.position.add(e)}else this.setTargetPosition(this._currentPathPosition);break;default:throw new RangeError(`Invalid camera control _mode parameter: ${this._mode}`)}}_getPathDisplacement(e){let t=null;const s=this._currentPathPosition,i=this._currentPathOffset+this._cameraJump,r=i<1?i:1,n=this._currentPath.getPointAt(r),o=(new p).subVectors(n,s),a=o.clone().normalize(),h=e.dot(a),l=this._currentPathOffset-this._cameraJump,c=l>0?l:0,d=this._currentPath.getPointAt(c),u=(new p).subVectors(d,s),m=u.clone().normalize(),f=e.dot(m);if(0===h&&f<0){const s=this._getDirectionsMap();let i,r,n,o=-1;s.forEach((t=>{const s=t.index,a=t.startDisplacement;if(a){const t=a.clone().normalize(),h=e.dot(t);h>o&&(i=s,r=a,o=h,n=!0)}const h=t.endDisplacement;if(h){const t=h.clone().normalize(),a=e.dot(t);a>o&&(i=s,r=h,o=a,n=!1)}})),void 0!==i?(this._currentPathIndex=i,this._currentPath=this._paths[this._currentPathIndex],this._currentPathOffset=n?this._cameraJump:1-this._cameraJump,this._currentPathPosition=this._currentPath.getPointAt(this._currentPathOffset),t=r):(this.logger.warn("Reach path end."),t=new p)}else if(h>0&&f<=0)t=o,this._currentPathOffset=r,this._currentPathPosition=n;else if(h<=0&&f>0)t=u,this._currentPathOffset=c,this._currentPathPosition=d;else if(h<0&&0===f){const s=this._getDirectionsMap();let i,r,n,o=-1;s.forEach((t=>{const s=t.index,a=t.startDisplacement;if(a){const t=a.clone().normalize(),h=e.dot(t);h>o&&(i=s,r=a,o=h,n=!0)}const h=t.endDisplacement;if(h){const t=h.clone().normalize(),a=e.dot(t);a>o&&(i=s,r=h,o=a,n=!1)}})),void 0!==i?(this._currentPathIndex=i,this._currentPath=this._paths[this._currentPathIndex],this._currentPathOffset=n?this._cameraJump:1-this._cameraJump,this._currentPathPosition=this._currentPath.getPointAt(this._currentPathOffset),t=r):(this.logger.warn("Reach path start."),t=new p)}else h<0&&f<0||h>0&&f>0?h>f?(t=o,this._currentPathOffset=r,this._currentPathPosition=n):(t=u,this._currentPathOffset=c,this._currentPathPosition=d):(this.logger.warn("Unable to find correct next path position."),t=new p);return t}_getDirectionsMap(){const e=this._currentPathPosition,t=this._currentPathIndex,s=this._cameraJump,i=this._maxJump;return this._paths.reduce(((r,n,o)=>{if(o===t)return r;const a=n.getPointAt(0);let h;e.distanceToSquared(a)<i&&(h=(new p).subVectors(n.getPointAt(s),a));const l=n.getPointAt(1);let c;return e.distanceToSquared(l)<i&&(c=(new p).subVectors(n.getPointAt(1-s),l)),(h||c)&&r.push({index:o,startDisplacement:h,endDisplacement:c}),r}),[])}}
/**
 * @module Controllers/ClippingController
 *
 * @author [Ahmed DCHAR]{@link https://github.com/Dragoneel}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 * @example Todo
 *
 */class Lt extends _{constructor(e=new p(0,0,0),t=new p(1,0,0)){super(),this.type="LineGeometry",this.setAttribute("position",new f([e.x,e.y,e.z,t.x,t.y,t.z],3))}}class Gt extends ue{constructor(){super(),this.margin=.01,this.geometry=new Q(new Y(2,2,2)),this.material=new oe({color:16777215}),this.matrixAutoUpdate=!1,this.normalPlanes={normalRightSide:new p(-1,0,0),normalLeftSide:new p(1,0,0),normalFrontSide:new p(0,-1,0),normalBackSide:new p(0,1,0),normalTopSide:new p(0,0,-1),normalBottomSide:new p(0,0,1)},this.planes={rightSidePlane:new le(this.normalPlanes.normalRightSide.clone(),0),leftSidePlane:new le(this.normalPlanes.normalLeftSide.clone(),0),frontSidePlane:new le(this.normalPlanes.normalFrontSide.clone(),0),backSidePlane:new le(this.normalPlanes.normalBackSide.clone(),0),topSidePlane:new le(this.normalPlanes.normalTopSide.clone(),0),bottomSidePlane:new le(this.normalPlanes.normalBottomSide.clone(),0)},this._boundingBox=new b}getBoundingSphere(){return this.geometry.computeBoundingSphere(),this.geometry.boundingSphere.applyMatrix4(this.matrixWorld),this.geometry.boundingSphere}setColor(e){this.material.color.set(e)}applyClippingTo(e,t){if(A(t))return;let s=[];for(let e in this.planes)s.push(this.planes[e]);t.traverse((t=>{if(A(t))return;if(A(t.geometry))return;if(A(t.material))return;const i=P(t.material)?t.material:[t.material];for(let t=0,r=i.length;t<r;t++){let r=i[t];r.clippingPlanes||(r.clippingPlanes=[]),r.clippingPlanes=e?s:[]}}))}updateSize(e){this.scale.set(e.x,e.y,e.z)}update(){this._boundingBox.setFromObject(this);const e=this.margin,t=this._boundingBox.min,s=this._boundingBox.max;this.planes.rightSidePlane.constant=s.x+e,this.planes.leftSidePlane.constant=-t.x+e,this.planes.frontSidePlane.constant=s.y+e,this.planes.backSidePlane.constant=-t.y+e,this.planes.topSidePlane.constant=s.z+e,this.planes.bottomSidePlane.constant=-t.z+e}}class Ut extends ae{constructor(e){super(e),this.isHighlightableMaterial=!0,this.depthTest=!1,this.depthWrite=!1,this.fog=!1,this.side=H,this.transparent=!0,this.oldColor=this.color.clone()}highlight(e){if(e){const e=.35,t=this.color.r,s=this.color.g,i=this.color.b,r=Math.min(Math.max(0,t+t*e),1),n=Math.min(Math.max(0,s+s*e),1),o=Math.min(Math.max(0,i+i*e),1);this.color.setRGB(r,n,o)}else this.color.copy(this.oldColor)}}class jt extends oe{constructor(e){super(e),this.isHighlightableMaterial=!0,this.depthTest=!1,this.depthWrite=!1,this.fog=!1,this.transparent=!0,this.linewidth=1,this.oldColor=this.color.clone()}highlight(e){if(e){const e=.35,t=this.color.r,s=this.color.g,i=this.color.b,r=Math.min(Math.max(0,t+t*e),1),n=Math.min(Math.max(0,s+s*e),1),o=Math.min(Math.max(0,i+i*e),1);this.color.setRGB(r,n,o)}else this.color.copy(this.oldColor)}}class Ht extends pe{constructor(e={}){const t={geometry:new _,material:new ae({visible:!1,depthTest:!1,depthWrite:!1,fog:!1,side:H}),...e};super(t.geometry,t.material),this.isHitbox=!0,this.type="Hitbox",this.matrixAutoUpdate=!1}}class Rt extends Ht{constructor(e={}){const t=new q(.2,0,1,4,1,!1);t.translate(0,.5,0);super({geometry:t,...e}),this.isCylindricaHitbox=!0,this.type="CylindricaHitbox"}}class Nt extends Ht{constructor(e={}){const t=new _;t.setAttribute("position",new f([0,0,0,1.1,0,0,1.1,1.1,0,0,1.1,0],3)),t.setIndex([0,1,2,2,3,0]);super({geometry:t,...e}),this.isPlanarHitbox=!0,this.type="PlanarHitbox"}}class Xt extends Ht{constructor(e={}){const t=new f([0,0,0,.85,0,0,1.1,1.1,0,0,.85,0],3),s=new _;s.setAttribute("position",t),s.setIndex([0,1,2,2,3,0]);super({geometry:s,...e}),this.isPlanarHitbox=!0,this.type="PlanarHitbox"}}class Yt extends Ht{constructor(e={}){super({geometry:new K(1.2,0),...e}),this.isOctahedricalHitbox=!0,this.type="OctahedricalHitbox"}}class Zt extends Ht{constructor(e={}){super({geometry:new se(1,8,6,0,2*Math.PI,0,Math.PI),...e}),this.isSphericalHitbox=!0,this.type="SphericalHitbox"}}class Vt extends Ht{constructor(e={}){super({geometry:new re(1,.12,4,12,Math.PI),...e}),this.isTorusHitbox=!0,this.type="TorusHitbox"}}class Wt extends L{constructor(e={}){const t={color:16777215,hitbox:null,...e};super(),this.isHandle=!0,this.type="Handle",this.matrixAutoUpdate=!1,this.color=t.color,this.hitbox=t.hitbox,this.baseQuaternion=new ce}get color(){return this.line.material.color.clone()}set color(e){if(y(e))throw new Error("Color cannot be null ! Expect an instance of Color.");if(x(e))throw new Error("Color cannot be undefined ! Expect an instance of Color.");this.traverse((t=>{let s=t.material;s&&s.color.setHex(e)}))}get hitbox(){return this._hitbox}set hitbox(e){this._hitbox=e,this.add(e)}setColor(e){return this.color=e,this}setHitbox(e){return this.hitbox=e,this}setScale(e,t,s){return this.scale.set(e,t,s),this}setPosition(e,t,s){return this.position.set(e,t,s),this}highlight(e){for(let t=0,s=this.children.length;t<s;t++){const s=this.children[t];if(s.isHitbox)continue;const i=s.material;!x(i)&&i.isHighlightableMaterial&&i.highlight(e)}}raycast(e,t){const s=e.intersectObject(this._hitbox,!1);s.length>0&&t.push({distance:s[0].distance,object:this})}setRotationFromAxisAndAngle(e,t){return this.quaternion.setFromAxisAngle(e,t),this.baseQuaternion.copy(this.quaternion),this}update(e){}}class qt extends Wt{constructor(e={}){const t={color:16777215,hitbox:new Rt,direction:new p(0,1,0),...e};super(t),this.isTranslateHandle=!0,this.type="TranslateHandle";const s=new Lt(new p(0,0,0),new p(0,.8,0)),i=new jt({color:t.color}),r=new de(s,i);r.matrixAutoUpdate=!1,this.add(r);const n=new V(.05,.2,12,1,!1);n.translate(0,.9,0);const o=new Ut({color:t.color}),a=new pe(n,o);a.matrixAutoUpdate=!1,this.add(a),this.direction=t.direction}get direction(){return this._direction}set direction(e){if(y(e))throw new Error("Direction cannot be null ! Expect an instance of Color.");if(x(e))throw new Error("Direction cannot be undefined ! Expect an instance of Color.");if(!(e instanceof p))throw new Error(`Direction cannot be an instance of ${e.constructor.name}. Expect an instance of Vector3.`);if(this._direction=e,e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{const t=new p(e.z,0,-e.x).normalize(),s=Math.acos(e.y);this.quaternion.setFromAxisAngle(t,s)}}update(e){super.update(e);this._direction.dot(e)>=0&&this.flipDirection(),this.updateMatrix(),this.hitbox.updateMatrix()}setDirection(e){return this.direction=e,this}flipDirection(){this.direction=this._direction.negate()}}class $t extends Wt{constructor(e={}){const t={color:16777215,hitbox:new Rt,direction:new p(0,1,0),...e};super(t),this.isScaleHandle=!0,this.type="ScaleHandle";const s=new Lt(new p(0,0,0),new p(0,.88,0)),i=new jt({color:t.color}),r=new de(s,i);r.matrixAutoUpdate=!1,this.add(r);const n=new Y(.12,.12,.12);n.translate(0,.94,0);const o=new Ut({color:t.color}),a=new pe(n,o);a.matrixAutoUpdate=!1,this.add(a),this.direction=t.direction}get direction(){return this._direction}set direction(e){if(y(e))throw new Error("Direction cannot be null ! Expect an instance of Color.");if(x(e))throw new Error("Direction cannot be undefined ! Expect an instance of Color.");if(!(e instanceof p))throw new Error(`Direction cannot be an instance of ${e.constructor.name}. Expect an instance of Vector3.`);if(this._direction=e,e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{const t=new p(e.z,0,-e.x).normalize(),s=Math.acos(e.y);this.quaternion.setFromAxisAngle(t,s)}}update(e){super.update(e);this._direction.dot(e)>=0&&this.flipDirection(),this.updateMatrix(),this.hitbox.updateMatrix()}setDirection(e){return this.direction=e,this}flipDirection(){this.direction=this._direction.negate()}}class Qt extends Wt{constructor(e={}){super({...e}),this.isRotateHandle=!0,this.type="RotateHandle"}update(e){super.update(e),this.updateMatrix(),this.hitbox.updateMatrix()}}class Kt extends Wt{constructor(e={}){const t={color:16777215,hitbox:new Nt,direction:new p(0,1,0),...e};super(t),this.isPlaneHandle=!0,this.type="PlaneHandle";const s=new _;s.setAttribute("position",new f([.75,1,0,1,1,0,1,.75,0],3));const i=new jt({color:t.color}),r=new de(s,i);r.matrixAutoUpdate=!1,this.add(r);const n=new _;n.setAttribute("position",new f([.1,.1,0,1,.1,0,1,1,0,.1,1,0],3)),n.setIndex([0,1,2,2,3,0]);const o=new Ut({color:t.color,transparent:!0,opacity:.35}),a=new pe(n,o);a.matrixAutoUpdate=!1,this.add(a),this.xAxis=new p(1,0,0),this.yAxis=new p(0,1,0),this.zAxis=new p(0,0,1),this.xDirection=new p(t.direction.x,0,0),this.yDirection=new p(0,t.direction.y,0),this.zDirection=new p(0,0,t.direction.z),this.direction=t.direction}get direction(){return this._direction}set direction(e){if(y(e))throw new Error("Direction cannot be null ! Expect an instance of Color.");if(x(e))throw new Error("Direction cannot be undefined ! Expect an instance of Color.");if(!(e instanceof p))throw new Error(`Direction cannot be an instance of ${e.constructor.name}. Expect an instance of Vector3.`);this._direction=e}update(e){super.update(e);const t=new p(this._direction.x,0,0),s=new p(0,this._direction.y,0),i=new p(0,0,this._direction.z),r=t.dot(e),n=s.dot(e),o=i.dot(e);this.quaternion.copy(this.baseQuaternion),r>0&&n>0&&0===o?(this.rotateOnAxis(this.zAxis,l(180)),this.xDirection.setX(-1),this.yDirection.setY(-1),this.zDirection.setZ(0)):r>0&&n<0&&0===o?(this.rotateOnAxis(this.zAxis,l(90)),this.xDirection.setX(-1),this.yDirection.setY(1),this.zDirection.setZ(0)):r<0&&n>0&&0===o?(this.rotateOnAxis(this.zAxis,l(270)),this.xDirection.setX(1),this.yDirection.setY(-1),this.zDirection.setZ(0)):r<0&&n<0&&0===o?(this.rotateOnAxis(this.zAxis,l(0)),this.xDirection.setX(1),this.yDirection.setY(1),this.zDirection.setZ(0)):r>0&&0===n&&o>0?(this.rotateOnAxis(this.zAxis,l(180)),this.xDirection.setX(-1),this.yDirection.setY(0),this.zDirection.setZ(-1)):r>0&&0===n&&o<0?(this.rotateOnAxis(this.zAxis,l(90)),this.xDirection.setX(-1),this.yDirection.setY(0),this.zDirection.setZ(1)):r<0&&0===n&&o>0?(this.rotateOnAxis(this.zAxis,l(270)),this.xDirection.setX(1),this.yDirection.setY(0),this.zDirection.setZ(-1)):r<0&&0===n&&o<0?(this.rotateOnAxis(this.zAxis,l(0)),this.xDirection.setX(1),this.yDirection.setY(0),this.zDirection.setZ(1)):0===r&&n>0&&o>0?(this.rotateOnAxis(this.zAxis,l(180)),this.xDirection.setX(0),this.yDirection.setY(-1),this.zDirection.setZ(-1)):0===r&&n>0&&o<0?(this.rotateOnAxis(this.zAxis,l(270)),this.xDirection.setX(0),this.yDirection.setY(-1),this.zDirection.setZ(1)):0===r&&n<0&&o>0?(this.rotateOnAxis(this.zAxis,l(90)),this.xDirection.setX(0),this.yDirection.setY(1),this.zDirection.setZ(-1)):0===r&&n<0&&o<0&&(this.rotateOnAxis(this.zAxis,l(0)),this.xDirection.setX(0),this.yDirection.setY(1),this.zDirection.setZ(1)),this.updateMatrix(),this.hitbox.updateMatrix()}setDirection(e){return this.direction=e,this}flipXDirection(){this.xDirection.setX(-this.xDirection.x)}flipYDirection(){this.yDirection.setY(-this.yDirection.y)}flipZDirection(){this.zDirection.setZ(-this.zDirection.z)}}class Jt extends Wt{constructor(e={}){const t={color:16777215,hitbox:new Xt,direction:new p(1,1,0),...e};super(t),this.isPlaneHandle=!0,this.type="PlaneHandle";const s=new _;s.setAttribute("position",new f([.1,.75,0,1,1,0,.75,.1,0],3));const i=new jt({color:t.color}),r=new de(s,i);r.matrixAutoUpdate=!1,this.add(r);const n=new _;n.setAttribute("position",new f([.1,.1,0,.75,.1,0,1,1,0,.1,.75,0],3)),n.setIndex([0,1,2,2,3,0]);const o=new Ut({color:t.color,transparent:!0,opacity:.35}),a=new pe(n,o);a.matrixAutoUpdate=!1,this.add(a),this.direction=t.direction,this.xDirection=new p(t.direction.x,0,0),this.yDirection=new p(0,t.direction.y,0),this.zDirection=new p(0,0,t.direction.z),this.xAxis=new p(1,0,0),this.yAxis=new p(0,1,0),this.zAxis=new p(0,0,1)}get direction(){return this._direction}set direction(e){if(y(e))throw new Error("Direction cannot be null ! Expect an instance of Color.");if(x(e))throw new Error("Direction cannot be undefined ! Expect an instance of Color.");if(!(e instanceof p))throw new Error(`Direction cannot be an instance of ${e.constructor.name}. Expect an instance of Vector3.`);this._direction=e}update(e){super.update(e);const t=this.xDirection.dot(e),s=this.yDirection.dot(e),i=this.zDirection.dot(e);this.quaternion.copy(this.baseQuaternion),t>0&&s>0&&0===i?this.rotateOnAxis(this.zAxis,l(180)):t>0&&s<0&&0===i?this.rotateOnAxis(this.zAxis,l(90)):t<0&&s>0&&0===i?this.rotateOnAxis(this.zAxis,l(270)):t<0&&s<0&&0===i?this.rotateOnAxis(this.zAxis,l(0)):t>0&&0===s&&i>0?this.rotateOnAxis(this.zAxis,l(180)):t>0&&0===s&&i<0?this.rotateOnAxis(this.zAxis,l(90)):t<0&&0===s&&i>0?this.rotateOnAxis(this.zAxis,l(270)):t<0&&0===s&&i<0?this.rotateOnAxis(this.zAxis,l(0)):0===t&&s>0&&i>0?this.rotateOnAxis(this.zAxis,l(180)):0===t&&s>0&&i<0?this.rotateOnAxis(this.zAxis,l(270)):0===t&&s<0&&i>0?this.rotateOnAxis(this.zAxis,l(90)):0===t&&s<0&&i<0&&this.rotateOnAxis(this.zAxis,l(0)),this.updateMatrix(),this.hitbox.updateMatrix()}setDirection(e){return this.direction=e,this}flipXAxis(){const e=this._direction.clone();e.x=-e.x,this.direction=e}flipYAxis(){const e=this._direction.clone();e.y=-e.y,this.direction=e}flipZAxis(){const e=this._direction.clone();e.z=-e.z,this.direction=e}}class es extends Wt{constructor(e={}){const t={color:16777215,hitbox:new Yt,...e};super(t),this.isOmnidirectionalHandle=!0,this.type="OmnidirectionalHandle";const s=new K(.1,0),i=new Ut({color:t.color,transparent:!0,opacity:.55}),r=new pe(s,i);r.matrixAutoUpdate=!1,this.add(r);const n=new Q(s),o=new jt({color:t.color,linewidth:4}),a=new ue(n,o);a.matrixAutoUpdate=!1,this.add(a)}update(e){super.update(e),this.updateMatrix(),this.hitbox.updateMatrix()}}class ts extends L{constructor(){super(),this.isGizmo=!0,this.type="AbstractGizmo",this.matrixAutoUpdate=!1}init(){this.handles=new L,this.handles.matrixAutoUpdate=!1,this.add(this.handles);const e=new ee(50,50,2,2),t=new ae({side:H,visible:!1});this.intersectPlane=new pe(e,t),this.intersectPlane.matrixAutoUpdate=!1,this.intersectPlane.visible=!0,this.add(this.intersectPlane);((e,t)=>{for(let s in e){const i=e[s];if(S(i))i.name=s,i.renderOrder=1/0,t.add(i);else for(let r=i.length;r--;){const i=e[s][r][0],n=e[s][r][1],o=e[s][r][2],a=e[s][r][3],h=e[s][r][4];i.name=s,i.tag=h,i.renderOrder=1/0,n&&i.position.set(n[0],n[1],n[2]),o&&i.rotation.set(o[0],o[1],o[2]),a&&i.scale.set(a[0],a[1],a[2]),i.updateMatrix();const l=i.geometry.clone();l.applyMatrix4(i.matrix),i.geometry=l,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}}})(this.handleGizmos,this.handles)}highlight(e){for(let e in this.handleGizmos)this.handleGizmos[e].highlight(!1);const t=this.handleGizmos[e];t&&t.highlight(!0)}update(e,t){this.traverse((e=>{e.isHandle&&e.update(t)})),this.updateIntersectPlane(e)}updateIntersectPlane(e){this.intersectPlane.lookAt(e),this.intersectPlane.updateMatrix()}}class ss extends ts{constructor(){super(),this.isTranslateGizmo=!0,this.type="TranslateGizmo",this.handleGizmos={X:new qt({color:11141120,direction:new p(1,0,0)}),Y:new qt({color:43520,direction:new p(0,1,0)}),Z:new qt({color:170,direction:new p(0,0,1)}),XY:new Jt({color:11184640,direction:new p(1,1,0)}).setScale(.33,.33,1),YZ:new Jt({color:43690,direction:new p(0,1,1)}).setScale(.33,.33,1).setRotationFromAxisAndAngle(new p(0,1,0),l(-90)),XZ:new Jt({color:11141290,direction:new p(1,0,1)}).setScale(.33,.33,1).setRotationFromAxisAndAngle(new p(1,0,0),l(90)),XYZ:new es({color:11184810}).setScale(.15,.15,.15)},this.init()}}class is extends ts{constructor(){super(),this.isRotateGizmo=!0,this.type="RotateGizmo";const e=(e,t,s)=>{const i=new _;let r=[];s=s||1;for(let i=0;i<=64*s;++i)"x"===t&&r.push(0,Math.cos(i/32*Math.PI)*e,Math.sin(i/32*Math.PI)*e),"y"===t&&r.push(Math.cos(i/32*Math.PI)*e,0,Math.sin(i/32*Math.PI)*e),"z"===t&&r.push(Math.sin(i/32*Math.PI)*e,Math.cos(i/32*Math.PI)*e,0);return i.setAttribute("position",new f(r,3)),i};this.handleGizmos={X:[[new de(new e(1,"x",.5),new jt({color:16711680}))],[new pe(new K(.04,0),new Ut({color:16711680})),[0,0,.99],null,[3,1,1]]],Y:[[new de(new e(1,"y",.5),new jt({color:65280}))],[new pe(new K(.04,0),new Ut({color:65280})),[0,0,.99],null,[3,1,1]]],Z:[[new de(new e(1,"z",.5),new jt({color:255}))],[new pe(new K(.04,0),new Ut({color:255})),[.99,0,0],null,[1,3,1]]],E:[[new de(new e(1.25,"z",1),new jt({color:13421568}))]],XYZ:[[new de(new e(1,"z",1),new jt({color:7895160}))]]},this.pickerGizmos={X:[[new Vt,[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Vt,[0,0,0],[Math.PI/2,0,0]]],Z:[[new Vt,[0,0,0],[0,0,-Math.PI/2]]],E:[[new Vt({radius:1.25,tube:.12,radialSegments:2,tubularSegments:24})]],XYZ:[[new Vt]]},this.init()}}class rs extends ts{constructor(){super(),this.isScaleGizmo=!0,this.type="ScaleGizmo",this.handleGizmos={XYZ:new es({color:11184810}).setScale(.15,.15,.15),XY:new Kt({color:11184640,direction:new p(1,1,0)}).setScale(.33,.33,1),YZ:new Kt({color:43690,direction:new p(0,1,1)}).setScale(.33,.33,1).setRotationFromAxisAndAngle(new p(0,1,0),l(-90)),XZ:new Kt({color:11141290,direction:new p(1,0,1)}).setScale(.33,.33,1).setRotationFromAxisAndAngle(new p(1,0,0),l(90)),X:new $t({color:11141120,direction:new p(1,0,0)}),Y:new $t({color:43520,direction:new p(0,1,0)}),Z:new $t({color:170,direction:new p(0,0,1)})},this.init()}}const ns=o({None:"None",Translate:"Translate",Rotate:"Rotate",Scale:"Scale"});class os extends L{constructor(e={}){const t={camera:null,domElement:window,mode:ns.None,objectsToClip:new L,...e};super(),this._handlers={onMouseEnter:this._onMouseEnter.bind(this),onMouseLeave:this._onMouseLeave.bind(this),onMouseDown:this._onMouseDown.bind(this),onMouseMove:this._onMouseMove.bind(this),onMouseWheel:this._onMouseWheel.bind(this),onMouseUp:this._onMouseUp.bind(this),onDblClick:this._onDblClick.bind(this),onTouchStart:this._onTouchStart.bind(this),onTouchEnd:this._onTouchEnd.bind(this),onTouchCancel:this._onTouchCancel.bind(this),onTouchLeave:this._onTouchLeave.bind(this),onTouchMove:this._onTouchMove.bind(this),onKeyDown:this._onKeyDown.bind(this),onKeyUp:this._onKeyUp.bind(this)},this._events={impose:{type:"impose"},dispose:{type:"dispose"},change:{type:"change"},translate:{type:"translate"},rotate:{type:"rotate"},scale:{type:"scale"},mouseEnter:{type:"mouseEnter"},mouseLeave:{type:"mouseLeave"},mouseDown:{type:"mouseDown"},mouseUp:{type:"mouseUp"}},this._objectsToClipBoundingBox=new b,this._objectsToClipSize=new p,this._objectsToClipCenter=new p,this._clippingBox=new Gt,this.add(this._clippingBox),this.camera=t.camera,this.domElement=t.domElement,this.mode=t.mode,this.objectsToClip=t.objectsToClip,this.translationSnap=.1,this.scaleSnap=.1,this.rotationSnap=.1,this.matrixAutoUpdate=!1,this.enabled=!1,this.size=1,this._dragging=!1,this._firstPoint=new p,this._secondPoint=new p,this._mouseDisplacement=new p,this._offset=new p,this._raycaster=new X,this._pointerVector=new U,this._directionToMouse=new p,this._cameraPosition=new p,this._cameraDirection=new p,this._worldPosition=new p,this._worldRotation=new he,this._gizmos={Translate:new ss,Scale:new rs};for(let e in this._gizmos)this.add(this._gizmos[e]);this._currentGizmo=null,this._currentHandle=null,this.actionsMap={setMode:{translate:[i.T.value],rotate:[i.R.value],scale:[i.S.value]},translate:{front:[i.Z.value,i.UP_ARROW.value],back:[i.S.value,i.DOWN_ARROW.value],up:[i.A.value,i.PAGE_UP.value],down:[i.E.value,i.PAGE_DOWN.value],left:[i.Q.value,i.LEFT_ARROW.value],right:[i.D.value,i.RIGHT_ARROW.value]},scale:{widthPlus:[i.LEFT_ARROW.value],widthMinus:[i.RIGHT_ARROW.value],heightPlus:[i.PAGE_UP.value],heightMinus:[i.PAGE_DOWN.value],depthPlus:[i.UP_ARROW.value],depthMinus:[i.DOWN_ARROW.value]},rotate:{xAxis:[i.X.value],yAxis:[i.Y.value],zAxis:[i.Z.value]}}}get objectsToClip(){return this._objectsToClip}set objectsToClip(e){if(y(e))throw new Error("Objects to clip cannot be null ! Expect an instance of Object3D");if(x(e))throw new Error("Objects to clip cannot be undefined ! Expect an instance of Object3D");if(!(e instanceof L))throw new Error(`Objects to clip cannot be an instance of ${e.constructor.name}. Expect an instance of Object3D.`);this._objectsToClip=e,this.updateClipping()}get camera(){return this._camera}set camera(e){if(y(e))throw new Error("Camera cannot be null ! Expect an instance of Camera");if(x(e))throw new Error("Camera cannot be undefined ! Expect an instance of Camera");if(!(e instanceof j))throw new Error(`Camera cannot be an instance of ${e.constructor.name}. Expect an instance of Camera.`);this._camera=e}get domElement(){return this._domElement}set domElement(e){if(y(e))throw new Error("DomElement cannot be null ! Expect an instance of Window, HTMLDocument, HTMLDivElement or HTMLCanvasElement.");if(x(e))throw new Error("DomElement cannot be undefined ! Expect an instance of Window, HTMLDocument, HTMLDivElement or HTMLCanvasElement.");if(!(e instanceof Window||e instanceof HTMLDocument||e instanceof HTMLDivElement||e instanceof HTMLCanvasElement))throw new Error(`Target cannot be an instance of ${e.constructor.name}. Expect an instance of Window, HTMLDocument, HTMLDivElement or HTMLCanvasElement.`);this._domElement&&(this._domElement.removeEventListener("mouseenter",this._handlers.onMouseEnter,!1),this._domElement.removeEventListener("mouseleave",this._handlers.onMouseLeave,!1),this.dispose()),this._domElement=e,this._domElement.addEventListener("mouseenter",this._handlers.onMouseEnter,!1),this._domElement.addEventListener("mouseleave",this._handlers.onMouseLeave,!1),this.impose()}get mode(){return this._mode}set mode(e){if(y(e))throw new Error("Mode cannot be null ! Expect a value from ClippingModes enum.");if(x(e))throw new Error("Mode cannot be undefined ! Expect a value from ClippingModes enum.");this._mode=e;for(let e in this._gizmos)this._gizmos[e].visible=!1;this._mode===ns.None?this._currentGizmo=null:(this._currentGizmo=this._gizmos[this._mode],this._currentGizmo.visible=!0),this.updateGizmo()}setCamera(e){return this.camera=e,this}setDomElement(e){return this.domElement=e,this}setMode(e){return this.mode=e,this}setObjectsToClip(e){return this.objectsToClip=e,this}impose(){this._domElement.addEventListener("keydown",this._handlers.onKeyDown,!1),this._domElement.addEventListener("keyup",this._handlers.onKeyUp,!1),this._domElement.addEventListener("dblclick",this._handlers.onDblClick,!1),this._domElement.addEventListener("mousedown",this._handlers.onMouseDown,!1),this._domElement.addEventListener("mousemove",this._handlers.onMouseMove,!1),this._domElement.addEventListener("mouseup",this._handlers.onMouseUp,!1),this._domElement.addEventListener("wheel",this._handlers.onMouseWheel,{capture:!0,once:!1,passive:!1}),this._domElement.addEventListener("touchcancel",this._handlers.onTouchCancel,!1),this._domElement.addEventListener("touchend",this._handlers.onTouchEnd,!1),this._domElement.addEventListener("touchleave",this._handlers.onTouchLeave,!1),this._domElement.addEventListener("touchmove",this._handlers.onTouchMove,{capture:!0,once:!1,passive:!1}),this._domElement.addEventListener("touchstart",this._handlers.onTouchStart,{capture:!0,once:!1,passive:!1}),this.dispatchEvent(this._events.impose)}dispose(){this._domElement.removeEventListener("keydown",this._handlers.onKeyDown,!1),this._domElement.removeEventListener("keyup",this._handlers.onKeyUp,!1),this._domElement.removeEventListener("dblclick",this._handlers.onDblClick,!1),this._domElement.removeEventListener("mousedown",this._handlers.onMouseDown,!1),this._domElement.removeEventListener("mousemove",this._handlers.onMouseMove,!1),this._domElement.removeEventListener("mouseup",this._handlers.onMouseUp,!1),this._domElement.removeEventListener("wheel",this._handlers.onMouseWheel,{capture:!0,once:!1,passive:!1}),this._domElement.removeEventListener("touchcancel",this._handlers.onTouchCancel,!1),this._domElement.removeEventListener("touchend",this._handlers.onTouchEnd,!1),this._domElement.removeEventListener("touchleave",this._handlers.onTouchLeave,!1),this._domElement.removeEventListener("touchmove",this._handlers.onTouchMove,{capture:!0,once:!1,passive:!1}),this._domElement.removeEventListener("touchstart",this._handlers.onTouchStart,{capture:!0,once:!1,passive:!1}),this.dispatchEvent(this._events.dispose)}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}enable(){this.visible=!0,this.enabled=!0,T(this._objectsToClip)&&(this._objectsToClipBoundingBox.setFromObject(this._objectsToClip),this._objectsToClipBoundingBox.getSize(this._objectsToClipSize),this._objectsToClipSize.divideScalar(2),this.scale.set(this._objectsToClipSize.x,this._objectsToClipSize.y,this._objectsToClipSize.z),this._objectsToClipBoundingBox.getCenter(this._objectsToClipCenter),this.position.set(this._objectsToClipCenter.x,this._objectsToClipCenter.y,this._objectsToClipCenter.z),this.updateMatrix(),this.updateMatrixWorld()),this.updateClipping(),this.updateGizmo()}disable(){this.visible=!1,this.enabled=!1,this.updateClipping()}updateClipping(){A(this._objectsToClip)||(this._clippingBox.update(),this._clippingBox.applyClippingTo(this.enabled,this._objectsToClip))}updateGizmo(){this.enabled&&this._mode!==ns.None&&(A(this._currentGizmo)||(this._camera.getWorldPosition(this._cameraPosition),this._camera.getWorldDirection(this._cameraDirection),this._currentGizmo.update(this._cameraPosition,this._cameraDirection)))}_consumeEvent(e){e.cancelable&&e.stopImmediatePropagation()}_onKeyDown(e){if(!this.enabled)return;e.preventDefault();const t=this.actionsMap,s=e.keyCode;if(e.ctrlKey)switch(this._mode){case ns.Translate:t.translate.front.includes(s)?(this._translateZ(this.translationSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.translate.back.includes(s)?(this._translateZ(-this.translationSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.translate.right.includes(s)?(this._translateX(this.translationSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.translate.left.includes(s)?(this._translateX(-this.translationSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.translate.up.includes(s)?(this._translateY(this.translationSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.translate.down.includes(s)&&(this._translateY(-this.translationSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change));break;case ns.Rotate:break;case ns.Scale:t.scale.depthPlus.includes(s)?(this._scaleZ(this.scaleSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.scale.depthMinus.includes(s)?(this._scaleZ(-this.scaleSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.scale.widthPlus.includes(s)?(this._scaleX(this.scaleSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.scale.widthMinus.includes(s)?(this._scaleX(-this.scaleSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.scale.heightPlus.includes(s)?(this._scaleY(this.scaleSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)):t.scale.heightMinus.includes(s)&&(this._scaleY(-this.scaleSnap),this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change))}else t.setMode.translate.includes(s)?(this.setMode(ns.Translate),this.updateClipping(),this._consumeEvent(e)):t.setMode.rotate.includes(s)?(this.setMode(ns.Rotate),this.updateClipping(),this._consumeEvent(e)):t.setMode.scale.includes(s)&&(this.setMode(ns.Scale),this.updateClipping(),this._consumeEvent(e))}_onKeyUp(e){this.enabled&&!e.defaultPrevented&&e.preventDefault()}_onDblClick(e){this.enabled&&this._mode!==ns.None&&e.preventDefault()}_onMouseDown(e){if(!this.enabled)return;if(this._mode===ns.None)return;if(e.button!==r.LEFT.value)return;if(A(this._currentHandle))return;e.preventDefault(),this._dragging=!0;const t=this.intersectObjects(e,[this._currentGizmo.intersectPlane]);t&&(this._firstPoint=t.point),this._consumeEvent(e),this.dispatchEvent(this._events.mouseDown)}_onMouseEnter(e){this.enabled&&this._mode!==ns.None&&(e.preventDefault(),this.impose(),e.target.constructor!==HTMLDocument&&this._domElement.focus())}_onMouseLeave(e){this.enabled&&this._mode!==ns.None&&(e.preventDefault(),this._dragging=!1,e.target.constructor!==HTMLDocument&&this._domElement.blur(),this.dispose())}_onMouseMove(e){if(this.enabled&&this._mode!==ns.None)if(e.preventDefault(),!1===this._dragging){const t=this.intersectObjects(e,this._currentGizmo.handles.children);if(t){const s=t.object;this._currentHandle&&s!==this._currentHandle&&(this._currentHandle.highlight(!1),this.dispatchEvent(this._events.mouseLeave)),this._currentHandle=s,this._currentHandle.highlight(!0),this.dispatchEvent(this._events.mouseEnter),this._consumeEvent(e)}else T(this._currentHandle)&&(this._currentHandle.highlight(!1),this._currentHandle=null,this.dispatchEvent(this._events.mouseLeave))}else{const t=this._currentHandle,s=t.name,i=this.intersectObjects(e,[this._currentGizmo.intersectPlane]);switch(i&&(this._secondPoint=i.point),this._mouseDisplacement.subVectors(this._secondPoint,this._firstPoint),this._firstPoint.copy(this._secondPoint),this._mode){case ns.Translate:"X"===s?this._offset.set(1,0,0):"Y"===s?this._offset.set(0,1,0):"Z"===s?this._offset.set(0,0,1):"XY"===s?this._offset.set(1,1,0):"YZ"===s?this._offset.set(0,1,1):"XZ"===s?this._offset.set(1,0,1):"XYZ"===s&&this._offset.set(1,1,1),this._offset.multiply(this._mouseDisplacement),this._translate(this._offset);break;case ns.Rotate:break;case ns.Scale:if(t.isScaleHandle)this._offset.copy(this._currentHandle.direction).multiply(this._mouseDisplacement);else if(t.isPlaneHandle){const e=this._currentHandle.xDirection.dot(this._mouseDisplacement);e>0?this._offset.setX(Math.abs(this._mouseDisplacement.x)):e<0?this._offset.setX(-Math.abs(this._mouseDisplacement.x)):this._offset.setX(0);const t=this._currentHandle.yDirection.dot(this._mouseDisplacement);t>0?this._offset.setY(Math.abs(this._mouseDisplacement.y)):t<0?this._offset.setY(-Math.abs(this._mouseDisplacement.y)):this._offset.setY(0);const s=this._currentHandle.zDirection.dot(this._mouseDisplacement);s>0?this._offset.setZ(Math.abs(this._mouseDisplacement.z)):s<0?this._offset.setZ(-Math.abs(this._mouseDisplacement.z)):this._offset.setZ(0)}else if(t.isOmnidirectionalHandle){this.getWorldPosition(this._worldPosition),this._directionToMouse.subVectors(this._firstPoint,this._worldPosition);const e=this._directionToMouse.dot(this._mouseDisplacement)>0?this._mouseDisplacement.length():-this._mouseDisplacement.length();this._offset.set(e,e,e)}this._scale(this._offset);break;default:throw new RangeError(`Invalid switch parameter: ${this._mode}`)}this.updateClipping(),this._consumeEvent(e),this.dispatchEvent(this._events.change)}}_onMouseUp(e){if(!this.enabled)return;if(this._mode===ns.None)return;if(e.button!==r.LEFT.value)return;e.preventDefault(),this._dragging=!1,this.dispatchEvent(this._events.mouseUp);const t=this.intersectObjects(e,this._currentGizmo.handles.children);t?(this._currentHandle=t.object,this._currentHandle.highlight(!0),this._consumeEvent(e),this.dispatchEvent(this._events.mouseEnter)):T(this._currentHandle)&&(this._currentHandle.highlight(!1),this._currentHandle=null,this.dispatchEvent(this._events.mouseLeave)),this.updateGizmo()}_onMouseWheel(e){this.enabled&&e.preventDefault()}_onTouchCancel(e){this.enabled&&e.preventDefault()}_onTouchEnd(e){this.enabled&&e.preventDefault()}_onTouchLeave(e){this.enabled&&e.preventDefault()}_onTouchMove(e){this.enabled&&e.preventDefault()}_onTouchStart(e){this.enabled&&e.preventDefault()}getActiveHandle(e){}intersectObjects(e,t){const s=this._domElement.getBoundingClientRect(),i=(e.clientX-s.left)/s.width*2-1,r=-(e.clientY-s.top)/s.height*2+1;this._pointerVector.set(i,r),this._raycaster.setFromCamera(this._pointerVector,this._camera);const n=this._raycaster.intersectObjects(t,!1);return n[0]?n[0]:null}_translate(e){this.position.add(e),this.updateMatrix()}_translateX(e){this.position.setX(this.position.x+e),this.updateMatrix()}_translateY(e){this.position.setY(this.position.y+e),this.updateMatrix()}_translateZ(e){this.position.setZ(this.position.z+e),this.updateMatrix()}_translateXY(e,t){this.position.setX(this.position.x+e),this.position.setY(this.position.y+t),this.updateMatrix()}_translateXZ(e,t){this.position.setX(this.position.x+e),this.position.setZ(this.position.z+t),this.updateMatrix()}_translateYZ(e,t){this.position.setY(this.position.y+e),this.position.setZ(this.position.z+t),this.updateMatrix()}_translateXYZ(e,t,s){this.position.set(this.position.x+e,this.position.y+t,this.position.z+s),this.updateMatrix()}_rotateX(e){}_rotateY(e){}_rotateZ(e){}_rotateXY(e){}_rotateXZ(e){}_rotateYZ(e){}_rotateXYZ(e){}_scale(e){this.scale.add(e),this.updateMatrix()}_scaleX(e){this.scale.setX(this.scale.x+e),this.updateMatrix()}_scaleY(e){this.scale.setY(this.scale.y+e),this.updateMatrix()}_scaleZ(e){this.scale.setZ(this.scale.z+e),this.updateMatrix()}_scaleXY(e,t){this.scale.setX(this.scale.x+e),this.scale.setY(this.scale.y+t),this.updateMatrix()}_scaleXZ(e,t){this.scale.setX(this.scale.x+e),this.scale.setZ(this.scale.z+t),this.updateMatrix()}_scaleYZ(e,t){this.scale.setY(this.scale.y+e),this.scale.setZ(this.scale.z+t),this.updateMatrix()}_scaleXYZ(e,t,s){this.scale.set(this.scale.x+e,this.scale.y+t,this.scale.z+s),this.updateMatrix()}}
/**
 * @module Managers/CurvesManager
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 * @example Todo
 *
 */class as extends n{constructor(e={}){super({basePath:"/curves",...e})}convert(e){if(!e)throw new Error("CurvesManager: Unable to convert null or undefined data !");const t=e.type;let s;switch(t){case"ArcCurve":s=new _e;break;case"CatmullRomCurve3":s=new ge;break;case"CubicBezierCurve":s=new be;break;case"CubicBezierCurve3":s=new we;break;case"Curve":s=new ve;break;case"CurvePath":s=new me;break;case"EllipseCurve":s=new ye;break;case"LineCurve":s=new xe;break;case"LineCurve3":s=new Ee;break;case"Path":s=new fe;break;case"QuadraticBezierCurve":s=new Me;break;case"QuadraticBezierCurve3":s=new Ae;break;case"SplineCurve":s=new Pe;break;case"Shape":s=new c;break;default:throw new Error(`TCurvesManager: Unknown curve of type: ${t}`)}return s.fromJSON(e),s}_onJson(e,t,s,i){const r=D(e)?[e]:e,n={};for(let e,t=0,o=r.length;t<o;t++){e=r[t];try{n[e._id]=this.convert(e)}catch(e){i(e)}s(t/o)}t(n)}}
/**
 * @module Managers/GeometriesManager
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 * @requires {@link TDataBaseManager}
 * @requires '../../../node_modules/three/src/core/Geometry'
 * @requires { BufferGeometry } from 'three'
 * @requires '../../../node_modules/three/src/core/BufferAttribute'
 *
 */const hs=o({Int8Array:0,Uint8Array:1,Uint8ClampedArray:2,Int16Array:3,Uint16Array:4,Int32Array:5,Uint32Array:6,Float32Array:7,Float64Array:8});class ls extends n{constructor(e={}){const t={basePath:"/geometries",projectionSystem:"zBack",globalScale:1,computeNormals:!0,computeBoundingBox:!0,computeBoundingSphere:!0,...e};super(t),this.projectionSystem=t.projectionSystem,this.globalScale=t.globalScale,this.computeNormals=t.computeNormals,this.computeBoundingBox=t.computeBoundingBox,this.computeBoundingSphere=t.computeBoundingSphere}get computeBoundingBox(){return this._computeBoundingBox}set computeBoundingBox(e){if(y(e))throw new TypeError("Compute bounding box cannot be null ! Expect a boolean.");if(x(e))throw new TypeError("Compute bounding box cannot be undefined ! Expect a boolean.");if(E(e))throw new TypeError(`Compute bounding box cannot be an instance of ${e.constructor.name} ! Expect a boolean.`);this._computeBoundingBox=e}get computeBoundingSphere(){return this._computeBoundingSphere}set computeBoundingSphere(e){if(y(e))throw new TypeError("Compute bounding sphere cannot be null ! Expect a boolean.");if(x(e))throw new TypeError("Compute bounding sphere cannot be undefined ! Expect a boolean.");if(E(e))throw new TypeError(`Compute bounding sphere cannot be an instance of ${e.constructor.name} ! Expect a boolean.`);this._computeBoundingSphere=e}get computeNormals(){return this._computeNormals}set computeNormals(e){if(y(e))throw new TypeError("Compute normals cannot be null ! Expect a boolean.");if(x(e))throw new TypeError("Compute normals cannot be undefined ! Expect a boolean.");if(E(e))throw new TypeError(`Compute normals cannot be an instance of ${e.constructor.name} ! Expect a boolean.`);this._computeNormals=e}get projectionSystem(){return this._projectionSystem}set projectionSystem(e){if(y(e))throw new TypeError("Projection system cannot be null ! Expect a positive number.");if(x(e))throw new TypeError("Projection system cannot be undefined ! Expect a positive number.");this._projectionSystem=e}get globalScale(){return this._globalScale}set globalScale(e){if(y(e))throw new TypeError("Global scale cannot be null ! Expect a positive number.");if(x(e))throw new TypeError("Global scale cannot be undefined ! Expect a positive number.");this._globalScale=e}setComputeBoundingBox(e){return this.computeBoundingBox=e,this}setComputeBoundingShpere(e){return this.computeBoundingSphere=e,this}setComputeNormals(e){return this.computeNormals=e,this}setProjectionSystem(e){return this.projectionSystem=e,this}setGlobalScale(e){return this.globalScale=e,this}_onJson(e,t,s,i){const r=D(e)?[e]:e,n={};for(let e,t=0,o=r.length;t<o;t++){e=r[t];try{n[e._id]=this.convert(e)}catch(e){i(e)}s(new ProgressEvent("GeometriesManager",{lengthComputable:!0,loaded:t+1,total:o}))}t(n)}convert(e){if(!e)throw new Error("GeometriesManager: Unable to convert null or undefined data !");const t=e.type;if(!t)throw new Error("GeometriesManager: Unable to convert untyped data !");let s=null;if(e.isBufferGeometry||t.includes("BufferGeometry"))s=this._convertJsonToBufferGeometry(e),this._computeNormals&&s.computeVertexNormals();else{if(!e.isGeometry&&!t.includes("Geometry"))throw new Error(`TGeometriesManager: Unable to retrieve geometry of type ${t} !`);s=this._convertJsonToGeometry(e),this._computeNormals&&s.computeFaceNormals()}return this.computeBoundingBox&&(s.boundingBox=null,s.computeBoundingBox()),this.computeBoundingSphere&&(s.boundingSphere=null,s.computeBoundingSphere()),s}_convertJsonToGeometry(e){const t=e.types;let s=null;switch(t){case"BoxGeometry":s=new Z;break;case"CircleGeometry":s=new Ce;break;case"CylinderGeometry":s=new $;break;case"ConeGeometry":s=new W;break;case"EdgesGeometry":s=new Q;break;case"DodecahedronGeometry":s=new ke;break;case"ExtrudeGeometry":s=new ze;break;case"Geometry":s=new Se;break;case"IcosahedronGeometry":s=new Be;break;case"LatheGeometry":s=new Ge;break;case"OctahedronGeometry":s=new J;break;case"ParametricGeometry":s=new je;break;case"PlaneGeometry":s=new te;break;case"PolyhedronGeometry":s=new Re;break;case"RingGeometry":s=new Xe;break;case"ShapeGeometry":s=new Ze;break;case"TetrahedronGeometry":s=new Ve;break;case"TextGeometry":s=new qe;break;case"TorusGeometry":s=new ne;break;case"TorusKnotGeometry":s=new Qe;break;case"TubeGeometry":s=new Je;break;case"SphereGeometry":s=new ie;break;case"WireframeGeometry":s=new tt;break;default:throw new Error(`TGeometriesManager: Unknown geometry of type: ${t}`)}s.uuid=e.uuid,s.name=e.name,s.type=e.type;for(var i=[],r=void 0,n=0,o=e.vertices.length;n<o;++n)r=e.vertices[n],i.push(new p(r.x,r.y,r.z));s.vertices=i;for(var a=[],h=void 0,l=0,c=e.faces.length;l<c;l++)h=e.faces[l],a.push(new Te(h.a,h.b,h.c,h.normal,h.color,h.materialIndex));s.faces=a,s.morphTargets=[],s.morphNormals=[],s.skinWeights=[],s.skinIndices=[],s.lineDistances=[],s.elementsNeedUpdate=!0,s.verticesNeedUpdate=!0,s.uvsNeedUpdate=!0,s.normalsNeedUpdate=!0,s.colorsNeedUpdate=!0,s.lineDistancesNeedUpdate=!0,s.groupsNeedUpdate=!0}_convertJsonToBufferGeometry(e){const t=e.type;let s=null;switch(t){case"BoxBufferGeometry":s=new Y;break;case"BufferGeometry":s=new _;break;case"CircleBufferGeometry":s=new Oe;break;case"CylinderBufferGeometry":s=new q;break;case"ConeBufferGeometry":s=new V;break;case"DodecahedronBufferGeometry":s=new Ie;break;case"ExtrudeBufferGeometry":s=new Fe;break;case"IcosahedronBufferGeometry":s=new Le;break;case"LatheBufferGeometry":s=new Ue;break;case"OctahedronBufferGeometry":s=new K;break;case"ParametricBufferGeometry":s=new He;break;case"PlaneBufferGeometry":s=new ee;break;case"PolyhedronBufferGeometry":s=new Ne;break;case"RingBufferGeometry":s=new Ye;break;case"ShapeBufferGeometry":s=new _;break;case"TetrahedronBufferGeometry":s=new We;break;case"TextBufferGeometry":s=new $e;break;case"TorusBufferGeometry":s=new re;break;case"TorusKnotBufferGeometry":s=new Ke;break;case"TubeBufferGeometry":s=new et;break;case"SphereBufferGeometry":s=new se;break;case"InstancedBufferGeometry":s=new De;break;default:throw new Error(`TGeometriesManager: Unknown buffer geometry of type: ${t}`)}s._id=e._id,s.uuid=e.uuid,s.name=e.name;const i=e.index;if(i&&i.array&&i.array.length>0){const e=this.__convertBase64ToArrayBuffer(i.array),t=this.__convertArrayBufferToTypedArray(e);s.index=new m(t,i.itemSize,i.normalized)}const r=e.attributes;if(r){let e={};const t=r.position;if(t){const s=this.__convertBase64ToArrayBuffer(t.array),i=this.__convertArrayBufferToTypedArray(s),r=this.globalScale,n=new Float32Array(i);if("zBack"===this._projectionSystem){let e=null,t=null,s=null;for(let i=0,o=n.length;i<o;i+=3)e=n[i]/r,t=n[i+2]/r,s=-n[i+1]/r,n[i]=e,n[i+1]=t,n[i+2]=s}else for(let e=0,t=n.length;e<t;e++)n[e]/=r;e.position=new m(n,t.itemSize,t.normalized)}const i=r.normal;if(i){const t=this.__convertBase64ToArrayBuffer(i.array),s=this.__convertArrayBufferToTypedArray(t);e.normal=new m(s,i.itemSize,i.normalized)}const n=r.uv;if(n){const t=this.__convertBase64ToArrayBuffer(n.array),s=this.__convertArrayBufferToTypedArray(t);e.uv=new m(s,n.itemSize,n.normalized)}s.attributes=e}return T(e.groups)&&(s.groups=e.groups),T(e.boundingBox)&&(s.boundingBox=e.boundingBox),T(e.boundingSphere)&&(s.boundingSphere=e.boundingSphere),"ShapeBufferGeometry"===t&&(s.shapes=e.shapes.map((e=>(new c).fromJSON(e))),s.curveSegments=e.curveSegments),s}__convertArrayBufferToTypedArray(e){const t=new DataView(e),s=e.byteLength-1,i=t.getUint8(0);let r=null;switch(i){case hs.Int8Array:r=new Int8Array(s/1);for(let e=0,i=1;i<s;e++,i+=1)r[e]=t.getInt8(i);break;case hs.Uint8Array:r=new Uint8Array(s/1);for(let e=0,i=1;i<s;e++,i+=1)r[e]=t.getUint8(i);break;case hs.Uint8ClampedArray:r=new Uint8ClampedArray(s/1);for(let e=0,i=1;i<s;e++,i+=1)r[e]=t.getUint8(i);break;case hs.Int16Array:r=new Int16Array(s/2);for(let e=0,i=1;i<s;e++,i+=2)r[e]=t.getInt16(i);break;case hs.Uint16Array:r=new Uint16Array(s/2);for(let e=0,i=1;i<s;e++,i+=2)r[e]=t.getUint16(i);break;case hs.Int32Array:r=new Int32Array(s/4);for(let e=0,i=1;i<s;e++,i+=4)r[e]=t.getInt32(i);break;case hs.Uint32Array:r=new Uint32Array(s/4);for(let e=0,i=1;i<s;e++,i+=4)r[e]=t.getUint32(i);break;case hs.Float32Array:r=new Float32Array(s/4);for(let e=0,i=1;i<s;e++,i+=4)r[e]=t.getFloat32(i);break;case hs.Float64Array:r=new Float64Array(s/8);for(let e=0,i=1;i<s;e++,i+=8)r[e]=t.getFloat64(i);break;default:throw new RangeError(`Invalid switch parameter: ${i}`)}return r}__convertBase64ToArrayBuffer(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=new Uint8Array(256);for(let e=0;e<t.length;e++)s[t.charCodeAt(e)]=e;const i=e.length;let r=.75*i;"="===e[i-1]&&(r--,"="===e[i-2]&&r--);let n,o,a,h,l=new ArrayBuffer(r),c=new Uint8Array(l);for(let t=0,r=0;t<i;t+=4)n=s[e.charCodeAt(t)],o=s[e.charCodeAt(t+1)],a=s[e.charCodeAt(t+2)],h=s[e.charCodeAt(t+3)],c[r++]=n<<2|o>>4,c[r++]=(15&o)<<4|a>>2,c[r++]=(3&a)<<6|63&h;return l}}
/**
 * @module Managers/TexturesManager
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */class cs extends n{constructor(e={}){super({basePath:"/textures",...e})}convert(e){if(!e)throw new Error("TexturesManager: Unable to convert null or undefined data !");const t=e.type;throw new Error(`TTexturesManager: Unknown texture of type: ${t}`)}_onJson(e,t,s,i){const r=D(e)?[e]:e,n={};for(let e,t=0,o=r.length;t<o;t++){e=r[t];try{n[e._id]=this.convert(e)}catch(e){i(e)}s(t/o)}t(n)}}
/**
 * @module Managers/MaterialsManager
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 * @requires TDataBaseManager
 *
 */const ds=(new st).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4gkKDRoGpGNegQAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAMSURBVAjXY/j//z8ABf4C/tzMWecAAAAASUVORK5CYII=");class us extends n{constructor(e={}){const t={basePath:"/materials",texturesPath:"/textures",texturesProvider:new it,generateMipmap:!1,autoFillTextures:!0,...e};super(t),this.texturesPath=t.texturesPath,this.texturesProvider=t.texturesProvider,this.generateMipmap=t.generateMipmap,this.autoFillTextures=t.autoFillTextures}get texturesPath(){return this._texturesPath}set texturesPath(e){if(y(e))throw new TypeError("Textures path cannot be null ! Expect a non empty string.");if(x(e))throw new TypeError("Textures path cannot be undefined ! Expect a non empty string.");if(C(e))throw new TypeError(`Textures path cannot be an instance of ${e.constructor.name} ! Expect a non empty string.`);if(O(e))throw new TypeError("Textures path cannot be empty ! Expect a non empty string.");if(k(e))throw new TypeError("Textures path cannot contain only whitespace ! Expect a non empty string.");this._texturesPath=e}get texturesProvider(){return this._texturesProvider}set texturesProvider(e){if(y(e))throw new TypeError("Textures provider cannot be null ! Expect an instance of TextureLoader.");if(x(e))throw new TypeError("Textures provider cannot be undefined ! Expect an instance of TextureLoader.");if(!(e instanceof cs||e instanceof it))throw new TypeError(`Textures provider cannot be an instance of ${e.constructor.name} ! Expect an instance of TTexturesManager.`);this._texturesProvider=e}get generateMipmap(){return this._generateMipmap}set generateMipmap(e){if(y(e))throw new TypeError("Generate mipmap cannot be null ! Expect a boolean.");if(x(e))throw new TypeError("Generate mipmap cannot be undefined ! Expect a boolean.");if(E(e))throw new TypeError(`Generate mipmap cannot be an instance of ${e.constructor.name} ! Expect a boolean.`);this._generateMipmap=e}get autoFillTextures(){return this._autoFillTextures}set autoFillTextures(e){if(y(e))throw new TypeError("Global scale cannot be null ! Expect a boolean.");if(x(e))throw new TypeError("Global scale cannot be undefined ! Expect a positive number.");if(E(e))throw new TypeError("Global scale cannot be null ! Expect a boolean.");this._autoFillTextures=e}setTexturesPath(e){return this.texturesPath=e,this}setTexturesProvider(e){return this.texturesProvider=e,this}setGenerateMipmap(e){return this.generateMipmap=e,this}setAutoFillTextures(e){return this.autoFillTextures=e,this}_onJson(e,t,s,i){const r=D(e)?[e]:e,n={};for(let e,t=0,o=r.length;t<o;t++){e=r[t];try{n[e._id]=this.convert(e)}catch(e){i(e)}s(new ProgressEvent("MaterialsManager",{lengthComputable:!0,loaded:t+1,total:o}))}this._autoFillTextures?this.fillTextures(n,t,s,i):t(n)}convert(e){if(!e)throw new Error("MaterialsManager: Unable to convert null or undefined data !");const t=e.type;let s=null;switch(t){case"MeshPhongMaterial":{s=new nt,this._fillBaseMaterialData(s,e);const t=e.color;T(t)&&(s.color=this._setColor(t));const i=e.specular;T(i)&&(s.specular=this._setColor(i));const r=e.shininess;T(r)&&(s.shininess=r);const n=e.map;T(n)&&(s.map=n);const o=e.lightMap;T(o)&&(s.lightMap=o);const a=e.lightMapIntensity;T(a)&&(s.lightMapIntensity=a);const h=e.aoMap;T(h)&&(s.aoMap=h);const l=e.aoMapIntensity;T(l)&&(s.aoMapIntensity=l);const c=e.emissive;T(c)&&(s.emissive=this._setColor(c));const d=e.emissiveIntensity;T(d)&&(s.emissiveIntensity=d);const u=e.emissiveMap;T(u)&&(s.emissiveMap=u);const p=e.bumpMap;T(p)&&(s.bumpMap=p);const m=e.bumpScale;T(m)&&(s.bumpScale=m);const f=e.normalMap;T(f)&&(s.normalMap=f);const _=e.normalScale;T(_)&&(s.normalScale=this._setVector2(_));const g=e.displacementMap;T(g)&&(s.displacementMap=g);const b=e.displacementScale;T(b)&&(s.displacementScale=b);const w=e.displacementBias;T(w)&&(s.displacementBias=w);const v=e.specularMap;T(v)&&(s.specularMap=v);const y=e.alphaMap;T(y)&&(s.alphaMap=y);const x=e.envMap;T(x)&&(s.envMap=x);const E=e.combine;T(E)&&(s.combine=E);const M=e.reflectivity;T(M)&&(s.reflectivity=M);const A=e.refractionRatio;T(A)&&(s.refractionRatio=A);const P=e.wireframe;T(P)&&(s.wireframe=P);const S=e.wireframeLinewidth;T(S)&&(s.wireframeLinewidth=S);const D=e.wireframeLinecap;T(D)&&(s.wireframeLinecap=D);const C=e.wireframeLinejoin;T(C)&&(s.wireframeLinejoin=C);const O=e.skinning;T(O)&&(s.skinning=O);const k=e.morphTargets;T(k)&&(s.morphTargets=k);const I=e.morphNormals;T(I)&&(s.morphNormals=I)}break;case"MeshLambertMaterial":{s=new rt,this._fillBaseMaterialData(s,e);const t=e.color;T(t)&&(s.color=this._setColor(t));const i=e.map;T(i)&&(s.map=i);const r=e.lightMap;T(r)&&(s.lightMap=r);const n=e.lightMapIntensity;T(n)&&(s.lightMapIntensity=n);const o=e.aoMap;T(o)&&(s.aoMap=o);const a=e.aoMapIntensity;T(a)&&(s.aoMapIntensity=a);const h=e.emissive;T(h)&&(s.emissive=this._setColor(h));const l=e.emissiveIntensity;T(l)&&(s.emissiveIntensity=l);const c=e.emissiveMap;T(c)&&(s.emissiveMap=c);const d=e.specularMap;T(d)&&(s.specularMap=d);const u=e.alphaMap;T(u)&&(s.alphaMap=u);const p=e.envMap;T(p)&&(s.envMap=p);const m=e.combine;T(m)&&(s.combine=m);const f=e.reflectivity;T(f)&&(s.reflectivity=f);const _=e.refractionRatio;T(_)&&(s.refractionRatio=_);const g=e.wireframe;T(g)&&(s.wireframe=g);const b=e.wireframeLinewidth;T(b)&&(s.wireframeLinewidth=b);const w=e.wireframeLinecap;T(w)&&(s.wireframeLinecap=w);const v=e.wireframeLinejoin;T(v)&&(s.wireframeLinejoin=v);const y=e.skinning;T(y)&&(s.skinning=y);const x=e.morphTargets;T(x)&&(s.morphTargets=x);const E=e.morphNormals;T(E)&&(s.morphNormals=E)}break;case"LineBasicMaterial":{s=new oe,this._fillBaseMaterialData(s,e);const t=e.color;T(t)&&(s.color=this._setColor(t))}break;case"PointsMaterial":{s=new g,this._fillBaseMaterialData(s,e);const t=e.color;T(t)&&(s.color=this._setColor(t));const i=e.map;T(i)&&(s.map=i);const r=e.morphTargets;T(r)&&(s.morphTargets=r);const n=e.size;T(n)&&(s.size=n);const o=e.sizeAttenuation;T(o)&&(s.sizeAttenuation=o)}break;default:throw new Error(`TMaterialsManager: Unmanaged material of type: ${t}`)}return s}_fillBaseMaterialData(e,t){const s=t._id;T(s)&&I(s)&&(e._id=s);const i=t.uuid;T(i)&&I(i)&&(e.uuid=i);const r=t.name;T(r)&&I(r)&&(e.name=r);const n=t.fog;T(n)&&(e.fog=n);const o=t.lights;T(o)&&(e.lights=o);const a=t.blending;T(a)&&(e.blending=a);const h=t.side;T(h)&&(e.side=h);const l=t.flatShading;T(l)&&(e.flatShading=l);const c=t.vertexColors;T(c)&&(e.vertexColors=c);const d=t.opacity;T(d)&&(e.opacity=d);const u=t.transparent;T(u)&&(e.transparent=u);const p=t.blendSrc;T(p)&&(e.blendSrc=p);const m=t.blendDst;T(m)&&(e.blendDst=m);const f=t.blendEquation;T(f)&&(e.blendEquation=f);const _=t.blendSrcAlpha;T(_)&&(e.blendSrcAlpha=_);const g=t.blendDstAlpha;T(g)&&(e.blendDstAlpha=g);const b=t.blendEquationAlpha;T(b)&&(e.blendEquationAlpha=b);const w=t.depthFunc;T(w)&&(e.depthFunc=w);const v=t.depthTest;T(v)&&(e.depthTest=v);const y=t.depthWrite;T(y)&&(e.depthWrite=y);const x=t.clippingPlanes;T(x)&&(e.clippingPlanes=x);const E=t.clipIntersection;T(E)&&(e.clipIntersection=E);const M=t.clipShadows;T(M)&&(e.clipShadows=M);const A=t.colorWrite;T(A)&&(e.colorWrite=A);const P=t.precision;T(P)&&(e.precision=P);const S=t.polygonOffset;T(S)&&(e.polygonOffset=S);const D=t.polygonOffsetFactor;T(D)&&(e.polygonOffsetFactor=D);const C=t.polygonOffsetUnits;T(C)&&(e.polygonOffsetUnits=C);const O=t.dithering;T(O)&&(e.dithering=O);const k=t.alphaTest;T(k)&&(e.alphaTest=k);const z=t.premultipliedAlpha;T(z)&&(e.premultipliedAlpha=z);const F=t.overdraw;T(F)&&(e.overdraw=F);const B=t.visible;T(B)&&(e.visible=B);const L=t.userData;T(L)&&(e.userData=L);const G=t.needsUpdate;T(G)&&(e.needsUpdate=G)}_setVector2(e){const t=e.x,s=e.y;if(A(t)||A(s))throw new Error("MaterialsManager: Unable to convert null or undefined vector 2 !");return new U(t,s)}_setColor(e){const t=e.r,s=e.g,i=e.b;if(A(t)||A(s)||A(i))throw new Error("MaterialsManager: Unable to convert null or undefined color !");return new ot(t,s,i)}fillTextures(e,t){const s=this._retrieveTexturesOf(e);for(let t in e){const i=e[t],r=s[t];for(let e in r)i[e]=r[e]}t(e)}_retrieveTexturesOf(e){const t=["map","lightMap","aoMap","emissiveMap","bumpMap","normalMap","displacementMap","specularMap","alphaMap","envMap"],s={},i={};for(let r in e){const n=e[r];let o={};for(let e=0,s=t.length;e<s;e++){let s=t[e];const r=n[s];if(T(r)&&I(r)&&z(r)){const e=`${this._texturesPath}/${r}`,t=i[e];if(T(t))o[s]=t;else{const t=this._texturesProvider.load(e,(()=>{}),(()=>{}),(()=>{t.image||(t.image=ds,t.needsUpdate=!0)}));t.name=r,this._generateMipmap||(t.generateMipmaps=!1,t.magFilter=R,t.minFilter=R),i[e]=t,o[s]=t}}}s[r]=o}return s}}
/**
 * @module Managers/ObjectsManager
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 */class ps extends n{constructor(e={}){const t={basePath:"/objects",geometriesProvider:new ls,materialsProvider:new us,projectionSystem:"zBack",globalScale:1,autoFillObjects3D:!0,...e};super(t),this.geometriesProvider=t.geometriesProvider,this.materialsProvider=t.materialsProvider,this.projectionSystem=t.projectionSystem,this.globalScale=t.globalScale,this.autoFillObjects3D=t.autoFillObjects3D}get geometriesProvider(){return this._geometriesProvider}set geometriesProvider(e){if(y(e))throw new TypeError("Geometries provider cannot be null ! Expect an instance of GeometriesManager.");if(x(e))throw new TypeError("Geometries provider cannot be undefined ! Expect an instance of GeometriesManager.");if(!(e instanceof ls))throw new TypeError(`Geometries provider cannot be an instance of ${e.constructor.name} ! Expect an instance of TGeometriesManager.`);this._geometriesProvider=e}get materialsProvider(){return this._materialsProvider}set materialsProvider(e){if(y(e))throw new TypeError("Materials provider cannot be null ! Expect an instance of MaterialsManager.");if(x(e))throw new TypeError("Materials provider cannot be undefined ! Expect an instance of MaterialsManager.");if(!(e instanceof us))throw new TypeError(`Materials provider cannot be an instance of ${e.constructor.name} ! Expect an instance of TMaterialsManager.`);this._materialsProvider=e}get projectionSystem(){return this._projectionSystem}set projectionSystem(e){if(y(e))throw new TypeError("Projection system cannot be null ! Expect a positive number.");if(x(e))throw new TypeError("Projection system cannot be undefined ! Expect a positive number.");this._projectionSystem=e}get globalScale(){return this._globalScale}set globalScale(e){if(y(e))throw new TypeError("Global scale cannot be null ! Expect a positive number.");if(x(e))throw new TypeError("Global scale cannot be undefined ! Expect a positive number.");this._globalScale=e}get autoFillObjects3D(){return this._autoFillObjects3D}set autoFillObjects3D(e){if(y(e))throw new TypeError("Global scale cannot be null ! Expect a boolean.");if(x(e))throw new TypeError("Global scale cannot be undefined ! Expect a positive number.");if(E(e))throw new TypeError("Global scale cannot be null ! Expect a boolean.");this._autoFillObjects3D=e}setGeometriesProvider(e){return this.geometriesProvider=e,this}setMaterialsProvider(e){return this.materialsProvider=e,this}setProjectionSystem(e){return this.projectionSystem=e,this}setGlobalScale(e){return this.globalScale=e,this}setAutoFillObjects3D(e){return this.autoFillObjects3D=e,this}_onJson(e,t,s,i){const r={};for(let t,n=0,o=e.length;n<o;n++){t=e[n];try{r[t._id]=this.convert(t)}catch(e){i(e)}s(new ProgressEvent("ObjectsManager",{lengthComputable:!0,loaded:n+1,total:o}))}this._autoFillObjects3D?this.fillObjects3D(r,t,s,i):t(r)}_onArrayBuffer(e,t,s,i){}_onBlob(e,t,s,i){}_onText(e,t,s,i){}convert(e){if(!e)throw new Error("ObjectsManager: Unable to convert null or undefined data !");const t=e.type;let s=null;switch(t){case"Object3D":s=new L,this._fillBaseObjectsData(s,e);break;case"Scene":s=new yt,this._fillBaseObjectsData(s,e),T(e.background)&&Number.isInteger(e.background)&&(s.background=new ot(e.background)),T(e.fog)&&("Fog"===e.fog.type?s.fog=new wt(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(s.fog=new vt(e.fog.color,e.fog.density))),s.overrideMaterial=e.overrideMaterial,s.autoUpdate=e.autoUpdate;break;case"PerspectiveCamera":s=new ht,this._fillBaseObjectsData(s,e),s.fov=e.fov,s.aspect=e.aspect,s.near=e.near,s.far=e.far,T(e.focus)&&(s.focus=e.focus),T(e.zoom)&&(s.zoom=e.zoom),T(e.filmGauge)&&(s.filmGauge=e.filmGauge),T(e.filmOffset)&&(s.filmOffset=e.filmOffset),T(e.view)&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new at(e.left,e.right,e.top,e.bottom,e.near,e.far),this._fillBaseObjectsData(s,e);break;case"AmbientLight":s=new lt(e.color,e.intensity),this._fillBaseObjectsData(s,e);break;case"DirectionalLight":s=new ct(e.color,e.intensity),this._fillBaseObjectsData(s,e);break;case"PointLight":s=new ut(e.color,e.intensity,e.distance,e.decay),this._fillBaseObjectsData(s,e);break;case"RectAreaLight":s=new pt(e.color,e.intensity,e.width,e.height),this._fillBaseObjectsData(s,e);break;case"SpotLight":s=new mt(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),this._fillBaseObjectsData(s,e);break;case"HemisphereLight":s=new dt(e.color,e.groundColor,e.intensity),this._fillBaseObjectsData(s,e);break;case"SkinnedMesh":s=new gt,this._fillBaseObjectsData(s,e),s.geometry=e.geometry,s.material=e.material,s.drawMode=e.drawMode,s.bindMode=e.bindMode,s.bindMatrix=e.bindMatrix,s.bindMatrixInverse=e.bindMatrixInverse;break;case"Mesh":s=new pe,this._fillBaseObjectsData(s,e),s.geometry=e.geometry,s.material=e.material,s.drawMode=e.drawMode;break;case"LOD":s=new _t,this._fillBaseObjectsData(s,e),s.levels=e.levels;break;case"Line":s=new de,this._fillBaseObjectsData(s,e),s.geometry=e.geometry,s.material=e.material,s.drawMode=e.drawMode;break;case"LineLoop":s=new ft,this._fillBaseObjectsData(s,e),s.geometry=e.geometry,s.material=e.material,s.drawMode=e.drawMode;break;case"LineSegments":s=new ue,this._fillBaseObjectsData(s,e),s.geometry=e.geometry,s.material=e.material,s.drawMode=e.drawMode;break;case"Points":s=new v,this._fillBaseObjectsData(s,e),s.geometry=e.geometry,s.material=e.material,s.drawMode=e.drawMode;break;case"Sprite":s=new bt,this._fillBaseObjectsData(s,e),s.material=e.material;break;case"Group":s=new w,this._fillBaseObjectsData(s,e);break;default:throw new Error(`TObjectsManager: Unknown object of type: ${t}`)}return s}_fillBaseObjectsData(e,t){e._id=t._id,T(t.uuid)&&(e.uuid=t.uuid),T(t.name)&&(e.name=t.name),T(t.parent)&&(e.parent=t.parent),F(t.children)&&(e.children=t.children),T(t.up)&&(e.up.x=t.up.x,e.up.y=t.up.y,e.up.z=t.up.z),T(t.position)&&("zBack"===this._projectionSystem?(e.position.x=t.position.x/this._globalScale,e.position.y=t.position.z/this._globalScale,e.position.z=-t.position.y/this._globalScale):(e.position.x=t.position.x/this._globalScale,e.position.y=t.position.y/this._globalScale,e.position.z=t.position.z/this._globalScale)),T(t.rotation)&&("zBack"===this._projectionSystem?(e.rotation.x=t.rotation.x,e.rotation.y=t.rotation.z,e.rotation.z=-t.rotation.y,e.rotation.order=t.rotation.order):(e.rotation.x=t.rotation.x,e.rotation.y=t.rotation.y,e.rotation.z=t.rotation.z,e.rotation.order=t.rotation.order)),T(t.quaternion)&&("zBack"===this._projectionSystem?(e.quaternion.x=t.quaternion.x,e.quaternion.y=t.quaternion.z,e.quaternion.z=-t.quaternion.y,e.quaternion.w=t.quaternion.w):(e.quaternion.x=t.quaternion.x,e.quaternion.y=t.quaternion.y,e.quaternion.z=t.quaternion.z,e.quaternion.w=t.quaternion.w)),T(t.scale)&&(0!==t.scale.x&&0!==t.scale.y&&0!==t.scale.z?(e.scale.x=t.scale.x,e.scale.y=t.scale.y,e.scale.z=t.scale.z):this.logger.warn("Try to assign null scale !")),T(t.modelViewMatrix)&&F(t.modelViewMatrix)&&e.modelViewMatrix.fromArray(t.modelViewMatrix),T(t.normalMatrix)&&F(t.normalMatrix)&&e.normalMatrix.fromArray(t.normalMatrix),T(t.matrix)&&F(t.matrix)&&e.matrix.fromArray(t.matrix),T(t.matrixWorld)&&F(t.matrixWorld)&&e.matrixWorld.fromArray(t.matrixWorld),T(t.matrixAutoUpdate)&&(e.matrixAutoUpdate=t.matrixAutoUpdate),T(t.matrixWorldNeedsUpdate)&&(e.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate),T(t.layers)&&(e.layers.mask=t.layers),T(t.visible)&&(e.visible=t.visible),T(t.castShadow)&&(e.castShadow=t.castShadow),T(t.receiveShadow)&&(e.receiveShadow=t.receiveShadow),T(t.frustumCulled)&&(e.frustumCulled=t.frustumCulled),T(t.renderOrder)&&(e.renderOrder=t.renderOrder),T(t.userData)&&(e.userData=t.userData)}fillObjects3D(e,t,s,i){const r=this,n=[];for(let t in e){const s=e[t];(s.geometry||s.material)&&n.push(e[t])}if(0===n.length)return void t(e);let o,a;function h(){if(o&&a){for(let t in e){const s=e[t];r.applyGeometry(s,o),r.applyMaterials(s,a)}t(e)}}this._retrieveGeometriesOf(n,(e=>{o=e,h()}),s,i),this._retrieveMaterialsOf(n,(e=>{a=e,h()}),s,i)}_retrieveGeometriesOf(e,t,s,i){const r=e.map((e=>e.geometry)).filter(((e,t,s)=>e&&s.indexOf(e)===t));0!==r.length?this._geometriesProvider.read(r,null,t,s,i):t({})}_retrieveMaterialsOf(e,t,s,i){const r=e.map((e=>e.material)),n=[].concat.apply([],r).filter(((e,t,s)=>e&&s.indexOf(e)===t));0!==n.length?this._materialsProvider.read(n,null,t,s,i):t({})}applyGeometry(e,t){const s=e.geometry;if(!s)return;const i=t[s];i?e.geometry=i:this.logger.error("Unable to retrieve geometry !!!")}applyMaterials(e,t){const s=e.material;if(s)if(Array.isArray(s))if(1===s.length){const i=t[s[0]];if(!i)return this.logger.error("Unable to retrieve material !!!"),null;e.material=i.clone()}else{e.material=[];for(let i=0,r=s.length;i<r;i++){const r=t[s[i]];if(!r)return this.logger.error("Unable to retrieve material !!!"),null;e.material.push(r.clone())}}else if("string"==typeof s){const i=t[s];if(!i)return void this.logger.error("Unable to retrieve material !!!");e.material=i.clone()}else this.logger.error("Invalid material ids, expected string or array of string")}}
/**
 * @module Objects3D/OrbitControlsHelper
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 */class ms extends ue{constructor(e={}){const t={radius:2,radials:16,circles:2,divisions:64,innerColor:new ot(4473924),outerColor:new ot(8947848),...e};super(ms._createInternalGeometry(t.radius,t.radials,t.circles,t.divisions,t.innerColor,t.outerColor),ms._createInternalMaterial()),this.matrixAutoUpdate=!1,this._intervalId=void 0}static _createInternalGeometry(e,t,s,i,r,n){const o=[],a=[];let h,l,c,d,u,p,m;for(d=0;d<=t;d++)c=d/t*(2*Math.PI),h=Math.sin(c)*e,l=Math.cos(c)*e,o.push(0,0,0),o.push(h,0,l),m=1&d?r:n,a.push(m.r,m.g,m.b),a.push(m.r,m.g,m.b);for(d=0;d<=s;d++){for(m=1&d?r:n,p=e-e/s*d,u=0;u<i;u++)c=u/i*(2*Math.PI),h=Math.sin(c)*p,l=Math.cos(c)*p,o.push(h,0,l),a.push(m.r,m.g,m.b),c=(u+1)/i*(2*Math.PI),h=Math.sin(c)*p,l=Math.cos(c)*p,o.push(h,0,l),a.push(m.r,m.g,m.b);o.push(-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1,0,0,1),a.push(0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1)}const g=new f(o,3);g.name="TOrbitControlsHelperPositionBufferAttribute";const b=new f(a,3);b.name="TOrbitControlsHelperColorBufferAttribute";const w=new _;return w.setAttribute("position",g),w.setAttribute("color",b),w.name="TOrbitControlsHelperGeometry",w}static _createInternalMaterial(){const e=new oe({vertexColors:N});return e.transparent=!0,e.opacity=0,e.name="TOrbitControlsHelperMaterial",e}startOpacityAnimation(){void 0!==this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this.material.opacity=1}endOpacityAnimation(){this._intervalId=setInterval(function(){this.material.opacity<=0?(this.material.opacity=0,clearInterval(this._intervalId),this._intervalId=void 0):this.material.opacity-=.1}.bind(this),100)}}export{Tt as ASCLoader,ts as AbstractGizmo,Wt as AbstractHandle,Ht as AbstractHitbox,Ft as CameraControlMode,Bt as CameraControls,Gt as ClippingBox,os as ClippingControls,ns as ClippingModes,as as CurvesManager,Rt as CylindricaHitbox,Pt as DBFLoader,ls as GeometriesManager,jt as HighlightableLineMaterial,Ut as HighlightableMaterial,Jt as LozengeHandle,Xt as LozengeHitbox,us as MaterialsManager,ps as ObjectsManager,es as OctahedricalHandle,Yt as OctahedricalHitbox,ms as OrbitControlsHelper,Nt as PlanarHitbox,Kt as PlaneHandle,is as RotateGizmo,Qt as RotateHandle,Et as SHPLoader,rs as ScaleGizmo,$t as ScaleHandle,xt as ShapeType,Zt as SphericalHitbox,cs as TexturesManager,Vt as TorusHitbox,ss as TranslateGizmo,qt as TranslateHandle};
