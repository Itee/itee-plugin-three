"use strict";var e=require("itee-database"),t=require("itee-mongodb"),r=require("itee-validators"),n=require("three-full"),o=require("itee-client"),i=require("itee-core"),a=require("itee-utils"),s=require("bson");function c(e){return e&&e.__esModule?e:{default:e}}var u=c(r);
/**
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 * @see [IFC Standard]{@link http://standards.buildingsmart.org/IFC/RELEASE/IFC4_1/FINAL/HTML/}
 *
 */class d extends t.TMongooseController{constructor(e={}){super(e)}async _readOneDocument(e,t){if(r.isNotDefined(e)||r.isNotDefined(t))return null;const n=await this._driver.model(e).findOne(t).exec();return r.isDefined(n)?n._doc:null}async _readManyDocument(e,t,n){if(r.isNotDefined(e)||r.isNotDefined(t))return null;return(await this._driver.model(e).find(t,n).lean().exec()).map(e=>e._doc)}async _updateDocument(e,t,n){if(r.isNotDefined(e))return null;return await this._driver.model(e.type).findByIdAndUpdate(e._id,t,n).exec()}async getAllChildrenIds(e,t=!1){const n={children:[],geometries:[],materials:[]},o=[],i=await this._readManyDocument("Objects3D",{parent:e},{_id:!0,geometry:!0,material:!0,children:!0});for(let e=0,a=i.length;e<a;e++){const a=i[e],s=a._id.toString();r.isDefined(s)&&n.children.push(s);const c=a.geometry;r.isDefined(c)&&n.geometries.push(c.toString());const u=a.material;if(u){const e=r.isArray(u)?u.map(e=>e.toString()):[u.toString()];n.materials.push(...e)}if(a.children){const e=this.getAllChildrenIds(s,t);o.push(e)}}if(o.length>0){const e=await Promise.all(o);for(let t=0,r=e.length;t<r;t++){const r=e[t];n.children.push(...r.children),n.geometries.push(...r.geometries),n.materials.push(...r.materials)}}return n}async _deleteOne(e,r){try{const n="allInOneByParentId";if("oneByOne"===n);else if("allInOneByParentId"===n){const n=await this.getAllChildrenIds(e,!0);n.children.push(e);const o={children:[...new Set(n.children)],geometries:[...new Set(n.geometries)],materials:[...new Set(n.materials)]},[i,a,s]=await Promise.all([this._deleteDocuments("Objects3D",o.children),this._deleteDocuments("Geometries",o.geometries),this._deleteDocuments("Materials",o.materials)]);t.TMongooseController.returnData({deletedObjectsCount:i,deletedGeometriesResult:a,deletedMaterialsResult:s},r)}}catch(e){t.TMongooseController.returnError(e,r)}}async _deleteDocuments(e,t){if(r.isEmptyArray(t))return 0;return(await this._driver.model(e).deleteMany({_id:{$in:t}}).exec()).deletedCount}async _deleteDocument(e){if(r.isNotDefined(e))return null;const t=await this._driver.model(e.type).findByIdAndDelete(e._id).exec();return t&&t._doc?t._doc._id:null}async _removeParentReference(e){const t=e.parent;if(r.isNotDefined(t))return null;const n=await this._readOneDocument("Objects3D",{_id:t}),o=n.children,i=o.indexOf(e._id);o.splice(i,1);return await this._updateDocument(n,{$set:{children:o}})}async _removeChildrenDocuments(e){let t=[];for(let r=e.length-1;r>=0;r--)t.push(this._removeChildDocument(e[r]));return Promise.all(t)}async _removeChildDocument(e){const t=await this._readManyDocument("Objects3D",{parent:e._id}),r=await this._removeChildrenDocuments(t),n=await this._removeOrphanGeometryWithId(e.geometry),o=await this._removeOrphanMaterialsWithIds(e.material||[]);return{object:await this._deleteDocument(e),children:r,geometry:n,materials:o}}async _removeOrphanGeometryWithId(e){if(r.isNotDefined(e))return;if((await this._readManyDocument("Objects3D",{geometry:e})).length>1)return;const t=await this._readOneDocument("Geometries",{_id:e});return await this._deleteDocument(t)}async _removeOrphanMaterialsWithIds(e){if(r.isNotDefined(e))return;if(r.isEmptyArray(e))return;const t=[];for(let r=0,n=e.length;r<n;r++)t.push(this._removeOrphanMaterialWithId(e[r]));return Promise.all(t)}async _removeOrphanMaterialWithId(e){if(r.isNotDefined(e))return;if((await this._readManyDocument("Objects3D",{material:e})).length>1)return;const t=await this._readOneDocument("Materials",{_id:e});return await this._deleteDocument(t)}}
/**
 * @module Converters/ColladaToThree
 * @desc Export JsonToThree converter class about .dae files

 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */class l extends e.TAbstractFileConverter{constructor(){super({dumpType:e.TAbstractFileConverter.DumpType.ArrayBuffer})}_convert(e,t,r,o,i){super._convert(e,t,r,o,i);try{const t=new n.ColladaLoader;r(t.parse(e))}catch(e){i(e)}}}
/**
 * @module Loader/DBFLoader
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 * From:
 * https://www.clicketyclick.dk/databases/xbase/format/db2_dbf.html#DBII_DBF_STRUCT
 * http://web.archive.org/web/20150323061445/http://ulisse.elettra.trieste.it/services/doc/dbase/DBFstruct.htm
 * http://www.dbase.com/Knowledgebase/INT/db7_file_fmt.htm
 *
 *
 */const m=a.toEnum({FoxPro:48,FoxPro_Autoincrement:49,dBASE_II:2,FoxPro_Var:50,dBASE_III_plus:3,dBASE_III_plus_memo:131,dBASE_IV_SQL_table:67,dBASE_IV_SQL_system:99,dBASE_IV_memo:139,dBASE_IV_memo_SQL_table:203,FoxBase:251,dBase_v_7:4,FoxPro_2_x:245,HiPerSix_memo:229}),h=a.toEnum({Binary:"B",Character:"C",Date:"D",Numeric:"N",Logical:"L",Memo:"M",Timestamp:"@",Long:"I",Autoincrement:"+",Float:"F",Double:"O",OLE:"G"});class f{constructor(e={}){const t={manager:n.DefaultLoadingManager,logger:i.DefaultLogger,reader:new o.TBinaryReader,...e};this.manager=t.manager,this.logger=t.logger,this.reader=t.reader}get manager(){return this._manager}set manager(e){this._manager=e}get logger(){return this._logger}set logger(e){this._logger=e}get reader(){return this._reader}set reader(e){this._reader=e}setManager(e){return this.manager=e,this}setLogger(e){return this.logger=e,this}setReader(e){return this.reader=e,this}load(e,t,r,o){const i=this,a=new n.FileLoader(i.manager);a.setResponseType("arraybuffer"),a.load(e,e=>{t(i.parse(e))},r,o)}parse(e){this.reader.setEndianess(o.Endianness.Big).setBuffer(e);const t=this.reader.getInt8();if(!this._isValidVersion(t))return this.logger.error(`DBFLoader: Invalid version number: ${t}`),null;const r=this._parseHeader(t);return{header:r,datas:this._parseDatas(t,r)}}_isValidVersion(e){return m.includes(e)}_parseHeader(e){let t={};switch(e){case m.FoxPro:case m.FoxPro_Autoincrement:case m.FoxPro_Var:case m.dBASE_II:t=this._parseHeaderV2();break;case m.dBASE_III_plus:case m.dBASE_III_plus_memo:t=this._parseHeaderV2_5();break;case m.dBASE_IV_memo:case m.dBASE_IV_memo_SQL_table:case m.dBASE_IV_SQL_system:case m.dBASE_IV_SQL_table:t=this._parseHeaderV3();break;case m.dBase_v_7:case m.FoxPro_2_x:case m.HiPerSix_memo:t=this._parseHeaderV4();break;default:throw new RangeError(`Invalid version parameter: ${e}`)}return this.reader.getUint8()!==f.Terminator&&this.logger.error("DBFLoader: Invalid terminator after field descriptors !!!"),t}_parseHeaderV2(){const e=this.reader.getInt16(),t=this.reader.getInt8()+f.YearOffset,r=this.reader.getInt8(),n=this.reader.getInt8(),o=this.reader.getInt16();let i,a,s,c,u,d=[];for(let t=0;t<e;t++)i=this.reader.getString(11),a=this.reader.getChar(),s=this.reader.getUint8(),c=this.reader.getInt16(),u=this.reader.getInt8(),d.push({name:i,type:a,length:s,memoryAddress:c,decimalCount:u});return{numberOfRecords:e,year:t,month:r,day:n,lengthOfEachRecords:o,fields:d}}_parseHeaderV2_5(){const e=this.reader.getInt8()+f.YearOffset,t=this.reader.getInt8(),r=this.reader.getInt8();this.reader.setEndianess(o.Endianness.Little);const n=this.reader.getInt32(),i=this.reader.getInt16(),a=this.reader.getInt16();this.reader.setEndianess(o.Endianness.Big),this.reader.skipOffsetOf(20);let s,c,u,d,l,m,h,g=[];for(let e=0;e<n;e++)s=this.reader.getString(11),c=this.reader.getChar(),d=this.reader.getInt32(),u=this.reader.getUint8(),l=this.reader.getUint8(),this.reader.skipOffsetOf(2),m=this.reader.getInt8(),this.reader.skipOffsetOf(2),h=this.reader.getInt8(),this.reader.skipOffsetOf(1),g.push({name:s,type:c,length:u,memoryAddress:d,decimalCount:l,workAreaId:m,MDXFlag:h});return{year:e,month:t,day:r,numberOfRecords:n,numberOfByteInHeader:i,numberOfByteInRecord:a,fields:g}}_parseHeaderV3(){const e=this.reader.getInt8()+f.YearOffset,t=this.reader.getInt8(),r=this.reader.getInt8();this.reader.setEndianess(o.Endianness.Little);const n=this.reader.getInt32(),i=this.reader.getInt16(),a=this.reader.getInt16();this.reader.setEndianess(o.Endianness.Big),this.reader.skipOffsetOf(2);const s=this.reader.getInt8(),c=this.reader.getInt8();this.reader.skipOffsetOf(12);const u=this.reader.getInt8(),d=this.reader.getInt8();this.reader.skipOffsetOf(2);let l,m,h,g,p,_,y=[];for(;this.reader.getOffset()<i-1;)l=this.reader.getString(11),m=this.reader.getChar(),this.reader.skipOffsetOf(4),h=this.reader.getUint8(),g=this.reader.getUint8(),this.reader.skipOffsetOf(2),p=this.reader.getInt8(),this.reader.skipOffsetOf(10),_=this.reader.getInt8(),y.push({name:l,type:m,length:h,decimalCount:g,workAreaId:p,MDXFieldFlag:_});return{year:e,month:t,day:r,numberOfRecords:n,numberOfByteInHeader:i,numberOfByteInRecord:a,incompleteTransactionFlag:s,encryptionFlag:c,MDXFlag:u,languageDriverId:d,fields:y}}_parseHeaderV4(){const e=this.reader.getInt8()+f.YearOffset,t=this.reader.getInt8(),r=this.reader.getInt8();this.reader.setEndianess(o.Endianness.Little);const n=this.reader.getInt32(),i=this.reader.getInt16(),a=this.reader.getInt16();this.reader.setEndianess(o.Endianness.Big),this.reader.skipOffsetOf(2);const s=this.reader.getInt8(),c=this.reader.getInt8();this.reader.skipOffsetOf(12);const u=this.reader.getInt8(),d=this.reader.getInt8();this.reader.skipOffsetOf(2);const l=this.reader.getString(32);this.reader.skipOffsetOf(4);let m,h,g,p,_,y,S=[];for(let e=0;e<n;e++)m=this.reader.getString(32),h=this.reader.getChar(),g=this.reader.getUint8(),p=this.reader.getUint8(),this.reader.skipOffsetOf(2),_=this.reader.getInt8(),this.reader.skipOffsetOf(2),y=this.reader.getInt32(),this.reader.skipOffsetOf(4),S.push({name:m,type:h,length:g,decimalCount:p,MDXFieldFlag:_,nextAutoincrementValue:y});return{year:e,month:t,day:r,numberOfRecords:n,numberOfByteInHeader:i,numberOfByteInRecord:a,incompleteTransactionFlag:s,encryptionFlag:c,MDXFlag:u,languageDriverId:d,languageDriverName:l,fields:S}}_parseDatas(e,t){const r=t.numberOfRecords,n=t.fields;let o=[],i=null,a=null;for(let e=0;e<r;e++){i={},i.deleted=this.reader.getUint8()===f.DeletedRecord;for(let e=0,t=n.length;e<t;e++)switch(a=n[e],a.type){case h.Binary:{const e=this.reader.getString(a.length);i[a.name]=parseInt(e)}break;case h.Numeric:{const e=this.reader.getString(a.length);i[a.name]=parseInt(e)}break;case h.Character:case h.Date:i[a.name]=this.reader.getString(a.length);break;case h.Logical:{const e=this.reader.getChar().toLowerCase();i[a.name]="t"===e||"y"===e||"f"!==e&&"n"!==e&&null}break;case h.Memo:i[a.name]=this.reader.getString(a.length);break;case h.Timestamp:break;case h.Long:case h.Autoincrement:i[a.name]=this.reader.getInt32();break;case h.Float:{const e=this.reader.getString(a.length);i[a.name]=parseInt(e)}break;case h.Double:i[a.name]=this.reader.getFloat64();break;case h.OLE:i[a.name]=this.reader.getString(a.length);break;default:throw new RangeError(`Invalid data type parameter: ${a.type}`)}o.push(i)}return o}_parseFieldProperties(){const e=this.reader.getInt16(),t=this.reader.getInt16(),r=this.reader.getInt16(),n=this.reader.getInt16(),o=this.reader.getInt16(),i=this.reader.getInt16(),a=this.reader.getInt16(),s=this.reader.getInt16();let c=[];for(let t=0;t<e;t++)c.push(this._getStandardProperties());let u=[];for(let e=0;e<r;e++)u.push(this._getCustomProperties());let d=[];for(let e=0;e<o;e++)d.push(this._getReferentialIntegrityProperties());return{numberOfStandardProperties:e,startOfStandardPropertiesDescriptor:t,numberOfCustomProperties:r,startOfCustomPropertiesDescriptor:n,numberOfReferentialIntegrityProperties:o,startOfReferentialIntegrityDescriptor:i,startOfData:a,sizeOfPropertiesStructure:s,standardProperties:c,customProperties:u,referentialIntegrityProperties:d}}_getStandardProperties(){const e=this.reader.getInt16(),t=this.reader.getInt16(),r=this.reader.getInt8(),n=this.reader.getInt8(),o=this.reader.getInt8();this.reader.skipOffsetOf(4);return{generationalNumber:e,tableFieldOffset:t,propertyDescribed:r,type:n,isConstraint:o,offsetFromStart:this.reader.getInt16(),widthOfDatabaseField:this.reader.getInt16()}}_getCustomProperties(){const e=this.reader.getInt16(),t=this.reader.getInt16(),r=this.reader.getInt8();this.reader.skipOffsetOf(1);return{generationalNumber:e,tableFieldOffset:t,type:r,offsetFromStartOfName:this.reader.getInt16(),lengthOfName:this.reader.getInt16(),offsetFromStartOfData:this.reader.getInt16(),lengthOfData:this.reader.getInt16()}}_getReferentialIntegrityProperties(){return{databaseState:this.reader.getInt8(),sequentialNumberRule:this.reader.getInt16(),offsetOfTheRIRuleName:this.reader.getInt16(),sizeOfTheRIRuleName:this.reader.getInt16(),offsetOfNameOfForeignTable:this.reader.getInt16(),sizeOfNameOfForeignTable:this.reader.getInt16(),stateBehaviour:this.reader.getInt8(),numberOfFieldsInLinkingKey:this.reader.getInt16(),offsetOfLocalTableTagName:this.reader.getInt16(),sizeOfTheLocalTableTagName:this.reader.getInt16(),offsetOfForeignTableTagName:this.reader.getInt16(),sizeOfTheForeignTableTagName:this.reader.getInt16()}}}f.Terminator=13,f.DeletedRecord=26,f.YearOffset=1900;
/**
 * @module Converters/DbfToThree
 * @desc Export JsonToThree converter class about .dbf files

 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link module:Loader/DBFLoader Loader/DBFLoader}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */
class g extends e.TAbstractFileConverter{constructor(){super({dumpType:e.TAbstractFileConverter.DumpType.ArrayBuffer})}_convert(e,t,r,n,o){super._convert(e,t,r,n,o);try{const t=new f;r(t.parse(e))}catch(e){o(e)}}}
/**
 * @module Converters/FbxToThree
 * @desc Export JsonToThree converter class about .fbx files

 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */class p extends e.TAbstractFileConverter{constructor(){super({dumpType:e.TAbstractFileConverter.DumpType.ArrayBuffer})}_convert(e,t,r,o,i){super._convert(e,t,r,o,i);try{const t=new n.FBXLoader;r(t.parse(e))}catch(e){i(e)}}}
/**
 * @module Converters/JsonToThree
 * @desc Export JsonToThree converter class about .json files

 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */class _ extends e.TAbstractFileConverter{constructor(){super({dumpType:e.TAbstractFileConverter.DumpType.JSON})}_convert(e,t,r,o,i){super._convert(e,t,r,o,i);try{const t=new n.ObjectLoader;r(t.parse(e))}catch(e){i(e)}}}
/**
 * @module Converters/MtlToThree
 * @desc Export JsonToThree converter class about .mtl files

 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */class y extends e.TAbstractFileConverter{constructor(){super({dumpType:e.TAbstractFileConverter.DumpType.String})}_convert(e,t,r,o,i){super._convert(e,t,r,o,i);try{const t=new n.MTLLoader;r(t.parse(e))}catch(e){i(e)}}}
/**
 * @module Converters/Obj2ToThree
 * @desc Export JsonToThree converter class about .obj files

 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */class S extends e.TAbstractFileConverter{constructor(){super({dumpType:e.TAbstractFileConverter.DumpType.JSON})}_convert(e,t,r,o,i){super._convert(e,t,r,o,i);try{const t=new n.OBJLoader2;r(t.parse(e))}catch(e){i(e)}}}
/**
 * @module Loader/SHPLoader
 * @desc Export SHPLoader to load .shp files
 *
 * @requires {@link https://github.com/Itee/itee-client itee-client}
 * @requires {@link https://github.com/Itee/itee-utils itee-utils}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 * @example Todo...
 *
 */const F=a.toEnum({NullShape:0,Point:1,Polyline:3,Polygon:5,MultiPoint:8,PointZ:11,PolyLineZ:13,PolygonZ:15,MultiPointZ:18,PointM:21,PolylineM:23,PolygonM:25,MultiPointM:28,MultiPatch:31});class M{constructor(e={}){const t={manager:n.DefaultLoadingManager,logger:i.DefaultLogger,reader:new o.TBinaryReader,globalOffset:new n.Vector3(0,0,0),worldAxis:{from:"zUp",to:"zForward"},...e};this.manager=t.manager,this.logger=t.logger,this.reader=t.reader,this.globalOffset=t.globalOffset,this.worldAxis=t.worldAxis}get globalOffset(){return this._globalOffset}set globalOffset(e){this._globalOffset=e}get worldAxis(){return this._worldAxis}set worldAxis(e){this._worldAxis=e}get manager(){return this._manager}set manager(e){this._manager=e}get logger(){return this._logger}set logger(e){this._logger=e}get reader(){return this._reader}set reader(e){this._reader=e}setGlobalOffset(e){return this.globalOffset=e,this}setWorldAxis(e){return this.worldAxis=e,this}setManager(e){return this.manager=e,this}setLogger(e){return this.logger=e,this}setReader(e){return this.reader=e,this}load(e,t,r,o){const i=this,a=new n.FileLoader(i.manager);a.setResponseType("arraybuffer"),a.load(e,e=>{t(i.parse(e))},r,o)}parse(e){this._reader.setEndianess(o.Endianness.Big).setBuffer(e);const t=this._parseHeader();if(t.fileCode!==M.FileCode)return this.logger.error("SHPLoader: Invalide Shape file code !"),null;if(t.fileLength<M.MinFileLength)return this.logger.error("SHPLoader: Shape file have an incorrect length !"),null;if(!Object.values(F).includes(t.shapeType))return this.logger.error("SHPLoader: Shape file have an incorrect shape type !"),null;t.version<M.MinVersion&&this.logger.warn("SHPLoader: Version of shape file below than 1000 could be incorrectly parsed !");const r=this._parseDatas(t);return this._convertToObjects(r)}_parseHeader(){const e=this._reader.getInt32();this._reader.skipOffsetOf(20);const t=this._reader.getInt32();this._reader.setEndianess(o.Endianness.Little);const r=this._reader.getInt32(),n=this._reader.getInt32(),i=this._reader.getInt32(),a=this._reader.getInt32();return{fileCode:e,fileLength:t,version:r,shapeType:n,boundingBox:{xMin:i,xMax:this._reader.getInt32(),yMin:a,yMax:this._reader.getInt32(),zMin:this._reader.getInt32(),zMax:this._reader.getInt32(),mMin:this._reader.getInt32(),mMax:this._reader.getInt32()}}}_parseDatas(e){this._reader.skipOffsetTo(100);let t,r,n,i=[];for(;!this._reader.isEndOfFile();)switch(t=this._parseRecordHeader(),r=this._reader.getOffset()+2*t.contentLength,this._reader.setEndianess(o.Endianness.Little),e.shapeType){case F.NullShape:this._reader.skipOffsetTo(r);break;case F.Point:case F.PointZ:case F.PointM:for(;this._reader.getOffset()<r;)n=this._parsePoint(),n&&i.push(n);break;case F.Polyline:case F.PolyLineZ:case F.PolylineM:for(;this._reader.getOffset()<r;)n=this._parsePolyLine(),n&&i.push(n);break;case F.Polygon:case F.PolygonZ:case F.PolygonM:for(;this._reader.getOffset()<r;)n=this._parsePolyLine(),n&&i.push(n);break;case F.MultiPoint:case F.MultiPointZ:case F.MultiPointM:for(;this._reader.getOffset()<r;)n=this._parseMultiPoint(),n&&i.push(n);break;case F.MultiPatch:for(;this._reader.getOffset()<r;)n=this._parseMultiPatch(),n&&i.push(n);break;default:this.logger.error(`SHPLoader: Invalid switch parameter: ${e.shapeType}`)}return i}_parseRecordHeader(){this._reader.setEndianess(o.Endianness.Big);return{recordNumber:this._reader.getInt32(),contentLength:this._reader.getInt32()}}_parseNull(){return this._reader.getInt32(),null}_parsePoint(){const e=this._reader.getInt32();if(e===F.NullShape)return null;return{shapeType:e,x:this._reader.getFloat64(),y:this._reader.getFloat64()}}_parsePolyLine(){const e=this._reader.getInt32();if(e===F.NullShape)return null;const t={xMin:this._reader.getFloat64(),yMin:this._reader.getFloat64(),xMax:this._reader.getFloat64(),yMax:this._reader.getFloat64()},r=this._reader.getInt32(),n=this._reader.getInt32(),o=new Array(r);for(let e=0;e<r;e++)o[e]=this._reader.getInt32();const i=new Array(n);for(let e=0;e<n;e++)i[e]={x:this._reader.getFloat64(),y:this._reader.getFloat64()};return{shapeType:e,boundingBox:t,numberOfParts:r,numberOfPoints:n,parts:o,points:i}}_parsePolygon(){const e=this._reader.getInt32();if(e===F.NullShape)return null;const t={xMin:this._reader.getFloat64(),yMin:this._reader.getFloat64(),xMax:this._reader.getFloat64(),yMax:this._reader.getFloat64()},r=this._reader.getInt32(),n=this._reader.getInt32();let o=new Array(r);for(let e=0;e<r;e++)o[e]=this._reader.getInt32();let i=new Array(n);for(let e=0;e<n;e++)i[e]={x:this._reader.getFloat64(),y:this._reader.getFloat64()};const s=[],c=[];return o.forEach((e,t)=>{const r=i.slice(e,o[t+1]);a.ringClockwise(r)?s.push(r):c.push(r)}),c.forEach(e=>{s.some(t=>{if(a.ringContainsSome(t[0],e))return t.push(e),!0})||s.push([e])}),{shapeType:e,boundingBox:t,numberOfParts:r,numberOfPoints:n,parts:o,polygons:s}}_parseMultiPoint(){const e=this._reader.getInt32();if(e===F.NullShape)return null;const t={xMin:this._reader.getFloat64(),xMax:this._reader.getFloat64(),yMin:this._reader.getFloat64(),yMax:this._reader.getFloat64()},r=this._reader.getInt32(),n=new Array(r);for(let e=0;e<r;e++)n.push([this._reader.getFloat64(),this._reader.getFloat64()]);return{shapeType:e,boundingBox:t,numberOfPoints:r,points:n}}_parseMultiPatch(){const e=this._reader.getInt32();return e===F.NullShape?null:{shapeType:e}}_convertToObjects(e){let t=[];for(let t=0,n=e.length;t<n;t++){let n=e[t];n.shapeType!==F.Polygon&&n.shapeType!==F.PolygonZ&&n.shapeType!==F.PolygonM||(n.points&&Array.isArray(n.points[0])?r(n.points):o(n.points))}function r(e){for(let t=0,n=e.length;t<n;t++){let n=e[t];n?Array.isArray(n[0])?r(n):o(n):this.logger.log("no array, oups !")}}function o(e){t.push(new n.Shape(e))}return t}}M.FileCode=9994,M.MinFileLength=100,M.MinVersion=1e3;
/**
 * @module Converters/ShpToThree
 * @desc Export JsonToThree converter class about .shp files

 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link module:Loader/SHPLoader Loader/SHPLoader}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */
class b extends e.TAbstractFileConverter{constructor(){super({dumpType:e.TAbstractFileConverter.DumpType.ArrayBuffer})}_convert(e,t,r,n,o){super._convert(e,t,r,n,o);try{const t=new M;r(t.parse(e))}catch(e){o(e)}}}
/**
 * @module Converters/StlToThree
 * @desc Export JsonToThree converter class about .stl files

 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */class T extends e.TAbstractFileConverter{constructor(){super({dumpType:e.TAbstractFileConverter.DumpType.JSON})}_convert(e,t,r,o,i){super._convert(e,t,r,o,i);try{const t=new n.STLLoader;r(t.parse(e))}catch(e){i(e)}}}
/**
 * @module Converters/TdsToThree
 * @desc Export JsonToThree converter class about .3ds files

 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */class w extends e.TAbstractFileConverter{constructor(){super({dumpType:e.TAbstractFileConverter.DumpType.ArrayBuffer})}_convert(e,t,r,o,i){super._convert(e,t,r,o,i);try{const t=new n.TDSLoader;r(t.parse(e))}catch(e){i(e)}}}
/**
 * @module Inserters/ThreeToMongoDB
 * @desc Export ThreeToMongoDB mongodb inserter class.
 *
 * @requires {@link https://github.com/Itee/itee-client itee-client}
 * @requires {@link https://github.com/Itee/itee-database itee-database}
 * @requires {@link https://github.com/Itee/itee-validators itee-validators}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */class B extends e.TAbstractDataInserter{constructor(e={}){const t={logger:i.DefaultLogger,...e};super(t),this.logger=t.logger,this.mergeStrategy="add",this._cache={}}static _toLog(e){return JSON.stringify({type:e.type||"undefined",name:e.name||"undefined",uuid:e.uuid||"undefined",id:e._id||"undefined"})}async _save(e,t,n,o,i){const s=a.toArray(e);if(r.isEmptyArray(s))return void i("No data to save in database. Abort insert !");const c=s.map(e=>e.name);this.logger.log(`ThreeToMongoDB: Saving ${c}`),t.mergeStrategy&&(this.mergeStrategy=t.mergeStrategy);try{const e=t.parentId;let o=null,a=null;if(r.isDefined(e)){const n=await this._readDocument("Objects3D",{_id:e});if(r.isNull(n))return void i(`Unable to retrieve parent with id (${t.parentId}). Abort insert !`);if("add"===this.mergeStrategy)o=await this._parseObjects(s,e),a=r.isDefined(o)?o.filter(e=>e).map(e=>e._id):[],await this._updateDocument(n,{$addToSet:{children:a}});else if("replace"===this.mergeStrategy){const t=await this._readDocuments("Objects3D",{parent:e}),i=s.map(e=>e.uuid),c=t.filter(e=>!i.includes(e.uuid));await this._removeChildrenDocuments(c),o=await this._parseObjects(s,e),a=r.isDefined(o)?o.filter(e=>e).map(e=>e._id):[],await this._updateDocument(n,{$set:{children:a}})}}else o=await this._parseObjects(s,null),a=r.isDefined(o)?o.filter(e=>e).map(e=>e._id):[];this.logger.log(`ThreeToMongoDB: Saved ${a}`),n()}catch(e){i(e)}finally{this._cache={}}}async _parseObjects(e=[],t=null){this.logger.debug("_parseObjects(...)");const n=a.toArray(e);if(r.isEmptyArray(n))return null;const o=[];for(let e=0,r=n.length;e<r;e++)o.push(this._parseObject(n[e],t));return Promise.all(o)}async _parseObject(e,t=null){if(this.logger.debug(`_parseObject(${B._toLog(e)}, ${t})`),r.isNotDefined(e))return null;const n=e.type,o=e.name,i=e.geometry,s=a.toArray(e.children),c=a.toArray(e.material);if(r.isDefined(i)&&r.isEmptyArray(s))if(i.isGeometry){const e=i.vertices;if(r.isNotDefined(e)||r.isEmptyArray(e))return this.logger.error(`Leaf object ${o} have a geometry that doesn't contain vertices ! Skip it.`),null}else{if(!i.isBufferGeometry)return this.logger.error(`Object ${o} contain an unknown/unmanaged geometry of type ${i.type} ! Skip it.`),null;{const e=i.attributes;if(r.isNotDefined(e))return this.logger.error(`Buffer geometry of ${o} doesn't contain attributes ! Skip it.`),null;const t=e.position;if(r.isNotDefined(t)||0===t.count)return this.logger.error(`Leaf object ${o} have a buffer geometry that doesn't contain position attribute ! Skip it.`),null}}let u=null;if(B.AvailableLineTypes.includes(n)){if(r.isNotDefined(i))return this.logger.error(`Missing geometry for object ${e.name} of type ${n}. Only Sprite can contains material without geometry ! Skip it.`),null;u=B.AvailableLineMaterialTypes}else if(B.AvailablePointTypes.includes(n)){if(r.isNotDefined(i))return this.logger.error(`Missing geometry for object ${e.name} of type ${n}. Only Sprite can contains material without geometry ! Skip it.`),null;u=B.AvailablePointMaterialTypes}else B.AvailableSpriteTypes.includes(n)&&(u=B.AvailableSpriteMaterialTypes);if(u)for(let e=0,t=c.length;e<t;e++){const t=c[e].type;if(!u.includes(t))return this.logger.error(`Object ${o} of type ${n}, contain an invalid material of type ${t} ! Skip it.`),null}const d=await this._getOrCreateDocuments(i),l=r.isDefined(d)?d.filter(e=>e).map(e=>e._id).pop():null,m=await this._getOrCreateDocuments(c),h=r.isDefined(m)?m.filter(e=>e).map(e=>e._id):[];let f=await this._readDocument(n,{uuid:e.uuid,parent:t});if(r.isDefined(f))if("add"===this.mergeStrategy){const e=await this._parseObjects(s,f._id),t=r.isDefined(e)?e.filter(e=>e).map(e=>e._id):[];await this._updateDocument(f,{$addToSet:{children:t}})}else if("replace"===this.mergeStrategy){const e=await this._readDocuments("Objects3D",{parent:f._id}),t=s.map(e=>e.uuid),n=e.filter(e=>!t.includes(e.uuid));await this._removeChildrenDocuments(n);const o=await this._parseObjects(s,f._id),i=r.isDefined(o)?o.filter(e=>e).map(e=>e._id):[];await this._updateDocument(f,{$set:{children:i,geometry:l,material:h}})}else this.logger.error(`Unknown/Unmanaged merge srategy ${this.mergeStrategy}`);else{e.parent=t,e.children=[],e.geometry=l,e.material=h,f=await this._createDocument(e);const n=await this._parseObjects(s,f._id),o=r.isDefined(n)?n.filter(e=>e).map(e=>e._id):[];await this._updateDocument(f,{$set:{children:o,geometry:l,material:h}})}return f}async _getOrCreateDocuments(e=[]){this.logger.debug("_getOrCreateDocuments(...)");const t=a.toArray(e);if(r.isEmptyArray(t))return null;const n=[];for(let e=0,r=t.length;e<r;e++)n.push(this._getOrCreateDocument(t[e]));return Promise.all(n)}async _getOrCreateDocument(e){if(this.logger.debug(`_getOrCreateDocument(${B._toLog(e)})`),r.isNotDefined(e))return null;let t=await this._readDocument(e.type,{uuid:e.uuid});return t=r.isDefined(t)?await this._updateDocument(t,e):await this._createDocument(e),t}async _createDocuments(e=[]){this.logger.debug("_createDocuments(...)");const t=a.toArray(e);if(r.isEmptyArray(t))return null;const n=[];for(let e=0,r=t.length;e<r;e++)n.push(this._createDocument(t[e]));return Promise.all(n)}async _createDocument(e){if(this.logger.debug(`_createDocument(${B._toLog(e)})`),r.isNotDefined(e))return null;const t=await this._driver.model(e.type)(e).save(),n=r.isDefined(t)?t._doc:null;return n&&(this._cache[n.uuid]=n),n}async _readDocuments(e,t){if(this.logger.debug("_readDocuments(...)"),r.isNotDefined(e)||r.isNotDefined(t))return null;return(await this._driver.model(e).find(t).exec()).map(e=>e._doc)}async _readDocument(e,t){if(this.logger.debug(`_readDocument(${e}, ${JSON.stringify(t)})`),r.isNotDefined(e)||r.isNotDefined(t))return null;const n=this._cache[t.uuid];if(n)return n;const o=await this._driver.model(e).findOne(t).exec(),i=r.isDefined(o)?o._doc:null;return i&&(this._cache[i.uuid]=i),i}async _updateDocuments(e=[],t,n){this.logger.debug("_updateDocuments(...)");const o=a.toArray(e);if(r.isEmptyArray(o))return null;const i=[];for(let e=0,r=o.length;e<r;e++)i.push(this._updateDocument(o[e],t,n));return Promise.all(i)}async _updateDocument(e,t,n={new:!0}){if(this.logger.debug(`_updateDocument(${B._toLog(e)}, ${JSON.stringify(t)}, ${JSON.stringify(n)})`),r.isNotDefined(e))return null;const o=await this._driver.model(e.type).findByIdAndUpdate(e._id,t,n).exec(),i=r.isDefined(o)?o._doc:null;return i&&(this._cache[i.uuid]=i),i}async _deleteDocuments(e=[]){this.logger.debug("_deleteDocuments(...)");const t=a.toArray(e);if(r.isEmptyArray(t))return null;const n=[];for(let e=0,r=t.length;e<r;e++)n.push(this._deleteDocument(t[e]));return Promise.all(n)}async _deleteDocument(e){if(this.logger.debug(`_deleteDocument(${B._toLog(e)})`),r.isNotDefined(e))return null;const t=await this._driver.model(e.type).findByIdAndDelete(e._id).exec(),n=r.isDefined(t)?t._doc:null;return n&&delete this._cache[n.uuid],n}async _removeChildrenDocuments(e){this.logger.debug("_removeChildrenDocuments(...)");let t=[];for(let r=e.length-1;r>=0;r--)t.push(this._removeChildDocument(e[r]));return Promise.all(t)}async _removeChildDocument(e){this.logger.debug(`_removeChildDocument(${B._toLog(e)})`);const t=await this._readDocuments("Objects3D",{parent:e._id});await this._removeChildrenDocuments(t),await this._removeOrphanGeometryWithId(e.geometry),await this._removeOrphanMaterialsWithIds(e.material||[]),await this._deleteDocument(e)}async _removeOrphanGeometryWithId(e){if(this.logger.debug(`_removeOrphanGeometryWithId(${e})`),r.isNotDefined(e))return;if((await this._readDocuments("Objects3D",{geometry:e})).length>1)return;const t=await this._readDocument("Geometries",{_id:e});await this._deleteDocument(t)}async _removeOrphanMaterialsWithIds(e){this.logger.debug("_removeOrphanMaterialsWithIds(...)");const t=[];for(let r=0,n=e.length;r<n;r++)t.push(this._removeOrphanMaterialWithId(e[r]));return Promise.all(t)}async _removeOrphanMaterialWithId(e){this.logger.debug(`_removeOrphanMaterialWithId(${e})`);if((await this._readDocuments("Objects3D",{material:e})).length>1)return;const t=await this._readDocument("Materials",{_id:e});await this._deleteDocument(t)}}function v(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if("function"==typeof t){var r=function e(){var r=!1;try{r=this instanceof e}catch{}return r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}B.AvailableCurveTypes=["Curve","ArcCurve","CatmullRomCurve3","CubicBezierCurve","CubicBezierCurve3","EllipseCurve","LineCurve","LineCurve3","QuadraticBezierCurve","QuadraticBezierCurve3","SplineCurve","CurvePath","Path","Shape"],B.AvailableLineTypes=["Line","LineLoop","LineSegments"],B.AvailableLineMaterialTypes=["LineBasicMaterial","LineDashedMaterial"],B.AvailablePointTypes=["Points"],B.AvailablePointMaterialTypes=["PointsMaterial"],B.AvailableSpriteTypes=["Sprite"],B.AvailableSpriteMaterialTypes=["SpriteMaterial"];var C={};
/**
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 *
 * @module Schemas/Object3D
 *
 * @description Todo...
 */function D(){}D.getSchemaFrom=e=>(D._schema||D._createSchema(e),D._schema),D._createSchema=e=>{const t=e.Schema,r=t.Types,n=r.ObjectId,o=r.Mixed,i=r.Vector3,a=r.Quaternion,s=r.Matrix4,c=r.Euler;D._schema=new t({uuid:String,name:String,type:String,parent:n,children:[n],up:i,position:i,rotation:c,quaternion:a,scale:{type:i,default:{x:1,y:1,z:1}},modelViewMatrix:s,normalMatrix:s,matrix:s,matrixWorld:s,matrixAutoUpdate:Boolean,matrixWorldNeedsUpdate:Boolean,layers:{type:Number,set:e=>e.mask},visible:Boolean,castShadow:Boolean,receiveShadow:Boolean,frustumCulled:Boolean,renderOrder:Boolean,userData:{type:o,set:e=>function e(t){let r={};for(let n in t){if(!Object.prototype.hasOwnProperty.call(t,n))continue;let o=t[n];o.constructor===Object&&(o=e(o)),r[n.replace(/\./g,"")]=o}return r}(e)}},{collection:"objects",discriminatorKey:"type"})},D.getModelFrom=e=>(D._model||D._createModel(e),D._model),D._createModel=e=>{D._model=e.model("Objects3D",D.getSchemaFrom(e)),D._model.discriminator("Object3D",new e.Schema({}))},D.registerModelTo=e=>(D._model||D._createModel(e),e),D._schema=null,D._model=null;var O,N=v(Object.freeze({__proto__:null,Object3D:D}));var I,x=function(){if(O)return C;O=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Audio",n(t))}return C.Audio={name:"Audio",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},C}(),P={};var G,A=function(){if(I)return P;I=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("AudioListener",n(t))}return P.AudioListener={name:"AudioListener",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},P}(),L={};var U,R=function(){if(G)return L;G=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PositionalAudio",n(t))}return L.PositionalAudio={name:"PositionalAudio",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},L}(),E={};var H,j=function(){if(U)return E;U=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ArrayCamera",n(t))}return E.ArrayCamera={name:"ArrayCamera",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},E}(),V={};var k,$=function(){if(H)return V;H=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Camera",n(t))}return V.Camera={name:"Camera",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},V}(),z={};var Y,X=function(){if(k)return z;k=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CubeCamera",n(t))}return z.CubeCamera={name:"CubeCamera",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},z}(),Z={};var W,K=function(){if(Y)return Z;Y=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("OrthographicCamera",n(t))}return Z.OrthographicCamera={name:"OrthographicCamera",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Z}(),Q={};var J,q=function(){if(W)return Q;W=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PerspectiveCamera",n(t))}return Q.PerspectiveCamera={name:"PerspectiveCamera",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Q}(),ee={};var te=function(){if(J)return ee;J=1;const{isInt8Array:e,isInt16Array:t,isInt32Array:r,isFloat32Array:n,isFloat64Array:o,isUint8Array:i,isUint8ClampedArray:a,isUint16Array:s,isUint32Array:c,isBigInt64Array:d,isBigUint64Array:l}=u.default;let m;return ee.BufferAttribute={name:"BufferAttribute",getSchemaFrom:function(u){return m||function(u){const h=u.Schema,f=h.Types.Mixed,g=1,p=2,_=4,y=8,S={Int8Array:0,Uint8Array:1,Uint8ClampedArray:2,Int16Array:3,Uint16Array:4,Int32Array:5,Uint32Array:6,Float32Array:7,Float64Array:8,BigInt64Array:9,BigUint64Array:10};m=new h({array:{type:Buffer,set:u=>{const m=u.length;let h=null,f=0;if(e(u)){h=Buffer.allocUnsafe(g+m*g),f=h.writeUInt8(S.Int8Array,f);for(let e=0;e<m;e++)f=h.writeInt8(u[e],f)}else if(i(u)){h=Buffer.allocUnsafe(g+m*g),f=h.writeUInt8(S.Uint8Array,f);for(let e=0;e<m;e++)f=h.writeUInt8(u[e],f)}else if(a(u)){h=Buffer.allocUnsafe(g+m*g),f=h.writeUInt8(S.Uint8ClampedArray,f);for(let e=0;e<m;e++)f=h.writeUInt8(u[e],f)}else if(t(u)){h=Buffer.allocUnsafe(g+m*p),f=h.writeUInt8(S.Int16Array,f);for(let e=0;e<m;e++)f=h.writeInt16BE(u[e],f)}else if(s(u)){h=Buffer.allocUnsafe(g+m*p),f=h.writeUInt8(S.Uint16Array,f);for(let e=0;e<m;e++)f=h.writeUInt16BE(u[e],f)}else if(r(u)){h=Buffer.allocUnsafe(g+m*_),f=h.writeUInt8(S.Int32Array,f);for(let e=0;e<m;e++)f=h.writeInt32BE(u[e],f)}else if(c(u)){h=Buffer.allocUnsafe(g+m*_),f=h.writeUInt8(S.Uint32Array,f);for(let e=0;e<m;e++)f=h.writeUInt32BE(u[e],f)}else if(n(u)){h=Buffer.allocUnsafe(g+m*_),f=h.writeUInt8(S.Float32Array,f);for(let e=0;e<m;e++)f=h.writeFloatBE(u[e],f)}else if(o(u)){h=Buffer.allocUnsafe(g+m*y),f=h.writeUInt8(S.Float64Array,f);for(let e=0;e<m;e++)f=h.writeDoubleBE(u[e],f)}else if(d(u)){h=Buffer.allocUnsafe(g+m*y),f=h.writeUInt8(S.BigInt64Array,f);for(let e=0;e<m;e++)f=h.writeDoubleBE(u[e],f)}else{if(!l(u))throw new Error("Unable to determine the array type to bufferize.");h=Buffer.allocUnsafe(g+m*y),f=h.writeUInt8(S.BigUint64Array,f);for(let e=0;e<m;e++)f=h.writeDoubleBE(u[e],f)}return h}},count:Number,dynamic:Boolean,itemSize:Number,name:String,needsUpdate:Boolean,normalized:Boolean,updateRange:f,uuid:String,version:Number},{_id:!1,id:!1})}(u),m},getModelFrom:()=>null,registerModelTo:e=>e},ee}();
/**
 * @module Schemas/Core/BufferGeometry
 * @desc Export the ThreeJs BufferGeometry Model and Schema for Mongoose.
 *
 * @requires {@link module:Schemas/Core/BufferAttribute Schemas/Core/BufferAttribute}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */let re,ne;function oe(e){return re||function(e){const t=e.Schema,r=t.Types,n=r.Mixed,o=r.Vector3,i=te.BufferAttribute.getSchemaFrom(e);re=new t({uuid:String,name:String,type:String,index:i,attributes:{position:i,normal:i,color:i,uv:i},groups:n,boundingBox:{min:o,max:o},boundingSphere:{center:o,radius:Number},drawRange:n},{collection:"geometries",discriminatorKey:"type"})}(e),re}function ie(e){ne=e.model("BufferGeometries",oe(e)),ne.discriminator("BufferGeometry",new e.Schema({}))}const ae={getSchemaFrom:oe,getModelFrom:function(e){return ne||ie(e),ne},registerModelTo:function(e){return ne||ie(e),e}};var se,ce,ue=Object.freeze({__proto__:null,BufferGeometry:ae}),de={},le={};function me(){if(se)return le;let e,t;function r(t){return e||function(t){const r=t.Schema;e=new r({type:{type:String,default:"Curve"},arcLengthDivisions:Number},{collection:"curves",discriminatorKey:"type"})}(t),e}function n(e){t=e.model("Curves",r(e)),t.discriminator("Curve",new e.Schema({}))}return se=1,le.Curve={name:"Curve",getSchemaFrom:r,getModelFrom:function(e){return t||n(e),t},registerModelTo:function(e){return t||n(e),e}},le}
/**
 * @module Schemas/Core/CurvePath
 * @desc Export the ThreeJs CurvePath Model and Schema for Mongoose.
 *
 * @requires {@link module:Schemas/Curves/Curve Schemas/Curves/Curve}
 * @augments module:Schemas/Curves/Curve
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */var he,fe=function(){if(ce)return de;ce=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=new r({type:{type:String,default:"Curve"},arcLengthDivisions:Number},{id:!1,_id:!1});t=new r({curves:[n],autoClose:{type:Boolean,default:!1}})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CurvePath",n(t))}return de.CurvePath={name:"CurvePath",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},de}(),ge={};var pe=function(){if(he)return ge;let e;return he=1,ge.Face3={name:"Face3",getSchemaFrom:function(t){return e||function(t){const r=t.Schema,n=r.Types,o=n.Color,i=n.Vector3;e=new r({a:Number,b:Number,c:Number,normal:i,vertexNormals:[Number],color:o,vertexColors:[Number],materialIndex:Number},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},ge}();
/**
 * @module Schemas/Core/Geometry
 * @desc Export the ThreeJs Geometry Model and Schema for Mongoose.
 *
 * @requires {@link module:Schemas/Core/Face3 Schemas/Core/Face3}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */let _e,ye;function Se(e){return _e||function(e){const t=pe.Face3.getSchemaFrom(e),r=e.Schema,n=r.Types.Vector3;_e=new r({uuid:String,name:String,type:String,vertices:[n],colors:[Number],faces:[t],faceVertexUvs:[[Number]],morphTargets:[Number],morphNormals:[Number],skinWeights:[Number],skinIndices:[Number],lineDistances:[Number],boundingBox:{min:n,max:n},boundingSphere:{center:n,radius:Number},elementsNeedUpdate:Boolean,verticesNeedUpdate:Boolean,uvsNeedUpdate:Boolean,normalsNeedUpdate:Boolean,colorsNeedUpdate:Boolean,lineDistancesNeedUpdate:Boolean,groupsNeedUpdate:Boolean},{collection:"geometries",discriminatorKey:"type"})}(e),_e}function Fe(e){ye=e.model("Geometries",Se(e)),ye.discriminator("Geometry",new e.Schema({}))}const Me={name:"Geometry",getSchemaFrom:Se,getModelFrom:function(e){return ye||Fe(e),ye},registerModelTo:function(e){return ye||Fe(e),e}};var be,Te=Object.freeze({__proto__:null,Geometry:Me}),we={};var Be,ve=function(){if(be)return we;be=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector2,o=new r({type:{type:String,default:"Curve"},arcLengthDivisions:Number},{id:!1,_id:!1});t=new r({curves:[o],autoClose:{type:Boolean,default:!1},currentPoint:n})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Path",n(t))}return we.Path={name:"Path",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},we}(),Ce={};var De,Oe=function(){if(Be)return Ce;Be=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector2,o=new r({type:{type:String,default:"Curve"},arcLengthDivisions:Number},{id:!1,_id:!1}),i=new r({curves:[o],autoClose:{type:Boolean,default:!1},currentPoint:n},{id:!1,_id:!1});t=new r({curves:[o],autoClose:{type:Boolean,default:!1},currentPoint:n,uuid:String,holes:[i]})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Shape",n(t))}return Ce.Shape={name:"Shape",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ce}(),Ne={};var Ie,xe=function(){if(De)return Ne;De=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({aX:Number,aY:Number,xRadius:Number,yRadius:Number,aStartAngle:Number,aEndAngle:Number,aClockwise:Boolean,aRotation:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ArcCurve",n(t))}return Ne.ArcCurve={name:"ArcCurve",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ne}(),Pe={};var Ge,Ae=function(){if(Ie)return Pe;Ie=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector3;t=new r({points:[n],closed:Boolean,curveType:String,tension:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CatmullRomCurve3",n(t))}return Pe.CatmullRomCurve3={name:"CatmullRomCurve3",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Pe}(),Le={};var Ue,Re=function(){if(Ge)return Le;Ge=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector2;t=new r({v0:n,v1:n,v2:n,v3:n})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CubicBezierCurve",n(t))}return Le.CubicBezierCurve={name:"CubicBezierCurve",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Le}(),Ee={};var He,je=function(){if(Ue)return Ee;Ue=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector3;t=new r({v0:n,v1:n,v2:n,v3:n})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CubicBezierCurve3",n(t))}return Ee.CubicBezierCurve3={name:"CubicBezierCurve3",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ee}(),Ve=me(),ke={};var $e,ze=function(){if(He)return ke;He=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CurveExtras",n(t))}return ke.CurveExtras={name:"CurveExtras",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ke}(),Ye={};var Xe,Ze=function(){if($e)return Ye;$e=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({aX:Number,aY:Number,xRadius:Number,yRadius:Number,aStartAngle:Number,aEndAngle:Number,aClockwise:Boolean,aRotation:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("EllipseCurve",n(t))}return Ye.EllipseCurve={name:"EllipseCurve",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ye}(),We={};var Ke,Qe=function(){if(Xe)return We;Xe=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector2;t=new r({v0:n,v1:n})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LineCurve",n(t))}return We.LineCurve={name:"LineCurve",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},We}(),Je={};var qe,et=function(){if(Ke)return Je;Ke=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector3;t=new r({v0:n,v1:n})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LineCurve3",n(t))}return Je.LineCurve3={name:"LineCurve3",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Je}(),tt={};var rt,nt=function(){if(qe)return tt;qe=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("NURBSCurve",n(t))}return tt.NURBSCurve={name:"NURBSCurve",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},tt}(),ot={};var it,at=function(){if(rt)return ot;rt=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("NURBSSurface",n(t))}return ot.NURBSSurface={name:"NURBSSurface",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ot}(),st={};var ct,ut=function(){if(it)return st;it=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector2;t=new r({v0:n,v1:n,v2:n})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("QuadraticBezierCurve",n(t))}return st.QuadraticBezierCurve={name:"QuadraticBezierCurve",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},st}(),dt={};var lt,mt=function(){if(ct)return dt;ct=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector3;t=new r({v0:n,v1:n,v2:n})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("QuadraticBezierCurve3",n(t))}return dt.QuadraticBezierCurve3={name:"QuadraticBezierCurve3",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},dt}(),ht={};var ft,gt=function(){if(lt)return ht;lt=1;const{Curve:e}=me();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector3;t=new r({points:[n]})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("SplineCurve",n(t))}return ht.SplineCurve={name:"SplineCurve",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ht}(),pt={},_t=v(ue);var yt,St=function(){if(ft)return pt;ft=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("BoxBufferGeometry",n(t))}return pt.BoxBufferGeometry={name:"BoxBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},pt}(),Ft={},Mt=v(Te);var bt,Tt=function(){if(yt)return Ft;yt=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("BoxGeometry",n(t))}return Ft.BoxGeometry={name:"BoxGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ft}(),wt={};var Bt,vt=function(){if(bt)return wt;bt=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CircleBufferGeometry",n(t))}return wt.CircleBufferGeometry={name:"CircleBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},wt}(),Ct={};var Dt,Ot=function(){if(Bt)return Ct;Bt=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CircleGeometry",n(t))}return Ct.CircleGeometry={name:"CircleGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ct}(),Nt={};var It,xt=function(){if(Dt)return Nt;Dt=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ConeBufferGeometry",n(t))}return Nt.ConeBufferGeometry={name:"ConeBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Nt}(),Pt={};var Gt,At=function(){if(It)return Pt;It=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ConeGeometry",n(t))}return Pt.ConeGeometry={name:"ConeGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Pt}(),Lt={};var Ut,Rt=function(){if(Gt)return Lt;Gt=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ConvexGeometry",n(t))}return Lt.ConvexGeometry={name:"ConvexGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Lt}(),Et={};var Ht,jt=function(){if(Ut)return Et;Ut=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CylinderBufferGeometry",n(t))}return Et.CylinderBufferGeometry={name:"CylinderBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Et}(),Vt={};var kt,$t=function(){if(Ht)return Vt;Ht=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CylinderGeometry",n(t))}return Vt.CylinderGeometry={name:"CylinderGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Vt}(),zt={};var Yt,Xt=function(){if(kt)return zt;kt=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("DecalGeometry",n(t))}return zt.DecalGeometry={name:"DecalGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},zt}(),Zt={};var Wt,Kt=function(){if(Yt)return Zt;Yt=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("DodecahedronGeometry",n(t))}return Zt.DodecahedronGeometry={name:"DodecahedronGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Zt}(),Qt={};var Jt,qt=function(){if(Wt)return Qt;Wt=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("EdgesGeometry",n(t))}return Qt.EdgesGeometry={name:"EdgesGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Qt}(),er={};var tr,rr=function(){if(Jt)return er;Jt=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ExtrudeBufferGeometry",n(t))}return er.ExtrudeBufferGeometry={name:"ExtrudeBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},er}(),nr={};var or,ir=function(){if(tr)return nr;tr=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ExtrudeGeometry",n(t))}return nr.ExtrudeGeometry={name:"ExtrudeGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},nr}(),ar={};var sr,cr=function(){if(or)return ar;or=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("IcosahedronBufferGeometry",n(t))}return ar.IcosahedronBufferGeometry={name:"IcosahedronBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ar}(),ur={};var dr,lr=function(){if(sr)return ur;sr=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("IcosahedronGeometry",n(t))}return ur.IcosahedronGeometry={name:"IcosahedronGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ur}(),mr={};var hr,fr=function(){if(dr)return mr;dr=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("InstancedBufferGeometry",n(t))}return mr.InstancedBufferGeometry={name:"InstancedBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},mr}(),gr={};var pr,_r=function(){if(hr)return gr;hr=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LatheBufferGeometry",n(t))}return gr.LatheBufferGeometry={name:"LatheBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},gr}(),yr={};var Sr,Fr=function(){if(pr)return yr;pr=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LatheGeometry",n(t))}return yr.LatheGeometry={name:"LatheGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},yr}(),Mr={};var br,Tr=function(){if(Sr)return Mr;Sr=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("OctahedronBufferGeometry",n(t))}return Mr.OctahedronBufferGeometry={name:"OctahedronBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Mr}(),wr={};var Br,vr=function(){if(br)return wr;br=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("OctahedronGeometry",n(t))}return wr.OctahedronGeometry={name:"OctahedronGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},wr}(),Cr={};var Dr,Or=function(){if(Br)return Cr;Br=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ParametricBufferGeometry",n(t))}return Cr.ParametricBufferGeometry={name:"ParametricBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Cr}(),Nr={};var Ir,xr=function(){if(Dr)return Nr;Dr=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ParametricGeometry",n(t))}return Nr.ParametricGeometry={name:"ParametricGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Nr}(),Pr={};var Gr,Ar=function(){if(Ir)return Pr;Ir=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PlaneBufferGeometry",n(t))}return Pr.PlaneBufferGeometry={name:"PlaneBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Pr}(),Lr={};var Ur,Rr=function(){if(Gr)return Lr;Gr=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PlaneGeometry",n(t))}return Lr.PlaneGeometry={name:"PlaneGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Lr}(),Er={};var Hr,jr=function(){if(Ur)return Er;Ur=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PolyhedronBufferGeometry",n(t))}return Er.PolyhedronBufferGeometry={name:"PolyhedronBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Er}(),Vr={};var kr,$r=function(){if(Hr)return Vr;Hr=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PolyhedronGeometry",n(t))}return Vr.PolyhedronGeometry={name:"PolyhedronGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Vr}(),zr={};var Yr,Xr=function(){if(kr)return zr;kr=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("RingBufferGeometry",n(t))}return zr.RingBufferGeometry={name:"RingBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},zr}(),Zr={};var Wr,Kr=function(){if(Yr)return Zr;Yr=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("RingGeometry",n(t))}return Zr.RingGeometry={name:"RingGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Zr}(),Qr={};var Jr,qr=function(){if(Wr)return Qr;Wr=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Vector2,o=new r({type:{type:String,default:"Curve"},arcLengthDivisions:Number},{id:!1,_id:!1}),i=new r({curves:[o],autoClose:{type:Boolean,default:!1},currentPoint:n},{id:!1,_id:!1}),a=new r({curves:[o],autoClose:{type:Boolean,default:!1},currentPoint:n,uuid:String,holes:[i]},{id:!1,_id:!1});t=new r({shapes:[a],curveSegments:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ShapeBufferGeometry",n(t))}return Qr.ShapeBufferGeometry={name:"ShapeBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Qr}(),en={};var tn,rn=function(){if(Jr)return en;Jr=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ShapeGeometry",n(t))}return en.ShapeGeometry={name:"ShapeGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},en}(),nn={};var on,an=function(){if(tn)return nn;tn=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("SphereBufferGeometry",n(t))}return nn.SphereBufferGeometry={name:"SphereBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},nn}(),sn={};var cn,un=function(){if(on)return sn;on=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("SphereGeometry",n(t))}return sn.SphereGeometry={name:"SphereGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},sn}(),dn={};var ln,mn=function(){if(cn)return dn;cn=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TeapotBufferGeometry",n(t))}return dn.TeapotBufferGeometry={name:"TeapotBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},dn}(),hn={};var fn,gn=function(){if(ln)return hn;ln=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TetrahedronBufferGeometry",n(t))}return hn.TetrahedronBufferGeometry={name:"TetrahedronBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},hn}(),pn={};var _n,yn=function(){if(fn)return pn;fn=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TetrahedronGeometry",n(t))}return pn.TetrahedronGeometry={name:"TetrahedronGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},pn}(),Sn={};var Fn,Mn=function(){if(_n)return Sn;_n=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TextBufferGeometry",n(t))}return Sn.TextBufferGeometry={name:"TextBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Sn}(),bn={};var Tn,wn=function(){if(Fn)return bn;Fn=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TextGeometry",n(t))}return bn.TextGeometry={name:"TextGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},bn}(),Bn={};var vn,Cn=function(){if(Tn)return Bn;Tn=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TorusBufferGeometry",n(t))}return Bn.TorusBufferGeometry={name:"TorusBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Bn}(),Dn={};var On,Nn=function(){if(vn)return Dn;vn=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TorusGeometry",n(t))}return Dn.TorusGeometry={name:"TorusGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Dn}(),In={};var xn,Pn=function(){if(On)return In;On=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TorusKnotBufferGeometry",n(t))}return In.TorusKnotBufferGeometry={name:"TorusKnotBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},In}(),Gn={};var An,Ln=function(){if(xn)return Gn;xn=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TorusKnotGeometry",n(t))}return Gn.TorusKnotGeometry={name:"TorusKnotGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Gn}(),Un={};var Rn,En=function(){if(An)return Un;An=1;const{BufferGeometry:e}=_t;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TubeBufferGeometry",n(t))}return Un.TubeBufferGeometry={name:"TubeBufferGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Un}(),Hn={};var jn,Vn=function(){if(Rn)return Hn;Rn=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("TubeGeometry",n(t))}return Hn.TubeGeometry={name:"TubeGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Hn}(),kn={};var $n,zn=function(){if(jn)return kn;jn=1;const{Geometry:e}=Mt;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("WireframeGeometry",n(t))}return kn.WireframeGeometry={name:"WireframeGeometry",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},kn}(),Yn={};var Xn,Zn=function(){if($n)return Yn;$n=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ArrowHelper",n(t))}return Yn.ArrowHelper={name:"ArrowHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Yn}(),Wn={};var Kn,Qn=function(){if(Xn)return Wn;Xn=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("AxesHelper",n(t))}return Wn.AxesHelper={name:"AxesHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Wn}(),Jn={};var qn,eo=function(){if(Kn)return Jn;Kn=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Box3Helper",n(t))}return Jn.Box3Helper={name:"Box3Helper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Jn}(),to={};var ro,no=function(){if(qn)return to;qn=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("BoxHelper",n(t))}return to.BoxHelper={name:"BoxHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},to}(),oo={};var io,ao=function(){if(ro)return oo;ro=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CameraHelper",n(t))}return oo.CameraHelper={name:"CameraHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},oo}(),so={};var co,uo=function(){if(io)return so;io=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("DirectionalLightHelper",n(t))}return so.DirectionalLightHelper={name:"DirectionalLightHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},so}(),lo={};var mo,ho=function(){if(co)return lo;co=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("FaceNormalsHelper",n(t))}return lo.FaceNormalsHelper={name:"FaceNormalsHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},lo}(),fo={};var go,po=function(){if(mo)return fo;mo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("GridHelper",n(t))}return fo.GridHelper={name:"GridHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},fo}(),_o={};var yo,So=function(){if(go)return _o;go=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("HemisphereLightHelper",n(t))}return _o.HemisphereLightHelper={name:"HemisphereLightHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},_o}(),Fo={};var Mo,bo=function(){if(yo)return Fo;yo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PlaneHelper",n(t))}return Fo.PlaneHelper={name:"PlaneHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Fo}(),To={};var wo,Bo=function(){if(Mo)return To;Mo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PointLightHelper",n(t))}return To.PointLightHelper={name:"PointLightHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},To}(),vo={};var Co,Do=function(){if(wo)return vo;wo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PolarGridHelper",n(t))}return vo.PolarGridHelper={name:"PolarGridHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},vo}(),Oo={};var No,Io=function(){if(Co)return Oo;Co=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("RectAreaLightHelper",n(t))}return Oo.RectAreaLightHelper={name:"RectAreaLightHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Oo}(),xo={};var Po,Go=function(){if(No)return xo;No=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("SkeletonHelper",n(t))}return xo.SkeletonHelper={name:"SkeletonHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},xo}(),Ao={};var Lo,Uo=function(){if(Po)return Ao;Po=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("SpotLightHelper",n(t))}return Ao.SpotLightHelper={name:"SpotLightHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ao}(),Ro={};var Eo,Ho=function(){if(Lo)return Ro;Lo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("VertexNormalsHelper",n(t))}return Ro.VertexNormalsHelper={name:"VertexNormalsHelper",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ro}(),jo={};var Vo,ko=function(){if(Eo)return jo;Eo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("AmbientLight",n(t))}return jo.AmbientLight={name:"AmbientLight",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},jo}(),$o={};var zo,Yo=function(){if(Vo)return $o;Vo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("DirectionalLight",n(t))}return $o.DirectionalLight={name:"DirectionalLight",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},$o}(),Xo={};var Zo,Wo=function(){if(zo)return Xo;zo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("HemisphereLight",n(t))}return Xo.HemisphereLight={name:"HemisphereLight",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Xo}(),Ko={};var Qo,Jo=function(){if(Zo)return Ko;Zo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Light",n(t))}return Ko.Light={name:"Light",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ko}(),qo={};var ei,ti=function(){if(Qo)return qo;Qo=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PointLight",n(t))}return qo.PointLight={name:"PointLight",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},qo}(),ri={};var ni,oi=function(){if(ei)return ri;ei=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("RectAreaLight",n(t))}return ri.RectAreaLight={name:"RectAreaLight",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ri}(),ii={};var ai,si,ci=function(){if(ni)return ii;ni=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("SpotLight",n(t))}return ii.SpotLight={name:"SpotLight",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ii}(),ui={},di={};function li(){if(ai)return di;let e,t;function r(t){return e||function(t){const r=t.Schema,n=r.Types.Mixed;e=new r({uuid:String,name:String,type:String,fog:Boolean,lights:Boolean,blending:Number,side:Number,flatShading:Boolean,vertexColors:Number,opacity:Number,transparent:Boolean,blendSrc:Number,blendDst:Number,blendEquation:Number,blendSrcAlpha:String,blendDstAlpha:String,blendEquationAlpha:String,depthFunc:Number,depthTest:Boolean,depthWrite:Boolean,clippingPlanes:n,clipIntersection:Boolean,clipShadows:Boolean,colorWrite:Boolean,precision:Number,polygonOffset:Boolean,polygonOffsetFactor:Number,polygonOffsetUnits:Number,dithering:Boolean,alphaTest:Number,premultipliedAlpha:Boolean,overdraw:Number,visible:Boolean,userData:n,needsUpdate:Boolean},{collection:"materials",discriminatorKey:"type"})}(t),e}function n(e){t=e.model("Materials",r(e)),t.discriminator("Material",new e.Schema({}))}return ai=1,di.Material={name:"Material",getSchemaFrom:r,getModelFrom:function(e){return t||n(e),t},registerModelTo:function(e){return t||n(e),e}},di}
/**
 * @module Schemas/Materials/LineBasicMaterial
 * @desc Export the ThreeJs LineBasicMaterial Model and Schema for Mongoose.
 *
 * @requires {@link module:Schemas/Materials/Material Schemas/Materials/Material}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */var mi,hi=function(){if(si)return ui;si=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Color;t=new r({color:n,light:Boolean,lineWidth:Number,linecap:String,linejoin:String})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LineBasicMaterial",n(t))}return ui.LineBasicMaterial={name:"LineBasicMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ui}(),fi={};var gi,pi=function(){if(mi)return fi;mi=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Color;t=new r({color:n,light:Boolean,lineWidth:Number,linecap:String,linejoin:String,dashSize:Number,gapSize:Number,scale:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LineDashedMaterial",n(t))}return fi.LineDashedMaterial={name:"LineDashedMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},fi}(),_i=li(),yi={};var Si,Fi=function(){if(gi)return yi;gi=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types,o=n.Mixed,i=n.Color;t=new r({color:i,map:o,lightMap:o,lightMapIntensity:Number,aoMap:o,aoMapIntensity:Number,specularMap:o,alphaMap:o,envMap:o,combine:Number,reflectivity:Number,refractionRatio:Number,wireframe:Boolean,wireframeLinewidth:Number,wireframeLinecap:String,wireframeLinejoin:String,skinning:Boolean,morphTargets:Boolean,light:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("MeshBasicMaterial",n(t))}return yi.MeshBasicMaterial={name:"MeshBasicMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},yi}(),Mi={};var bi,Ti=function(){if(Si)return Mi;Si=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Mixed;t=new r({depthPacking:Number,skinning:Boolean,morphTargets:Boolean,map:n,alphaMap:n,displacementMap:n,displacementScale:Number,displacementBias:Number,wireframe:Boolean,wireframeLinewidth:Number,fog:Boolean,light:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("MeshDepthMaterial",n(t))}return Mi.MeshDepthMaterial={name:"MeshDepthMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Mi}(),wi={};var Bi,vi=function(){if(bi)return wi;bi=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types,o=n.Color,i=n.Mixed;t=new r({color:o,map:i,lightMap:i,lightMapIntensity:Number,aoMap:i,aoMapIntensity:Number,emissive:o,emissiveIntensity:Number,emissiveMap:i,specularMap:i,alphaMap:i,envMap:i,combine:Number,reflectivity:Number,refractionRatio:Number,wireframe:Boolean,wireframeLinewidth:Number,wireframeLinecap:String,wireframeLinejoin:String,skinning:Boolean,morphTargets:Boolean,morphNormals:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("MeshLambertMaterial",n(t))}return wi.MeshLambertMaterial={name:"MeshLambertMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},wi}(),Ci={};var Di,Oi=function(){if(Bi)return Ci;Bi=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types,o=n.Mixed,i=n.Vector2;t=new r({bumpMap:o,bumpScale:Number,normalMap:o,normalScale:i,displacementMap:o,displacementScale:Number,displacementBias:Number,wireframe:Boolean,wireframeLinewidth:Number,fog:Boolean,light:Boolean,skinning:Boolean,morphTargets:Boolean,morphNormals:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("MeshNormalMaterial",n(t))}return Ci.MeshNormalMaterial={name:"MeshNormalMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ci}(),Ni={};var Ii,xi=function(){if(Di)return Ni;Di=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types,o=n.Mixed,i=n.Color,a=n.Vector2;t=new r({color:i,specular:i,shininess:Number,map:o,lightMap:o,lightMapIntensity:Number,aoMap:o,aoMapIntensity:Number,emissive:i,emissiveIntensity:Number,emissiveMap:o,bumpMap:o,bumpScale:Number,normalMap:o,normalScale:a,displacementMap:o,displacementScale:Number,displacementBias:Number,specularMap:o,alphaMap:o,envMap:o,combine:Number,reflectivity:Number,refractionRatio:Number,wireframe:Boolean,wireframeLinewidth:Number,wireframeLinecap:String,wireframeLinejoin:String,skinning:Boolean,morphTargets:Boolean,morphNormals:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("MeshPhongMaterial",n(t))}return Ni.MeshPhongMaterial={name:"MeshPhongMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ni}(),Pi={};var Gi,Ai=function(){if(Ii)return Pi;Ii=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({reflectivity:Number,clearCoat:Number,clearCoatRoughness:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("MeshPhysicalMaterial",n(t))}return Pi.MeshPhysicalMaterial={name:"MeshPhysicalMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Pi}(),Li={};var Ui,Ri=function(){if(Gi)return Li;Gi=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types,o=n.Mixed,i=n.Color,a=n.Vector2;t=new r({color:i,roughness:Number,metalness:Number,map:o,lightMap:o,lightMapIntensity:Number,aoMap:o,aoMapIntensity:Number,emissive:i,emissiveIntensity:Number,emissiveMap:o,bumpMap:o,bumpScale:Number,normalMap:o,normalScale:a,displacementMap:o,displacementScale:Number,displacementBias:Number,roughnessMap:o,metalnessMap:o,alphaMap:o,envMap:o,envMapIntensity:Number,refractionRatio:Number,wireframe:Boolean,wireframeLinewidth:Number,wireframeLinecap:String,wireframeLinejoin:String,skinning:Boolean,morphTargets:Boolean,morphNormals:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("MeshStandardMaterial",n(t))}return Li.MeshStandardMaterial={name:"MeshStandardMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Li}(),Ei={};var Hi,ji=function(){if(Ui)return Ei;Ui=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types,o=n.Mixed,i=n.Color,a=n.Vector2;t=new r({color:i,specular:i,shininess:Number,map:o,lightMap:o,lightMapIntensity:Number,aoMap:o,aoMapIntensity:Number,emissive:i,emissiveIntensity:Number,emissiveMap:o,bumpMap:o,bumpScale:Number,normalMap:o,normalScale:a,displacementMap:o,displacementScale:Number,displacementBias:Number,specularMap:o,alphaMap:o,envMap:o,combine:Number,reflectivity:Number,refractionRatio:Number,wireframe:Boolean,wireframeLinewidth:Number,wireframeLinecap:String,wireframeLinejoin:String,skinning:Boolean,morphTargets:Boolean,morphNormals:Boolean,gradientMap:o})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("MeshToonMaterial",n(t))}return Ei.MeshToonMaterial={name:"MeshToonMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ei}(),Vi={};var ki,$i=function(){if(Hi)return Vi;Hi=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types,o=n.Color,i=n.Mixed;t=new r({color:o,map:i,size:Number,sizeAttenuation:Boolean,lights:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("PointsMaterial",n(t))}return Vi.PointsMaterial={name:"PointsMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Vi}(),zi={};var Yi,Xi=function(){if(ki)return zi;ki=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Mixed;t=new r({defines:n,uniforms:n,vertexShader:String,fragmentShader:String,linewidth:Number,wireframe:Boolean,wireframeLinewidth:Number,fog:Boolean,light:Boolean,clipping:Boolean,skinning:Boolean,morphTargets:Boolean,morphNormals:Boolean,derivatives:Boolean,fragDepth:Boolean,drawBuffers:Boolean,shaderTextureLOD:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("RawShaderMaterial",n(t))}return zi.RawShaderMaterial={name:"RawShaderMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},zi}(),Zi={};var Wi,Ki=function(){if(Yi)return Zi;Yi=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Mixed;t=new r({defines:n,uniforms:n,vertexShader:String,fragmentShader:String,linewidth:Number,wireframe:Boolean,wireframeLinewidth:Number,fog:Boolean,light:Boolean,clipping:Boolean,skinning:Boolean,morphTargets:Boolean,morphNormals:Boolean,derivatives:Boolean,fragDepth:Boolean,drawBuffers:Boolean,shaderTextureLOD:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ShaderMaterial",n(t))}return Zi.ShaderMaterial={name:"ShaderMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Zi}(),Qi={};var Ji,qi=function(){if(Wi)return Qi;Wi=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Color;t=new r({color:n,opacity:Number,lights:Boolean,transparent:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ShadowMaterial",n(t))}return Qi.ShadowMaterial={name:"ShadowMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Qi}(),ea={};var ta,ra=function(){if(Ji)return ea;Ji=1;const{Material:e}=li();let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types,o=n.Color,i=n.Mixed;t=new r({color:o,map:i,rotation:Number,fog:Boolean,lights:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("SpriteMaterial",n(t))}return ea.SpriteMaterial={name:"SpriteMaterial",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ea}(),na={};var oa,ia=function(){if(ta)return na;let e;return ta=1,na.Box2={name:"Box2",getSchemaFrom:function(t){return e||function(t){const r=t.Schema,n=r.Types.Vector2;e=new r({min:n,max:n},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},na}(),aa={};var sa,ca=function(){if(oa)return aa;let e;return oa=1,aa.Box3={name:"Box3",getSchemaFrom:function(t){return e||function(t){const r=t.Schema,n=r.Types.Vector3;e=new r({min:n,max:n},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},aa}(),ua={};var da,la=function(){if(sa)return ua;let e;return sa=1,ua.Line3={name:"Line3",getSchemaFrom:function(t){return e||function(t){const r=t.Schema,n=r.Types.Vector3;e=new r({start:n,end:n},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},ua}(),ma={};var ha,fa=function(){if(da)return ma;let e;return da=1,ma.Plane={name:"Plane",getSchemaFrom:function(t){return e||function(t){const r=t.Schema,n=r.Types.Vector3;e=new r({normal:n,constant:Number},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},ma}(),ga={};var pa,_a=function(){if(ha)return ga;let e;return ha=1,ga.Ray={name:"Ray",getSchemaFrom:function(t){return e||function(t){const r=t.Schema,n=r.Types.Vector3;e=new r({origin:n,direction:n},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},ga}(),ya={};var Sa,Fa=function(){if(pa)return ya;let e;return pa=1,ya.Sphere={name:"Sphere",getSchemaFrom:function(t){return e||function(t){const r=t.Schema,n=r.Types.Vector3;e=new r({center:n,radius:Number},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},ya}(),Ma={};var ba,Ta=function(){if(Sa)return Ma;let e;return Sa=1,Ma.Spherical={name:"Spherical",getSchemaFrom:function(t){return e||function(t){const r=t.Schema;e=new r({radius:Number,phi:Number,theta:Number},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},Ma}(),wa={};var Ba,va=function(){if(ba)return wa;let e;return ba=1,wa.Triangle={name:"Triangle",getSchemaFrom:function(t){return e||function(t){const r=t.Schema,n=r.Types.Vector3;e=new r({a:n,b:n,c:n},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},wa}(),Ca={};var Da=function(){if(Ba)return Ca;Ba=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Bone",n(t))}return Ca.Bone={name:"Bone",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ca}();
/**
 * @module Schemas/Objects/Group
 * @desc Export the ThreeJs Group Model and Schema for Mongoose.
 *
 * @requires {@link module:Schemas/Core/Object3D Schemas/Core/Object3D}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */let Oa,Na;function Ia(e){return Oa||function(e){const t=e.Schema;Oa=new t({})}(e),Oa}function xa(e){const t=D.getModelFrom(e);Na=t.discriminator("Group",Ia(e))}const Pa={name:"Group",getSchemaFrom:Ia,getModelFrom:function(e){return Na||xa(e),Na},registerModelTo:function(e){return Na||xa(e),e}};var Ga,Aa={};
/**
 * @module Schemas/Objects/ImmediateRenderObject
 * @desc Export the ThreeJs ImmediateRenderObject Model and Schema for Mongoose.
 *
 * @requires {@link module:Schemas/Core/Object3D Schemas/Core/Object3D}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */var La,Ua=function(){if(Ga)return Aa;Ga=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("ImmediateRenderObject",n(t))}return Aa.ImmediateRenderObject={name:"ImmediateRenderObject",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Aa}(),Ra={};var Ea,Ha=function(){if(La)return Ra;La=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types,o=n.ObjectId,i=n.Color,a=n.Vector3;t=new r({lensFlares:[{texture:o,size:Number,distance:Number,x:Number,y:Number,z:Number,scale:Number,rotation:Number,opacity:Number,color:i,blending:Number}],positionScreen:a})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LensFlare",n(t))}return Ra.LensFlare={name:"LensFlare",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ra}(),ja={};var Va,ka=function(){if(Ea)return ja;Ea=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.ObjectId;t=new r({geometry:{type:n,ref:"Geometry"},material:[{type:n,ref:"LineBasicMaterial"}],drawMode:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Line",n(t))}return ja.Line={name:"Line",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ja}(),$a={};var za,Ya=function(){if(Va)return $a;Va=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.ObjectId;t=new r({geometry:{type:n,ref:"Geometry"},material:[{type:n,ref:"LineBasicMaterial"}],drawMode:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LineLoop",n(t))}return $a.LineLoop={name:"LineLoop",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},$a}(),Xa={};var Za,Wa=function(){if(za)return Xa;za=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.ObjectId;t=new r({geometry:{type:n,ref:"Geometry"},material:[{type:n,ref:"LineBasicMaterial"}],drawMode:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LineSegments",n(t))}return Xa.LineSegments={name:"LineSegments",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Xa}(),Ka={};var Qa,Ja=function(){if(Za)return Ka;Za=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.Mixed;t=new r({levels:[n]})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("LOD",n(t))}return Ka.LOD={name:"LOD",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ka}(),qa={};var es,ts=function(){if(Qa)return qa;Qa=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.ObjectId;t=new r({geometry:{type:n,ref:"Geometry"},material:[{type:n,ref:"Material"}],drawMode:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Mesh",n(t))}return qa.Mesh={name:"Mesh",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},qa}(),rs={};var ns,os=function(){if(es)return rs;es=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.ObjectId;t=new r({geometry:{type:n,ref:"Geometry"},material:[{type:n,ref:"PointsMaterial"}],drawMode:Number})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Points",n(t))}return rs.Points={name:"Points",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},rs}(),is={};var as,ss=function(){if(ns)return is;ns=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.ObjectId;t=new r({bones:[n],boneMatrices:[Number]})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Skeleton",n(t))}return is.Skeleton={name:"Skeleton",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},is}(),cs={};var us,ds=function(){if(as)return cs;as=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.ObjectId;t=new r({geometry:{type:n,ref:"Geometry"},material:[{type:n,ref:"Material"}],drawMode:Number,bindMode:String,bindMatrix:[Number],bindMatrixInverse:[Number]})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("SkinnedMesh",n(t))}return cs.SkinnedMesh={name:"SkinnedMesh",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},cs}(),ls={};var ms,hs=function(){if(us)return ls;us=1;const{Object3D:e}=N;let t,r;function n(e){return t||function(e){const r=e.Schema,n=r.Types.ObjectId;t=new r({material:[{type:n,ref:"SpriteMaterial"}]})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("Sprite",n(t))}return ls.Sprite={name:"Sprite",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},ls}(),fs={};function gs(){if(ms)return fs;let e;return ms=1,fs.Fog={name:"Fog",getSchemaFrom:function(t){return e||function(t){const r=t.Schema;e=new r({coordinates:{x:Number,y:Number,z:Number},orientation:{x:Number,y:Number,z:Number},thumbnail:Buffer,path:String},{_id:!1,id:!1})}(t),e},getModelFrom:()=>null,registerModelTo:e=>e},fs}var ps,_s=gs(),ys={};var Ss,Fs,Ms=function(){if(ps)return ys;ps=1;const{Object3D:e}=N,{Fog:t}=gs();let r,n;function o(e){return r||function(e){const n=t.getSchemaFrom(e),o=e.Schema,i=o.Types.Color;r=new o({background:i,fog:n,overrideMaterial:String,autoUpdate:Boolean})}(e),r}function i(t){const r=e.getModelFrom(t);n=r.discriminator("Scene",o(t))}return ys.Scene={name:"Scene",getSchemaFrom:o,getModelFrom:function(e){return n||i(e),n},registerModelTo:function(e){return n||i(e),e}},ys}(),bs={},Ts={};function ws(){if(Ss)return Ts;let e,t;function r(t){return e||function(t){const r=t.Schema,n=r.Types,o=n.ObjectId,i=n.Vector2,a=n.Matrix3;e=new r({uuid:String,name:String,image:o,mipmaps:[],mapping:Number,wrapS:Number,wrapT:Number,magFilter:Number,minFilter:Number,anisotropy:Number,format:Number,type:Number,offset:i,repeat:i,center:i,rotation:Number,matrixAutoUpdate:Boolean,matrix:a,generateMipmaps:Boolean,premultiplyAlpha:Boolean,flipY:Boolean,unpackAlignment:Number,encoding:Number,version:Number},{collection:"textures",discriminatorKey:"type"})}(t),e}function n(e){t=e.model("Textures",r(e)),t.discriminator("Texture",new e.Schema({}))}return Ss=1,Ts.Texture={name:"Texture",getSchemaFrom:r,getModelFrom:function(e){return t||n(e),t},registerModelTo:function(e){return t||n(e),e}},Ts}
/**
 * @module Schemas/Textures/CanvasTexture
 * @desc Export the ThreeJs CanvasTexture Model and Schema for Mongoose.
 *
 * @requires {@link module:Schemas/Textures/Texture Schemas/Textures/Texture}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */var Bs,vs=function(){if(Fs)return bs;Fs=1;const{Texture:e}=ws();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({needsUpdate:Boolean})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CanvasTexture",n(t))}return bs.CanvasTexture={name:"CanvasTexture",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},bs}(),Cs={};var Ds,Os=function(){if(Bs)return Cs;Bs=1;const{Texture:e}=ws();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CompressedTexture",n(t))}return Cs.CompressedTexture={name:"CompressedTexture",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Cs}(),Ns={};var Is,xs=function(){if(Ds)return Ns;Ds=1;const{Texture:e}=ws();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("CubeTexture",n(t))}return Ns.CubeTexture={name:"CubeTexture",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ns}(),Ps={};var Gs,As=function(){if(Is)return Ps;Is=1;const{Texture:e}=ws();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("DataTexture",n(t))}return Ps.DataTexture={name:"DataTexture",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ps}(),Ls={};var Us,Rs=function(){if(Gs)return Ls;Gs=1;const{Texture:e}=ws();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("DepthTexture",n(t))}return Ls.DepthTexture={name:"DepthTexture",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Ls}(),Es=ws(),Hs={};var js=function(){if(Us)return Hs;Us=1;const{Texture:e}=ws();let t,r;function n(e){return t||function(e){const r=e.Schema;t=new r({})}(e),t}function o(t){const o=e.getModelFrom(t);r=o.discriminator("VideoTexture",n(t))}return Hs.VideoTexture={name:"VideoTexture",getSchemaFrom:n,getModelFrom:function(e){return r||o(e),r},registerModelTo:function(e){return r||o(e),e}},Hs}();
/**
 * @module Types/Color
 * @desc Export the three js Color type for Mongoose.
 *
 * @requires {@link module: [itee-validators]{@link https://github.com/Itee/itee-validators}}
 * @requires {@link module: [bson]{@link https://github.com/mongodb/js-bson}}
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */function Vs(e){class t extends e.SchemaType{constructor(e,t){super(e,t,"Color")}cast(t){if(r.isNotDefined(t))throw new e.SchemaType.CastError(`Color: ${t} is null or undefined`);if(r.isNotObject(t)&&!t.isColor)throw new e.SchemaType.CastError(`Color: ${t} is not a object or Three.Color instance`);if(!("r"in t))throw new e.SchemaType.CastError(`Color: ${t} does not contain r property`);if(r.isNotNumber(t.r))throw new e.SchemaType.CastError(`Color: ${t} expected to be a number`);if(!("g"in t))throw new e.SchemaType.CastError(`Color: ${t} does not contain g property`);if(r.isNotNumber(t.g))throw new e.SchemaType.CastError(`Color: ${t} expected to be a number`);if(!("b"in t))throw new e.SchemaType.CastError(`Color: ${t} does not contain b property`);if(r.isNotNumber(t.b))throw new e.SchemaType.CastError(`Color: ${t} expected to be a number`);return{r:t.r,g:t.g,b:t.b}}}return t.COLOR_BSON_TYPE=s.BSON_DATA_OBJECT,e.Schema.Types.Color=t,e}
/**
 * @module Types/Euler
 * @desc Export the three js Euler type for Mongoose.
 *
 * @requires {@link module: [itee-validators]{@link https://github.com/Itee/itee-validators}}
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */function ks(e){class t extends e.SchemaType{constructor(e,t){super(e,t,"Euler")}cast(t){if(r.isNotDefined(t))throw new e.SchemaType.CastError(`Euler: ${t} is null or undefined`);if(r.isNotObject(t)&&!t.isEuler)throw new e.SchemaType.CastError(`Euler: ${t} is not a object or Euler instance`);if(!("x"in t))throw new e.SchemaType.CastError(`Euler: ${t} does not contain x property`);if(r.isNotNumber(t.x))throw new e.SchemaType.CastError(`Euler: ${t} expected x to be a number`);if(!("y"in t))throw new e.SchemaType.CastError(`Euler: ${t} does not contain y property`);if(r.isNotNumber(t.y))throw new e.SchemaType.CastError(`Euler: ${t} expected y to be a number`);if(!("z"in t))throw new e.SchemaType.CastError(`Euler: ${t} does not contain z property`);if(r.isNotNumber(t.z))throw new e.SchemaType.CastError(`Euler: ${t} expected z to be a number`);if(!("order"in t))throw new e.SchemaType.CastError(`Euler: ${t} does not contain order property`);if(r.isNotString(t.order))throw new e.SchemaType.CastError(`Euler: ${t} expected order to be a string`);if(!["XYZ","YZX","ZXY","XZY","YXZ","ZYX"].includes(t.order.toUpperCase()))throw new e.SchemaType.CastError(`Euler: ${t} expected order to be a string in ['XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX']`);return{x:t.x,y:t.y,z:t.z,order:t.order.toUpperCase()}}}return t.EULER_BSON_TYPE=s.BSON_DATA_OBJECT,e.Schema.Types.Euler=t,e}
/**
 * @module Types/Matrix3
 * @desc Export the three js Matrix3 type for Mongoose.
 *
 * @requires {@link module: [itee-validators]{@link https://github.com/Itee/itee-validators}}
 * @requires {@link module: [bson]{@link https://github.com/mongodb/js-bson}}
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */function $s(e){class t extends e.SchemaType{constructor(e,t){super(e,t,"Matrix3")}cast(t){if(r.isNotDefined(t))throw new e.SchemaType.CastError(`Matrix3: ${t} is null or undefined`);if(r.isNotArray(t)&&!t.isMatrix3)throw new e.SchemaType.CastError(`Matrix3: ${t} is not an array or Matrix3 instance`);let n;n=t.isMatrix3?t.toArray():t;const o=n.length;if(9!==o)throw new e.SchemaType.CastError(`Matrix3: ${t} does not contain the right number of values. Expect 9 values and found ${o}`);for(let i,a=0;a<o;a++){if(i=n[a],r.isNotNumber(i))throw new e.SchemaType.CastError(`Matrix3: ${t} does not seem to contain right values. Expect values in range 0 and 1.`);if(r.isNaN(i))throw new e.SchemaType.CastError(`Matrix3: ${t} does not seem to contain right values. Expect values in range 0 and 1.`)}return n}}return t.MATRIX3_BSON_TYPE=s.BSON_DATA_ARRAY,e.Schema.Types.Matrix3=t,e}
/**
 * @module Types/Matrix4
 * @desc Export the three js Matrix4 type for Mongoose.
 *
 * @requires {@link module: [itee-validators]{@link https://github.com/Itee/itee-validators}}
 * @requires {@link module: [bson]{@link https://github.com/mongodb/js-bson}}
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */function zs(e){class t extends e.SchemaType{constructor(e,t){super(e,t,"Matrix4")}cast(t){if(r.isNotDefined(t))throw new e.SchemaType.CastError(`Matrix4: ${t} is null or undefined`);if(r.isNotArray(t)&&!t.isMatrix4)throw new e.SchemaType.CastError(`Matrix4: ${t} is not an array or Matrix4 instance`);let n;n=t.isMatrix4?t.toArray():t;const o=n.length;if(16!==o)throw new e.SchemaType.CastError(`Matrix4: ${t} does not contain the right number of values. Expect 9 values and found ${o}`);for(let i,a=0;a<o;a++){if(i=n[a],r.isNotNumber(i))throw new e.SchemaType.CastError(`Matrix4: ${t} does not seem to contain right values. Expect values in range 0 and 1.`);if(r.isNaN(i))throw new e.SchemaType.CastError(`Matrix4: ${t} does not seem to contain right values. Expect values in range 0 and 1.`)}return n}}return t.MATRIX4_BSON_TYPE=s.BSON_DATA_ARRAY,e.Schema.Types.Matrix4=t,e}
/**
 * @module Types/Quaternion
 * @desc Export the three js Quaternion type for Mongoose.
 *
 * @requires {@link module: [itee-validators]{@link https://github.com/Itee/itee-validators}}
 * @requires {@link module: [bson]{@link https://github.com/mongodb/js-bson}}
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */function Ys(e){class t extends e.SchemaType{constructor(e,t){super(e,t,"Quaternion")}cast(t){if(r.isNotDefined(t))throw new e.SchemaType.CastError(`Quaternion: ${t} is null or undefined`);if(r.isNotObject(t)&&!t.isQuaternion)throw new e.SchemaType.CastError(`Quaternion: ${t} is not a object or Quaternion instance`);if(!("x"in t))throw new e.SchemaType.CastError(`Quaternion: ${t} does not contain x property`);if(r.isNotNumber(t.x))throw new e.SchemaType.CastError(`Quaternion: ${t} expected to be a number`);if(!("y"in t))throw new e.SchemaType.CastError(`Quaternion: ${t} does not contain y property`);if(r.isNotNumber(t.y))throw new e.SchemaType.CastError(`Quaternion: ${t} expected to be a number`);if(!("z"in t))throw new e.SchemaType.CastError(`Quaternion: ${t} does not contain z property`);if(r.isNotNumber(t.z))throw new e.SchemaType.CastError(`Quaternion: ${t} expected to be a number`);if(!("w"in t))throw new e.SchemaType.CastError(`Quaternion: ${t} does not contain w property`);if(r.isNotNumber(t.w))throw new e.SchemaType.CastError(`Quaternion: ${t} expected to be a number`);return{x:t.x,y:t.y,z:t.z,w:t.w}}}return t.QUATERNION_BSON_TYPE=s.BSON_DATA_OBJECT,e.Schema.Types.Quaternion=t,e}
/**
 * @module Types/Vector2
 * @desc Export the three js Vector2 type for Mongoose.
 *
 * @requires {@link module: [itee-validators]{@link https://github.com/Itee/itee-validators}}
 * @requires {@link module: [bson]{@link https://github.com/mongodb/js-bson}}
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */function Xs(e){class t extends e.SchemaType{constructor(e,t){super(e,t,"Vector2")}cast(t){if(r.isNotDefined(t))throw new e.SchemaType.CastError(`Vector2: ${t} is null or undefined`);if(r.isNotObject(t)&&!t.isVector2)throw new e.SchemaType.CastError(`Vector2: ${t} is not a object or Vector2 instance`);if(!("x"in t))throw new e.SchemaType.CastError(`Vector2: ${t} does not contain x property`);if(r.isNotNumber(t.x))throw new e.SchemaType.CastError(`Vector2: ${t} expected to be a number`);if(!("y"in t))throw new e.SchemaType.CastError(`Vector2: ${t} does not contain y property`);if(r.isNotNumber(t.y))throw new e.SchemaType.CastError(`Vector2: ${t} expected to be a number`);return{x:t.x,y:t.y}}}return t.VECTOR2_BSON_TYPE=s.BSON_DATA_OBJECT,e.Schema.Types.Vector2=t,e}
/**
 * @module Types/Vector3
 * @desc Export the three js Vector3 type for Mongoose.
 *
 * @requires {@link module: [itee-validators]{@link https://github.com/Itee/itee-validators}}
 * @requires {@link module: [bson]{@link https://github.com/mongodb/js-bson}}
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */function Zs(e){class t extends e.SchemaType{constructor(e,t){super(e,t,"Vector3")}cast(t){if(r.isNotDefined(t))throw new e.SchemaType.CastError(`Vector3: ${t} is null or undefined`);if(r.isNotObject(t)&&!t.isVector3)throw new e.SchemaType.CastError(`Vector3: ${t} is not a object or Vector3 instance`);if(!("x"in t))throw new e.SchemaType.CastError(`Vector3: ${t} does not contain x property`);if(r.isNotNumber(t.x))throw new e.SchemaType.CastError(`Vector3: ${t} expected to be a number`);if(!("y"in t))throw new e.SchemaType.CastError(`Vector3: ${t} does not contain y property`);if(r.isNotNumber(t.y))throw new e.SchemaType.CastError(`Vector3: ${t} expected to be a number`);if(!("z"in t))throw new e.SchemaType.CastError(`Vector3: ${t} does not contain z property`);if(r.isNotNumber(t.z))throw new e.SchemaType.CastError(`Vector3: ${t} expected to be a number`);return{x:t.x,y:t.y,z:t.z}}}return t.VECTOR3_BSON_TYPE=s.BSON_DATA_OBJECT,e.Schema.Types.Vector3=t,e}
/**
 * @module Types/Vector4
 * @desc Export the three js Vector4 type for Mongoose.
 *
 * @requires {@link module: [itee-validators]{@link https://github.com/Itee/itee-validators}}
 * @requires {@link module: [bson]{@link https://github.com/mongodb/js-bson}}
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 */function Ws(e){class t extends e.SchemaType{constructor(e,t){super(e,t,"Vector4")}cast(t){if(r.isNotDefined(t))throw new e.SchemaType.CastError(`Vector4: ${t} is null or undefined`);if(r.isNotObject(t)&&!t.isVector4)throw new e.SchemaType.CastError(`Vector4: ${t} is not a object or Vector4 instance`);if(!("x"in t))throw new e.SchemaType.CastError(`Vector4: ${t} does not contain x property`);if(r.isNotNumber(t.x))throw new e.SchemaType.CastError(`Vector4: ${t} expected to be a number`);if(!("y"in t))throw new e.SchemaType.CastError(`Vector4: ${t} does not contain y property`);if(r.isNotNumber(t.y))throw new e.SchemaType.CastError(`Vector4: ${t} expected to be a number`);if(!("z"in t))throw new e.SchemaType.CastError(`Vector4: ${t} does not contain z property`);if(r.isNotNumber(t.z))throw new e.SchemaType.CastError(`Vector4: ${t} expected to be a number`);if(!("w"in t))throw new e.SchemaType.CastError(`Vector4: ${t} does not contain w property`);if(r.isNotNumber(t.w))throw new e.SchemaType.CastError(`Vector4: ${t} expected to be a number`);return{x:t.x,y:t.y,z:t.z,w:t.w}}}return t.VECTOR4_BSON_TYPE=s.BSON_DATA_OBJECT,e.Schema.Types.Vector4=t,e}
/**
 * @module MongoDBThreePlugin
 * @desc Three way to register Types and Schema
 * using cjs module under types and schemas folder.
 * using FunctionRegistrator for type and add to plugin using .addType( myFunctionRegistrator ), extending class AbstractMongooseRegistrator for Schema and add to plugin using .addSchema(
 * MySchemaRegistrator ) using direct registration importing mongoose in the file (care to the loading order ! An no output about what is registered.)
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [MIT]{@link https://opensource.org/licenses/MIT}
 */
/**
 * @module Loader/LASLoader
 * @desc A loader for ASC cloud point files.
 *
 * @requires {@link https://github.com/Itee/itee-client itee-client}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 * @example
 *
 * import { LASLoader } from 'itee-plugin-three'
 *
 * const loader = new LASLoader();
 *
 * // If the ASC file need to be offseted, it can be set before loading file.
 * loader.setOffset( {
 *      x: 1.0,
 *      y: 52.0,
 *      z: -5.0
 * } );
 *
 * // Then load the file and get the threejs Point Geometry
 * loader.load('/path/to/file.asc', function (geometry) {
 *
 *      scene.add( new Mesh( geometry ) );
 *
 * } );
 *
 */
const Ks=new RegExp("\0","g"),Qs=a.toEnum({Created:0,Unclassified:1,Ground:2,LowVegetation:3,MediumVegetation:4,HighVegetation:5,Building:6,LowPoint:7,ModelKeyPoint:8,Water:9,OverlapPoints:12});class Js{constructor(e,t){if(this.m_bits=new Array,t&&t.length)for(let e=0;e<t.length;e++)this.m_bits.push(t[e]?Js._ON:Js._OFF);else isNaN(t)||(this.m_bits=Js.shred(t).m_bits);if(e&&this.m_bits.length!==e)if(this.m_bits.length<e)for(let t=this.m_bits.length;t<e;t++)this.m_bits.push(Js._OFF);else for(let t=e;t>this.m_bits.length;t--)this.m_bits.pop()}static _intersect(e,t){return e===Js._ON&&t===Js._ON?Js._ON:Js._OFF}static _union(e,t){return e===Js._ON||t===Js._ON?Js._ON:Js._OFF}static _difference(e,t){return e===Js._ON&&t!==Js._ON?Js._ON:Js._OFF}static _getLen(e,t,r){var n=e.getLength(),o=t.getLength();return r?o:n}static getUnion(e,t){for(var r=Js._getLen(e,t,!0),n=new Js(r),o=0;o<r;o++)n.setAt(o,Js._union(e.getAt(o),t.getAt(o)));return n}static getIntersection(e,t){for(var r=Js._getLen(e,t,!0),n=new Js(r),o=0;o<r;o++)n.setAt(o,Js._intersect(e.getAt(o),t.getAt(o)));return n}static getDifference(e,t){for(var r=Js._getLen(e,t,!0),n=new Js(r),o=0;o<r;o++)n.setAt(o,Js._difference(e.getAt(o),t.getAt(o)));return n}static shred(e){var t=new Array,r=e;do{t.push(r%2),r=Math.floor(r/2)}while(r>0);return new Js(t.length,t.reverse())}getLength(){return this.m_bits.length}getAt(e){return e<this.m_bits.length?this.m_bits[e]:null}setAt(e,t){e<this.m_bits.length&&(this.m_bits[e]=t?Js._ON:Js._OFF)}resize(e){for(var t=new Array,r=0;r<e;r++)r<this.m_bits.length?t.push(this.m_bits[r]):t.push(Js._OFF);this.m_bits=t}getCompliment(){for(var e=new Js(this.m_bits.length),t=0;t<this.m_bits.length;t++)e.setAt(t,this.m_bits[t]?Js._OFF:Js._ON);return e}toString(){for(var e=new String,t=0;t<this.m_bits.length;t++)e=e.concat(this.m_bits[t]===Js._ON?"1":"0");return e}toNumber(){for(var e=0,t=0,r=this.m_bits.length-1;r>=0;r--)this.m_bits[r]===Js._ON&&(t+=Math.pow(2,e)),e++;return t}}Js._ON=1,Js._OFF=0;class qs{static getBit(e,t){return e&1<<t?1:0}static setBit(e,t){return e|1<<t}static clearBit(e,t){return e&~(1<<t)}static updateBit(e,t,r){return e&~(1<<t)|(r?1:0)<<t}static getBits(e,t){let r=0;for(let n of t)qs.getBit(e,n)&&(r=qs.setBit(r,n));return r}}exports.ASCLoader=
/**
 * @module Loader/ASCLoader
 * @desc A loader for ASC cloud point files.
 *
 * @requires {@link https://github.com/Itee/itee-client itee-client}
 * @requires {@link https://github.com/Itee/three-full three-full}
 *
 * @author [Tristan Valcke]{@link https://github.com/Itee}
 * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}
 * @example
 *
 * import { ASCLoader } from 'itee-plugin-three'
 *
 * const loader = new ASCLoader();
 *
 * // If the ASC file need to be offseted, it can be set before loading file.
 * loader.setOffset( {
 *      x: 1.0,
 *      y: 52.0,
 *      z: -5.0
 * } );
 *
 * // Then load the file and get the threejs Point Geometry
 * loader.load('/path/to/file.asc', function (geometry) {
 *
 *      scene.add( new Mesh( geometry ) );
 *
 * } );
 *
 */
class{constructor(e=n.DefaultLoadingManager,t=i.DefaultLogger){this.manager=e,this.logger=t,this._boundingBox=new n.Box3,this._points=[],this._numberOfPoints=0,this._coloredPoints=!1,this._autoOffset=!1,this._offset={x:0,y:0,z:0},this._positions=null,this._bufferIndex=0,this._positionsC=null,this._bufferIndexC=0,this.wrongPoints=0}load(e,t,r,o,i){const a=new n.FileLoader(this.manager);a.setResponseType("blob"),a.load(e,function(e){const a=new n.Group;this._parse(e,a,t,r,o,i),t(a)}.bind(this),r,o)}setOffset(e){this._offset=e,this._autoOffset=!1}_parse(e,t,r,n,o,i){const a=this,s=i||100,c=new FileReader,u=134217728;let d=0;function l(){if(d>=e.size)return;const t=e.slice(d,d+u,"text/plain");c.readAsText(t)}c.onabort=e=>{this.logger.log("abortEvent:"),this.logger.log(e)},c.onerror=e=>{this.logger.log("errorEvent:"),this.logger.log(e),o&&o(e)},c.onloadstart=e=>{this.logger.log("loadStartEvent:"),this.logger.log(e)},c.onprogress=e=>{this.logger.log("progressEvent:"),this.logger.log(e),n&&n(e)},c.onload=e=>{this.logger.log("loadEvent:"),this.logger.log(e);const t=e.target.result.split("\n"),r=t.length;d-=t[r-1].length;const n=Math.round(100/s);for(let e=0;e<r-1;e++)e%n===0&&a._parseLine(t[e])},c.onloadend=r=>{this.logger.log("loadEndEvent"),this.logger.log(r),(this._points.length>1e6||d+u>=e.size)&&(this._offsetPoints(),this._createSubCloudPoint(t)),d+=u,l()},l()}_parseLine(e){const t=e.split(/\s/g).filter(Boolean),r=t.length;3===r?this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2])}):4===r?(this._pointsHaveIntensity=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3])})):6===r?(this._pointsHaveColor=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),r:parseFloat(t[3]),g:parseFloat(t[4]),b:parseFloat(t[5])})):7===r?(this._pointsHaveIntensity=!0,this._pointsHaveColor=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),r:parseFloat(t[4]),g:parseFloat(t[5]),b:parseFloat(t[6])})):9===r?(this._pointsHaveColor=!0,this._pointsHaveNormals=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),r:parseFloat(t[3]),g:parseFloat(t[4]),b:parseFloat(t[5]),nx:parseFloat(t[6]),ny:parseFloat(t[7]),nz:parseFloat(t[8])})):10===r?(this._pointsHaveIntensity=!0,this._pointsHaveColor=!0,this._pointsHaveNormals=!0,this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),r:parseFloat(t[4]),g:parseFloat(t[5]),b:parseFloat(t[6]),nx:parseFloat(t[7]),ny:parseFloat(t[8]),nz:parseFloat(t[9])})):this.logger.error(`Invalid data line: ${e}`)}_parseLines(e){const t=e[0].split(/\s/g).filter(Boolean).length;3===t?this._parseLinesAsXYZ(e):4===t?this._parseLinesAsXYZI(e):6===t?this._parseLinesAsXYZRGB(e):7===t?this._parseLinesAsXYZIRGB(e):9===t?this._parseLinesAsXYZRGBnXnYnZ(e):10===t?this._parseLinesAsXYZIRGBnXnYnZ(e):this.logger.error(`Invalid data line: ${e}`)}_parseLinesAsXYZ(e){let t=[];for(let r=0,n=e.length;r<n;r++)t=e[r].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2])})}_parseLinesAsXYZI(e){this._pointsHaveIntensity=!0;let t=[];for(let r=0,n=e.length;r<n;r++)t=e[r].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3])})}_parseLinesAsXYZRGB(e){this._pointsHaveColor=!0;let t=[];for(let r=0,n=e.length;r<n;r++)t=e[r].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),r:parseFloat(t[3]),g:parseFloat(t[4]),b:parseFloat(t[5])})}_parseLinesAsXYZnXnYnZ(e){let t=[];for(let r=0,n=e.length;r<n;r++)t=e[r].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),nx:parseFloat(t[7]),ny:parseFloat(t[8]),nz:parseFloat(t[9])})}_parseLinesAsXYZIRGB(e){this._pointsHaveIntensity=!0,this._pointsHaveColor=!0;let t=[];for(let r=0,n=e.length;r<n;r++)t=e[r].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),r:parseFloat(t[4]),g:parseFloat(t[5]),b:parseFloat(t[6])})}_parseLinesAsXYZInXnYnZ(e){let t=[];for(let r=0,n=e.length;r<n;r++)t=e[r].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),nx:parseFloat(t[7]),ny:parseFloat(t[8]),nz:parseFloat(t[9])})}_parseLinesAsXYZRGBnXnYnZ(e){this._pointsHaveColor=!0,this._pointsHaveNormals=!0;let t=[];for(let r=0,n=e.length;r<n;r++)t=e[r].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),r:parseFloat(t[3]),g:parseFloat(t[4]),b:parseFloat(t[5]),nx:parseFloat(t[6]),ny:parseFloat(t[7]),nz:parseFloat(t[8])})}_parseLinesAsXYZIRGBnXnYnZ(e){this._pointsHaveIntensity=!0,this._pointsHaveColor=!0,this._pointsHaveNormals=!0;let t=[];for(let r=0,n=e.length;r<n;r++)t=e[r].split(/\s/g).filter(Boolean),this._points.push({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2]),i:parseFloat(t[3]),r:parseFloat(t[4]),g:parseFloat(t[5]),b:parseFloat(t[6]),nx:parseFloat(t[7]),ny:parseFloat(t[8]),nz:parseFloat(t[9])})}_parseLineB(e){const t=e.split(/\s/g).filter(Boolean),r=t.length,n=this._bufferIndex;3===r&&(this._positions[n]=parseFloat(t[0]),this._positions[n+1]=parseFloat(t[1]),this._positions[n+2]=parseFloat(t[2]),this._bufferIndex+=3)}_parseLineC(e){const t=e.split(/\s/g).filter(Boolean),r=t.length,n=this._bufferIndexC;3===r&&(this._positionsC[n]=Number.parseFloat(t[0]),this._positionsC[n+1]=Number.parseFloat(t[1]),this._positionsC[n+2]=Number.parseFloat(t[2]),this._bufferIndexC+=3)}_offsetPoints(){this._autoOffset&&(this._boundingBox.setFromPoints(this._points),this.setOffset(this._boundingBox.getCenter()));const e=this._offset.x,t=this._offset.y,r=this._offset.z;let n=null;for(let o=0,i=this._points.length;o<i;++o)n=this._points[o],n.x-=e,n.y-=t,n.z-=r}_createCloudPoint(e){const t=1e6,r=this._points.length,o=Math.ceil(r/t);let i=null,a=0,s=null;for(let r=0;r<o;++r){i=this._points.splice(0,t),a=i.length;const r=new n.BufferGeometry,o=new Float32Array(3*a),c=new Float32Array(3*a);let u=0,d=null;for(let e=0;e<a;++e)d=i[e],o[u]=d.x,o[u+1]=d.y,o[u+2]=d.z,this._pointsHaveColor?(c[u]=d.r/255,c[u+1]=d.g/255,c[u+2]=d.b/255):(c[u]=.1,c[u+1]=.2,c[u+2]=.5),u+=3;r.setAttribute("position",new n.BufferAttribute(o,3)),r.setAttribute("color",new n.BufferAttribute(c,3));const l=new n.PointsMaterial({size:.01,vertexColors:!0});s=new n.Points(r,l),e.children.push(s)}}_createSubCloudPoint(e){const t=this._points.length,r=new n.BufferGeometry,o=new Float32Array(3*t),i=new Float32Array(3*t);let a=0,s=null;for(let e=0;e<t;++e)s=this._points[e],o[a]=s.x,o[a+1]=s.y,o[a+2]=s.z,this._pointsHaveColor?(i[a]=s.r/255,i[a+1]=s.g/255,i[a+2]=s.b/255):(i[a]=.1,i[a+1]=.2,i[a+2]=.5),a+=3;r.setAttribute("position",new n.BufferAttribute(o,3)),r.setAttribute("color",new n.BufferAttribute(i,3));const c=new n.PointsMaterial({size:.005,vertexColors:!0}),u=new n.Points(r,c);u.rotation.x-=Math.PI/2,e.children.push(u),this._points=[]}},exports.BitArray=Js,exports.BitManager=qs,exports.DBFLoader=f,exports.LASLoader=class{constructor(e=n.DefaultLoadingManager,t=i.DefaultLogger){this.manager=e,this.logger=t,this._reader=new o.TBinaryReader,this._fullVersion="",this._boundingBox=new n.Box3,this._points=[],this._numberOfPoints=0,this._coloredPoints=!1,this._autoOffset=!1,this._offset={x:0,y:0,z:0},this.colorForPointClass={Created:{r:255,g:255,b:255},Unclassified:{r:60,g:60,b:60},Ground:{r:125,g:95,b:5},LowVegetation:{r:153,g:212,b:36},MediumVegetation:{r:52,g:148,b:25},HighVegetation:{r:27,g:77,b:13},Building:{r:153,g:138,b:95},LowPoint:{r:200,g:200,b:200},ModelKeyPoint:{r:237,g:31,b:31},Water:{r:31,g:186,b:237},OverlapPoints:{r:0,g:0,b:0}}}load(e,t,r,o,i){const a=new n.FileLoader(this.manager);a.setResponseType("arraybuffer"),a.load(e,e=>{this.parse(e,t,r,o,i)},r,o)}setOffset(e){this._offset=e,this._autoOffset=!1}parse(e,t,r,n){try{this._reader.buffer=e;if("LASF"!==this._reader.getString(4,!1))throw new Error("Invalid las file signature. Abort parsing !");this._reader.skipOffsetOf(24);const o=this._reader.getUint8(),i=this._reader.getUint8();this._reader.skipOffsetTo(0);const a=`${o}.${i}`,s=this._parseHeader(a),c=this._parseVariableLengthRecords(s),u=this._parsePointDataRecords(s,r);this.convert({Header:s,VariableLengthRecords:c,PointDataRecords:u},t,r,n)}catch(e){n(e)}}_parseHeader(e){switch(e){case"1.0":return this._parseHeader_1_0();case"1.1":return this._parseHeader_1_1();case"1.2":return this._parseHeader_1_2();case"1.3":return this._parseHeader_1_3();case"1.4":return this._parseHeader_1_4();default:throw new Error(`Insupported LAS file version: ${e}. Abort parsing !`)}}_parseHeader_1_0(){return{FileSignature:this._reader.getString(4),Reserved:this._reader.skipOffsetOf(o.Byte.Four),GUID_1:this._reader.getUint32(),GUID_2:this._reader.getUint16(),GUID_3:this._reader.getUint16(),GUID_4:this._reader.getUint8Array(8),VersionMajor:this._reader.getUint8(),VersionMinor:this._reader.getUint8(),SystemIdentifier:this._reader.getString(32).replace(Ks,""),GeneratingSoftware:this._reader.getString(32).replace(Ks,""),FlightDateJulian:this._reader.getUint16(),Year:this._reader.getUint16(),HeaderSize:this._reader.getUint16(),OffsetToPointData:this._reader.getUint32(),NumberOfVariableLengthRecords:this._reader.getUint32(),PointDataFormatID:this._reader.getUint8(),PointDataRecordLength:this._reader.getUint16(),NumberOfPointRecords:this._reader.getUint32(),NumberOfPointsByReturn:this._reader.getUint32Array(5),XScaleFactor:this._reader.getFloat64(),YScaleFactor:this._reader.getFloat64(),ZScaleFactor:this._reader.getFloat64(),XOffset:this._reader.getFloat64(),YOffset:this._reader.getFloat64(),ZOffset:this._reader.getFloat64(),MaxX:this._reader.getFloat64(),MinX:this._reader.getFloat64(),MaxY:this._reader.getFloat64(),MinY:this._reader.getFloat64(),MaxZ:this._reader.getFloat64(),MinZ:this._reader.getFloat64()}}_parseHeader_1_1(){return{FileSignature:this._reader.getString(4),FileSourceId:this._reader.getUint16(),Reserved:this._reader.skipOffsetOf(o.Byte.Two)&&null,GUID_1:this._reader.getUint32(),GUID_2:this._reader.getUint16(),GUID_3:this._reader.getUint16(),GUID_4:this._reader.getUint8Array(8),VersionMajor:this._reader.getUint8(),VersionMinor:this._reader.getUint8(),SystemIdentifier:this._reader.getString(32).replace(Ks,""),GeneratingSoftware:this._reader.getString(32).replace(Ks,""),FileCreationDayOfYear:this._reader.getUint16(),FileCreationYear:this._reader.getUint16(),HeaderSize:this._reader.getUint16(),OffsetToPointData:this._reader.getUint32(),NumberOfVariableLengthRecords:this._reader.getUint32(),PointDataFormatID:this._reader.getUint8(),PointDataRecordLength:this._reader.getUint16(),NumberOfPointRecords:this._reader.getUint32(),NumberOfPointsByReturn:this._reader.getUint32Array(5),XScaleFactor:this._reader.getFloat64(),YScaleFactor:this._reader.getFloat64(),ZScaleFactor:this._reader.getFloat64(),XOffset:this._reader.getFloat64(),YOffset:this._reader.getFloat64(),ZOffset:this._reader.getFloat64(),MaxX:this._reader.getFloat64(),MinX:this._reader.getFloat64(),MaxY:this._reader.getFloat64(),MinY:this._reader.getFloat64(),MaxZ:this._reader.getFloat64(),MinZ:this._reader.getFloat64()}}_parseHeader_1_2(){return{FileSignature:this._reader.getString(4),FileSourceId:this._reader.getUint16(),GlobalEncoding:{GPSTimeType:this._reader.getBit16()?"AdjustedStandardGPSTime":"GPSWeekTime",Reserved:this._reader.skipBitOffsetOf(15)},GUID_1:this._reader.getUint32(),GUID_2:this._reader.getUint16(),GUID_3:this._reader.getUint16(),GUID_4:this._reader.getUint8Array(8),VersionMajor:this._reader.getUint8(),VersionMinor:this._reader.getUint8(),SystemIdentifier:this._reader.getString(32).replace(Ks,""),GeneratingSoftware:this._reader.getString(32).replace(Ks,""),FileCreationDayOfYear:this._reader.getUint16(),FileCreationYear:this._reader.getUint16(),HeaderSize:this._reader.getUint16(),OffsetToPointData:this._reader.getUint32(),NumberOfVariableLengthRecords:this._reader.getUint32(),PointDataFormatID:this._reader.getUint8(),PointDataRecordLength:this._reader.getUint16(),NumberOfPointRecords:this._reader.getUint32(),NumberOfPointsByReturn:this._reader.getUint32Array(5),XScaleFactor:this._reader.getFloat64(),YScaleFactor:this._reader.getFloat64(),ZScaleFactor:this._reader.getFloat64(),XOffset:this._reader.getFloat64(),YOffset:this._reader.getFloat64(),ZOffset:this._reader.getFloat64(),MaxX:this._reader.getFloat64(),MinX:this._reader.getFloat64(),MaxY:this._reader.getFloat64(),MinY:this._reader.getFloat64(),MaxZ:this._reader.getFloat64(),MinZ:this._reader.getFloat64()}}_parseHeader_1_3(){return{FileSignature:this._reader.getString(4),FileSourceId:this._reader.getUint16(),GlobalEncoding:{GPSTimeType:this._reader.getBit16()?"AdjustedStandardGPSTime":"GPSWeekTime",WaveformDataPacketsInternal:this._reader.getBit16(),WaveformDataPacketsExternal:this._reader.getBit16(),ReturnNumbersHaveBeenSyntheticallyGenerated:this._reader.getBit16(),Reserved:this._reader.skipBitOffsetOf(12)},GUID_1:this._reader.getUint32(),GUID_2:this._reader.getUint16(),GUID_3:this._reader.getUint16(),GUID_4:this._reader.getUint8Array(8),VersionMajor:this._reader.getUint8(),VersionMinor:this._reader.getUint8(),SystemIdentifier:this._reader.getString(32).replace(Ks,""),GeneratingSoftware:this._reader.getString(32).replace(Ks,""),FileCreationDayOfYear:this._reader.getUint16(),FileCreationYear:this._reader.getUint16(),HeaderSize:this._reader.getUint16(),OffsetToPointData:this._reader.getUint32(),NumberOfVariableLengthRecords:this._reader.getUint32(),PointDataFormatID:this._reader.getUint8(),PointDataRecordLength:this._reader.getUint16(),NumberOfPointRecords:this._reader.getUint32(),NumberOfPointsByReturn:this._reader.getUint32Array(5),XScaleFactor:this._reader.getFloat64(),YScaleFactor:this._reader.getFloat64(),ZScaleFactor:this._reader.getFloat64(),XOffset:this._reader.getFloat64(),YOffset:this._reader.getFloat64(),ZOffset:this._reader.getFloat64(),MaxX:this._reader.getFloat64(),MinX:this._reader.getFloat64(),MaxY:this._reader.getFloat64(),MinY:this._reader.getFloat64(),MaxZ:this._reader.getFloat64(),MinZ:this._reader.getFloat64(),StartOfWaveformDataPacketRecord:this._reader.getUint64()}}_parseHeader_1_4(){return{FileSignature:this._reader.getString(4),FileSourceId:this._reader.getUint16(),GlobalEncoding:{GPSTimeType:this._reader.getBit16()?"AdjustedStandardGPSTime":"GPSWeekTime",WaveformDataPacketsInternal:this._reader.getBit16(),WaveformDataPacketsExternal:this._reader.getBit16(),ReturnNumbersHaveBeenSyntheticallyGenerated:this._reader.getBit16(),WKT:this._reader.getBit16()?"WKT":"GeoTIFF",Reserved:this._reader.skipBitOffsetOf(11)},GUID_1:this._reader.getUint32(),GUID_2:this._reader.getUint16(),GUID_3:this._reader.getUint16(),GUID_4:this._reader.getUint8Array(8),VersionMajor:this._reader.getUint8(),VersionMinor:this._reader.getUint8(),SystemIdentifier:this._reader.getString(32).replace(Ks,""),GeneratingSoftware:this._reader.getString(32).replace(Ks,""),FileCreationDayOfYear:this._reader.getUint16(),FileCreationYear:this._reader.getUint16(),HeaderSize:this._reader.getUint16(),OffsetToPointData:this._reader.getUint32(),NumberOfVariableLengthRecords:this._reader.getUint32(),PointDataRecordFormat:this._reader.getUint8(),PointDataRecordLength:this._reader.getUint16(),LegacyNumberOfPointRecords:this._reader.getUint32(),LegacyNumberOfPointsByReturn:this._reader.getUint32Array(5),XScaleFactor:this._reader.getFloat64(),YScaleFactor:this._reader.getFloat64(),ZScaleFactor:this._reader.getFloat64(),XOffset:this._reader.getFloat64(),YOffset:this._reader.getFloat64(),ZOffset:this._reader.getFloat64(),MaxX:this._reader.getFloat64(),MinX:this._reader.getFloat64(),MaxY:this._reader.getFloat64(),MinY:this._reader.getFloat64(),MaxZ:this._reader.getFloat64(),MinZ:this._reader.getFloat64(),StartOfWaveformDataPacketRecord:this._reader.getUint64(),StartOfFirstExtendedVariableLengthRecord:this._reader.getUint64(),NumberOfExtendedVariableLengthRecords:this._reader.getUint32(),NumberOfPointRecords:this._reader.getUint64(),NumberOfPointsByReturn:this._reader.getUint64Array(15)}}_parseVariableLengthRecords(e){const t=`${e.VersionMajor}.${e.VersionMinor}`,r=[];for(let n=0;n<e.NumberOfVariableLengthRecords;n++){const e=this._parseVariableLengthRecordHeader();
//!\ Legacy => RecordSignature = Reserved since las v1.1
if("1.0"===t&&43707!==e.Reserved)throw new Error("Invalid variable length record header signature... Abort parsing !");const n=e.UserID,o=e.RecordID,i=e.RecordLengthAfterHeader,a=this._parseVariableLengthRecordContent(n,o,i);r.push({Header:e,Content:a})}return r}_parseVariableLengthRecordHeader(){return{Reserved:this._reader.getUint16(),UserID:this._reader.getString(16).replace(Ks,""),RecordID:this._reader.getUint16(),RecordLengthAfterHeader:this._reader.getUint16(),Description:this._reader.getString(32).replace(Ks,"")}}_parseVariableLengthRecordContent(e,t,r){switch(e){case"LASF_Projection":return this._parseProjectionRecord(t,r);case"LASF_Spec":return this._parseSpecRecord();default:return this._parseCustomRecord(r)}}_parseProjectionRecord(e,t){switch(e){case 2111:return this._parseOGCMathTransformWKT();case 2112:return this._parseOGCCoordinateTransformWKT();case 34735:return this._parseGeoKeyDirectoryTag();case 34736:return this._parseGeoDoubleParamsTag(t);case 34737:return this._parseGeoASCIIParamsTag(t);default:console.error("Unable to determine LASF_Projection underlying type ! Skip current record."),this._reader.skipOffsetOf(t)}}_parseOGCMathTransformWKT(){}_parseOGCCoordinateTransformWKT(){}_parseGeoKeyDirectoryTag(){const e={wKeyDirectoryVersion:this._reader.getUint16(),wKeyRevision:this._reader.getUint16(),wMinorRevision:this._reader.getUint16(),wNumberOfKeys:this._reader.getUint16(),sKeyEntry:[]};for(let t=0;t<e.wNumberOfKeys;t++)e.sKeyEntry.push({wKeyID:this._reader.getUint16(),wTIFFTagLocation:this._reader.getUint16(),wCount:this._reader.getUint16(),wValue_Offset:this._reader.getUint16()});return e}_parseGeoDoubleParamsTag(e){const t=e/o.Byte.Height,r=[];for(let e=0;e<t;e++)r[e]=this._reader.getFloat64();return r}_parseGeoASCIIParamsTag(e){return this._reader.getString(e).replace(Ks,"")}_parseSpecRecord(e){if(!(e<100)){if(e>=100&&e<355)return this._parseWaveformPacketDesciptor();if(65535===e)return this._parseWaveformDataPacket();throw new RangeError(`Invalid spec record id: ${e}`)}switch(e){case 0:return this._parseClassificationLookupRecord();case 1:return this._parseHeaderLookupForFlightLinesRecord();case 2:return this._parseHistogramRecord();case 3:return this._parseTextAreaDescriptionRecord();case 4:return this._parseExtraBytesRecord();case 7:return this._parseSupersededRecord();default:throw new RangeError(`Invalid spec record id: ${e}`)}}_parseClassificationLookupRecord(){const e=[];for(let t=0;t<256;t++)e.push({ClassNumber:this._reader.getUint8(),Description:this._reader.getString(15).replace(Ks,"")});return e}_parseHeaderLookupForFlightLinesRecord(){return{FileMarkerNumber:this._reader.getUint8(),Filename:this._reader.getString(256).replace(Ks,"")}}_parseHistogramRecord(){}_parseTextAreaDescriptionRecord(){}_parseExtraBytesRecord(){}_parseSupersededRecord(){}_parseWaveformPacketDesciptor(){}_parseWaveformDataPacket(){}_parseCustomRecord(e){const t=new Uint8Array(e);for(let r=0;r<e;r++)t[r]=this._reader.getUint8();return t}_parsePointDataRecords(e,t){const r=e.OffsetToPointData;this._reader.offset!==r&&(console.error("The current reader offset does not match the header offset to point data ! Defaulting to header value."),this._reader.skipOffsetTo(r));const n=e.VersionMinor<4?e.PointDataFormatID:e.PointDataRecordFormat,o=this._getPointDataRecordFormat(n),i=e.VersionMinor<4?e.NumberOfPointRecords:e.LegacyNumberOfPointRecords,a=new Array(i);for(let e=0;e<i;e++)a[e]=o(),e%1e5==0&&t(new ProgressEvent("ParsePointDataRecords",{lengthComputable:!0,loaded:e,total:i}));return a}_getPointDataRecordFormat(e){switch(e){case 0:return this._parsePointDataRecordFormat_0.bind(this);case 1:return this._parsePointDataRecordFormat_1.bind(this);case 2:return this._parsePointDataRecordFormat_2.bind(this);case 3:return this._parsePointDataRecordFormat_3.bind(this);case 4:return this._parsePointDataRecordFormat_4.bind(this);case 5:return this._parsePointDataRecordFormat_5.bind(this);case 6:return this._parsePointDataRecordFormat_6.bind(this);case 7:return this._parsePointDataRecordFormat_7.bind(this);case 8:return this._parsePointDataRecordFormat_8.bind(this);case 9:return this._parsePointDataRecordFormat_9.bind(this);case 10:return this._parsePointDataRecordFormat_10.bind(this);default:throw new RangeError(`Invalid PointDataRecordFormat parameter: ${e}`)}}_parsePointDataRecordFormat_0(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits8(3),NumberOfReturns:this._reader.getBits8(3),ScanDirectionFlag:this._reader.getBit8(),EdgeOfFlightLine:this._reader.getBit8(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},ScanAngleRank:this._reader.getInt8(),UserData:this._reader.getUint8(),PointSourceId:this._reader.getUint16()}}_parsePointDataRecordFormat_1(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits8(3),NumberOfReturns:this._reader.getBits8(3),ScanDirectionFlag:this._reader.getBit8(),EdgeOfFlightLine:this._reader.getBit8(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},ScanAngleRank:this._reader.getInt8(),UserData:this._reader.getUint8(),PointSourceId:this._reader.getUint16(),GPSTime:this._reader.getFloat64()}}_parsePointDataRecordFormat_2(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits8(3),NumberOfReturns:this._reader.getBits8(3),ScanDirectionFlag:this._reader.getBit8(),EdgeOfFlightLine:this._reader.getBit8(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},ScanAngleRank:this._reader.getInt8(),UserData:this._reader.getUint8(),PointSourceId:this._reader.getUint16(),R:this._reader.getUint16(),G:this._reader.getUint16(),B:this._reader.getUint16()}}_parsePointDataRecordFormat_3(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits8(3),NumberOfReturns:this._reader.getBits8(3),ScanDirectionFlag:this._reader.getBit8(),EdgeOfFlightLine:this._reader.getBit8(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},ScanAngleRank:this._reader.getInt8(),UserData:this._reader.getUint8(),PointSourceId:this._reader.getUint16(),GPSTime:this._reader.getFloat64(),R:this._reader.getUint16(),G:this._reader.getUint16(),B:this._reader.getUint16()}}_parsePointDataRecordFormat_4(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits8(3),NumberOfReturns:this._reader.getBits8(3),ScanDirectionFlag:this._reader.getBit8(),EdgeOfFlightLine:this._reader.getBit8(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},ScanAngleRank:this._reader.getInt8(),UserData:this._reader.getUint8(),PointSourceId:this._reader.getUint16(),GPSTime:this._reader.getFloat64(),WavePacketDescriptorIndex:this._reader.getUint8(),ByteOffsetToWaveformData:this._reader.getUint64(),WaveformPacketSizeInBytes:this._reader.getUint32(),ReturnPointWaveformLocation:this._reader.getFloat32(),Xt:this._reader.getFloat32(),Yt:this._reader.getFloat32(),Zt:this._reader.getFloat32()}}_parsePointDataRecordFormat_5(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits8(3),NumberOfReturns:this._reader.getBits8(3),ScanDirectionFlag:this._reader.getBit8(),EdgeOfFlightLine:this._reader.getBit8(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},ScanAngleRank:this._reader.getInt8(),UserData:this._reader.getUint8(),PointSourceId:this._reader.getUint16(),GPSTime:this._reader.getFloat64(),R:this._reader.getUint16(),G:this._reader.getUint16(),B:this._reader.getUint16(),WavePacketDescriptorIndex:this._reader.getUint8(),ByteOffsetToWaveformData:this._reader.getUint64(),WaveformPacketSizeInBytes:this._reader.getUint32(),ReturnPointWaveformLocation:this._reader.getFloat32(),Xt:this._reader.getFloat32(),Yt:this._reader.getFloat32(),Zt:this._reader.getFloat32()}}_parsePointDataRecordFormat_6(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits16(4),NumberOfReturns:this._reader.getBits16(4),ClassificationFlags:this._reader.getBits16(4),ScannerChannel:this._reader.getBits16(2),ScanDirectionFlag:this._reader.getBit16(),EdgeOfFlightLine:this._reader.getBit16(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},UserData:this._reader.getUint8(),ScanAngle:this._reader.getInt16(),PointSourceId:this._reader.getUint16(),GPSTime:this._reader.getFloat64()}}_parsePointDataRecordFormat_7(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits16(4),NumberOfReturns:this._reader.getBits16(4),ClassificationFlags:this._reader.getBits16(4),ScannerChannel:this._reader.getBits16(2),ScanDirectionFlag:this._reader.getBit16(),EdgeOfFlightLine:this._reader.getBit16(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},UserData:this._reader.getUint8(),ScanAngle:this._reader.getInt16(),PointSourceId:this._reader.getUint16(),GPSTime:this._reader.getFloat64(),R:this._reader.getUint16(),G:this._reader.getUint16(),B:this._reader.getUint16()}}_parsePointDataRecordFormat_8(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits16(4),NumberOfReturns:this._reader.getBits16(4),ClassificationFlags:this._reader.getBits16(4),ScannerChannel:this._reader.getBits16(2),ScanDirectionFlag:this._reader.getBit16(),EdgeOfFlightLine:this._reader.getBit16(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},UserData:this._reader.getUint8(),ScanAngle:this._reader.getInt16(),PointSourceId:this._reader.getUint16(),GPSTime:this._reader.getFloat64(),R:this._reader.getUint16(),G:this._reader.getUint16(),B:this._reader.getUint16(),NIR:this._reader.getUint16()}}_parsePointDataRecordFormat_9(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits16(4),NumberOfReturns:this._reader.getBits16(4),ClassificationFlags:this._reader.getBits16(4),ScannerChannel:this._reader.getBits16(2),ScanDirectionFlag:this._reader.getBit16(),EdgeOfFlightLine:this._reader.getBit16(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},UserData:this._reader.getUint8(),ScanAngle:this._reader.getInt16(),PointSourceId:this._reader.getUint16(),GPSTime:this._reader.getFloat64(),WavePacketDescriptorIndex:this._reader.getUint8(),ByteOffsetToWaveformData:this._reader.getUint64(),WaveformPacketSizeInBytes:this._reader.getUint32(),ReturnPointWaveformLocation:this._reader.getFloat32(),Xt:this._reader.getFloat32(),Yt:this._reader.getFloat32(),Zt:this._reader.getFloat32()}}_parsePointDataRecordFormat_10(){return{X:this._reader.getInt32(),Y:this._reader.getInt32(),Z:this._reader.getInt32(),Intensity:this._reader.getUint16(),ReturnNumber:this._reader.getBits16(4),NumberOfReturns:this._reader.getBits16(4),ClassificationFlags:this._reader.getBits16(4),ScannerChannel:this._reader.getBits16(2),ScanDirectionFlag:this._reader.getBit16(),EdgeOfFlightLine:this._reader.getBit16(),Classification:{Class:this._reader.getBits8(5),Synthetic:this._reader.getBit8(),KeyPoint:this._reader.getBit8(),Withheld:this._reader.getBit8()},UserData:this._reader.getUint8(),ScanAngle:this._reader.getInt16(),PointSourceId:this._reader.getUint16(),GPSTime:this._reader.getFloat64(),R:this._reader.getUint16(),G:this._reader.getUint16(),B:this._reader.getUint16(),NIR:this._reader.getUint16(),WavePacketDescriptorIndex:this._reader.getUint8(),ByteOffsetToWaveformData:this._reader.getUint64(),WaveformPacketSizeInBytes:this._reader.getUint32(),ReturnPointWaveformLocation:this._reader.getFloat32(),Xt:this._reader.getFloat32(),Yt:this._reader.getFloat32(),Zt:this._reader.getFloat32()}}convert(e,t,r,o){try{const o=new n.Group;o.name="Cloud",o.matrixAutoUpdate=!1,o.position.x=e.Header.XOffset,o.position.y=e.Header.YOffset,o.position.z=e.Header.ZOffset,o.userData={header:e.Header,records:e.VariableLengthRecords},this._createCloudPoints(o,e,r),t(o)}catch(e){o(e)}}_offsetPoints(){this._autoOffset&&(this._boundingBox.setFromPoints(this._points),this.setOffset(this._boundingBox.getCenter()));const e=this._offset.x,t=this._offset.y,r=this._offset.z;let n=null;for(let o=0,i=this._points.length;o<i;++o)n=this._points[o],n.x-=e,n.y-=t,n.z-=r}_createCloudPoints(e,t,o){const i={0:"Created",1:"Unclassified",2:"Ground",3:"LowVegetation",4:"MediumVegetation",5:"HighVegetation",6:"Building",7:"LowPoint",8:"ModelKeyPoint",9:"Water",12:"OverlapPoints"};let a=-1/0;for(let e of t.PointDataRecords){const t=e.Intensity;t>a&&(a=t)}const s=t.Header.XScaleFactor,c=t.Header.YScaleFactor,u=t.Header.ZScaleFactor,d=1e6,l=t.PointDataRecords.length,m=Math.ceil(l/d),h=t.Header.VersionMinor<4?t.Header.PointDataFormatID:t.Header.PointDataRecordFormat,f=![0,1,4,6,9].includes(h),g=new n.PointsMaterial({size:.01,vertexColors:!0});let p=0,_=null,y=null;for(let h=0;h<m;++h){_=t.PointDataRecords.splice(0,d),p=_.length;const m=new n.BufferGeometry,S=new Float32Array(3*p),F=new Float32Array(3*p);let M=0,b=null;for(let e=0;e<p;++e){const t=e+h*d;if(t%1e5==0&&o(new ProgressEvent("ConvertPointDataRecords",{lengthComputable:!0,loaded:t,total:l})),b=_[e],S[M]=b.X*s,S[M+1]=b.Y*c,S[M+2]=b.Z*u,f)F[M]=b.R/65535,F[M+1]=b.G/65535,F[M+2]=b.B/65535;else{const e=this.colorForPointClass[i[b.Classification.Class]];if(r.isDefined(e))F[M]=e.r/255,F[M+1]=e.g/255,F[M+2]=e.b/255;else{const e=b.Intensity;F[M]=e/a,F[M+1]=e/a,F[M+2]=e/a}}M+=3}m.setAttribute("position",new n.BufferAttribute(S,3)),m.setAttribute("color",new n.BufferAttribute(F,3)),y=new n.Points(m,g),e.add(y)}}_createSubCloudPoint(e){const t=this._points.length,r=new n.BufferGeometry,o=new Float32Array(3*t),i=new Float32Array(3*t);let a=0,s=null;for(let e=0;e<t;++e)s=this._points[e],o[a]=s.x,o[a+1]=s.y,o[a+2]=s.z,this._pointsHaveColor?(i[a]=s.r/255,i[a+1]=s.g/255,i[a+2]=s.b/255):(i[a]=.1,i[a+1]=.2,i[a+2]=.5),a+=3;r.setAttribute("position",new n.BufferAttribute(o,3)),r.setAttribute("color",new n.BufferAttribute(i,3));const c=new n.PointsMaterial({size:.005,vertexColors:!0}),u=new n.Points(r,c);u.rotation.x-=Math.PI/2,e.children.push(u),this._points=[]}},exports.PointClasses=Qs,exports.SHPLoader=M,exports.ShapeType=F,exports.registerPlugin=function(r){return new t.TMongoDBPlugin(r).addType(Vs).addType(ks).addType($s).addType(zs).addType(Ys).addType(Xs).addType(Zs).addType(Ws).addSchema(x.Audio).addSchema(A.AudioListener).addSchema(R.PositionalAudio).addSchema(j.ArrayCamera).addSchema($.Camera).addSchema(X.CubeCamera).addSchema(K.OrthographicCamera).addSchema(q.PerspectiveCamera).addSchema(te.BufferAttribute).addSchema(ae).addSchema(fe.CurvePath).addSchema(pe.Face3).addSchema(Me).addSchema(D).addSchema(ve.Path).addSchema(Oe.Shape).addSchema(xe.ArcCurve).addSchema(Ae.CatmullRomCurve3).addSchema(Re.CubicBezierCurve).addSchema(je.CubicBezierCurve3).addSchema(Ve.Curve).addSchema(ze.CurveExtras).addSchema(Ze.EllipseCurve).addSchema(Qe.LineCurve).addSchema(et.LineCurve3).addSchema(nt.NURBSCurve).addSchema(at.NURBSSurface).addSchema(ut.QuadraticBezierCurve).addSchema(mt.QuadraticBezierCurve3).addSchema(gt.SplineCurve).addSchema(St.BoxBufferGeometry).addSchema(Tt.BoxGeometry).addSchema(vt.CircleBufferGeometry).addSchema(Ot.CircleGeometry).addSchema(xt.ConeBufferGeometry).addSchema(At.ConeGeometry).addSchema(Rt.ConvexGeometry).addSchema(jt.CylinderBufferGeometry).addSchema($t.CylinderGeometry).addSchema(Xt.DecalGeometry).addSchema(Kt.DodecahedronGeometry).addSchema(qt.EdgesGeometry).addSchema(rr.ExtrudeBufferGeometry).addSchema(ir.ExtrudeGeometry).addSchema(cr.IcosahedronBufferGeometry).addSchema(lr.IcosahedronGeometry).addSchema(fr.InstancedBufferGeometry).addSchema(_r.LatheBufferGeometry).addSchema(Fr.LatheGeometry).addSchema(Tr.OctahedronBufferGeometry).addSchema(vr.OctahedronGeometry).addSchema(Or.ParametricBufferGeometry).addSchema(xr.ParametricGeometry).addSchema(Ar.PlaneBufferGeometry).addSchema(Rr.PlaneGeometry).addSchema(jr.PolyhedronBufferGeometry).addSchema($r.PolyhedronGeometry).addSchema(Xr.RingBufferGeometry).addSchema(Kr.RingGeometry).addSchema(qr.ShapeBufferGeometry).addSchema(rn.ShapeGeometry).addSchema(an.SphereBufferGeometry).addSchema(un.SphereGeometry).addSchema(mn.TeapotBufferGeometry).addSchema(gn.TetrahedronBufferGeometry).addSchema(yn.TetrahedronGeometry).addSchema(Mn.TextBufferGeometry).addSchema(wn.TextGeometry).addSchema(Cn.TorusBufferGeometry).addSchema(Nn.TorusGeometry).addSchema(Pn.TorusKnotBufferGeometry).addSchema(Ln.TorusKnotGeometry).addSchema(En.TubeBufferGeometry).addSchema(Vn.TubeGeometry).addSchema(zn.WireframeGeometry).addSchema(Zn.ArrowHelper).addSchema(Qn.AxesHelper).addSchema(eo.Box3Helper).addSchema(no.BoxHelper).addSchema(ao.CameraHelper).addSchema(uo.DirectionalLightHelper).addSchema(ho.FaceNormalsHelper).addSchema(po.GridHelper).addSchema(So.HemisphereLightHelper).addSchema(bo.PlaneHelper).addSchema(Bo.PointLightHelper).addSchema(Do.PolarGridHelper).addSchema(Io.RectAreaLightHelper).addSchema(Go.SkeletonHelper).addSchema(Uo.SpotLightHelper).addSchema(Ho.VertexNormalsHelper).addSchema(ko.AmbientLight).addSchema(Yo.DirectionalLight).addSchema(Wo.HemisphereLight).addSchema(Jo.Light).addSchema(ti.PointLight).addSchema(oi.RectAreaLight).addSchema(ci.SpotLight).addSchema(xi.MeshPhongMaterial).addSchema(hi.LineBasicMaterial).addSchema(pi.LineDashedMaterial).addSchema(_i.Material).addSchema(Fi.MeshBasicMaterial).addSchema(Ti.MeshDepthMaterial).addSchema(vi.MeshLambertMaterial).addSchema(Oi.MeshNormalMaterial).addSchema(Ai.MeshPhysicalMaterial).addSchema(Ri.MeshStandardMaterial).addSchema(ji.MeshToonMaterial).addSchema($i.PointsMaterial).addSchema(Xi.RawShaderMaterial).addSchema(Ki.ShaderMaterial).addSchema(qi.ShadowMaterial).addSchema(ra.SpriteMaterial).addSchema(ia.Box2).addSchema(ca.Box3).addSchema(la.Line3).addSchema(fa.Plane).addSchema(_a.Ray).addSchema(Fa.Sphere).addSchema(Ta.Spherical).addSchema(va.Triangle).addSchema(Da.Bone).addSchema(Pa).addSchema(Ua.ImmediateRenderObject).addSchema(Ha.LensFlare).addSchema(ka.Line).addSchema(Ya.LineLoop).addSchema(Wa.LineSegments).addSchema(Ja.LOD).addSchema(ts.Mesh).addSchema(os.Points).addSchema(ss.Skeleton).addSchema(ds.SkinnedMesh).addSchema(hs.Sprite).addSchema(_s.Fog).addSchema(Ms.Scene).addSchema(vs.CanvasTexture).addSchema(Os.CompressedTexture).addSchema(xs.CubeTexture).addSchema(As.DataTexture).addSchema(Rs.DepthTexture).addSchema(Es.Texture).addSchema(js.VideoTexture).addController(d).addDescriptor({route:"/objects",controller:{name:"TObjects3DController",options:{schemaName:"Objects3D"},can:{create:{on:"put",over:"/(:id)?"},read:{on:"post",over:"/(:id)?"},update:{on:"patch",over:"/(:id)?"},delete:{on:"delete",over:"/(:id)?"}}}}).addController(t.TMongooseController).addDescriptor({route:"/curves",controller:{name:"TMongooseController",options:{schemaName:"Curves"},can:{create:{on:"put",over:"/(:id)?"},read:{on:"post",over:"/(:id)?"},update:{on:"patch",over:"/(:id)?"},delete:{on:"delete",over:"/(:id)?"}}}}).addDescriptor({route:"/geometries",controller:{name:"TMongooseController",options:{schemaName:"Geometries"},can:{create:{on:"put",over:"/(:id)?"},read:{on:"post",over:"/(:id)?"},update:{on:"patch",over:"/(:id)?"},delete:{on:"delete",over:"/(:id)?"}}}}).addDescriptor({route:"/materials",controller:{name:"TMongooseController",options:{schemaName:"Materials"},can:{create:{on:"put",over:"/(:id)?"},read:{on:"post",over:"/(:id)?"},update:{on:"patch",over:"/(:id)?"},delete:{on:"delete",over:"/(:id)?"}}}}).addDescriptor({route:"/textures",controller:{name:"TMongooseController",options:{schemaName:"Textures"},can:{create:{on:"put",over:"/(:id)?"},read:{on:"post",over:"/(:id)?"},update:{on:"patch",over:"/(:id)?"},delete:{on:"delete",over:"/(:id)?"}}}}).addController(e.TAbstractConverterManager).addDescriptor({route:"/uploads",controller:{name:"TAbstractConverterManager",options:{useNext:!0,converters:{JsonToThree:new _,ShpToThree:new b,DbfToThree:new g,FbxToThree:new p,ColladaToThree:new l,StlToThree:new T,TdsToThree:new w,MtlToThree:new y,ObjToThree:new S},rules:[{on:".json",use:"JsonToThree"},{on:".dae",use:"ColladaToThree"},{on:".fbx",use:"FbxToThree"},{on:".stl",use:"StlToThree"},{on:".3ds",use:"TdsToThree"},{on:".shp",use:"ShpToThree"},{on:".dbf",use:"DbfToThree"},{on:[".shp",".dbf"],use:["ShpToThree","DbfToThree"]},{on:".mtl",use:"MtlToThree"},{on:".obj",use:"ObjToThree"},{on:[".mtl",".obj"],use:["MtlToThree","ObjToThree"]}],inserter:B},can:{processFiles:{on:"post",over:"/"}}}})};
