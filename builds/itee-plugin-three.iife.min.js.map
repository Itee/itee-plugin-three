{"version":3,"file":"itee-plugin-three.iife.min.js","sources":["../sources/frontend/controllers/CameraControls.js","../sources/frontend/controllers/CameraPathController.js","../sources/frontend/controllers/ClippingControls.js","../sources/frontend/managers/BufferGeometriesManager.js","../sources/frontend/managers/CurvesManager.js","../sources/frontend/managers/GeometriesManager.js","../sources/frontend/managers/TexturesManager.js","../sources/frontend/managers/MaterialsManager.js","../sources/frontend/objects3d/OrbitControlsHelper.js","../sources/frontend/managers/FilairesManager.js","../sources/frontend/managers/ObjectsManager.js"],"sourcesContent":["/**\r\n * @author [Tristan Valcke]{@link https://github.com/Itee}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @file Todo\r\n *\r\n * @example Todo\r\n *\r\n */\r\n\r\nimport {\r\n    DefaultLogger,\r\n    Keys,\r\n    Mouse\r\n} from 'itee-client'\r\nimport {\r\n    degreesToRadians,\r\n    toEnum\r\n} from 'itee-utils'\r\nimport {\r\n    isEmptyArray,\r\n    isNotBoolean,\r\n    isNotDefined,\r\n    isNull,\r\n    isUndefined\r\n} from 'itee-validators'\r\nimport {\r\n    Camera,\r\n    EventDispatcher,\r\n    Object3D,\r\n    Spherical,\r\n    Vector2,\r\n    Vector3\r\n} from 'three-full'\r\n\r\nconst FRONT = new Vector3( 0, 0, -1 )\r\nconst BACK  = new Vector3( 0, 0, 1 )\r\nconst UP    = new Vector3( 0, 1, 0 )\r\nconst DOWN  = new Vector3( 0, -1, 0 )\r\nconst RIGHT = new Vector3( 1, 0, 0 )\r\nconst LEFT  = new Vector3( -1, 0, 0 )\r\n\r\nconst State = toEnum( {\r\n    None:     0,\r\n    Rotating: 1,\r\n    Panning:  2,\r\n    Rolling:  3,\r\n    Zooming:  4,\r\n    Moving:   5\r\n} )\r\n\r\nconst CameraControlMode = toEnum( {\r\n    FirstPerson: 1,\r\n    Orbit:       2,\r\n    Fly:         3,\r\n    Path:        4\r\n} )\r\n\r\nclass CameraControls extends EventDispatcher {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                logger:     DefaultLogger,\r\n                camera:     null,\r\n                target:     new Object3D(),\r\n                mode:       CameraControlMode.Orbit,\r\n                domElement: window\r\n            }, ...parameters\r\n        }\r\n\r\n        super()\r\n\r\n        // Need to be defined before domElement to make correct binding events\r\n        this._handlers = {\r\n            onMouseEnter:  this._onMouseEnter.bind( this ),\r\n            onMouseLeave:  this._onMouseLeave.bind( this ),\r\n            onMouseDown:   this._onMouseDown.bind( this ),\r\n            onMouseMove:   this._onMouseMove.bind( this ),\r\n            onMouseWheel:  this._onMouseWheel.bind( this ),\r\n            onMouseUp:     this._onMouseUp.bind( this ),\r\n            onDblClick:    this._onDblClick.bind( this ),\r\n            onTouchStart:  this._onTouchStart.bind( this ),\r\n            onTouchEnd:    this._onTouchEnd.bind( this ),\r\n            onTouchCancel: this._onTouchCancel.bind( this ),\r\n            onTouchLeave:  this._onTouchLeave.bind( this ),\r\n            onTouchMove:   this._onTouchMove.bind( this ),\r\n            onKeyDown:     this._onKeyDown.bind( this ),\r\n            onKeyUp:       this._onKeyUp.bind( this )\r\n        }\r\n\r\n        this.logger     = _parameters.logger\r\n        this.camera     = _parameters.camera\r\n        this.target     = _parameters.target\r\n        this.mode       = _parameters.mode\r\n        this.domElement = _parameters.domElement\r\n\r\n        // Set to false to disable controls\r\n        this.enabled = true\r\n\r\n        this._paths               = []\r\n        this._trackPath           = false\r\n        this._cameraJump          = 0.1 // = 1 / path.getLength()\r\n        this._currentPathPosition = null\r\n        this._currentPathOffset   = 0\r\n        this._currentPathIndex    = 0\r\n        this._currentPath         = null\r\n        this._maxJump             = 1.0\r\n\r\n        this._lockedTarget = true\r\n\r\n        // Touches events specific\r\n        this.previousTouches = []\r\n\r\n        // Set to false to disable all/specific displacement\r\n        this.canMove   = true\r\n        this.moveSpeed = 1.0\r\n\r\n        this.canFront          = true\r\n        this.frontMinimum      = -Infinity\r\n        this.frontMaximum      = -Infinity\r\n        this.frontMinSpeed     = 0.0\r\n        this.frontSpeed        = 1.0\r\n        this.frontMaxSpeed     = Infinity\r\n        this.frontAcceleration = 1.0\r\n\r\n        this.canBack          = true\r\n        this.backMinimum      = -Infinity\r\n        this.backMaximum      = -Infinity\r\n        this.backMinSpeed     = 0.0\r\n        this.backSpeed        = 1.0\r\n        this.backMaxSpeed     = Infinity\r\n        this.backAcceleration = 1.0\r\n\r\n        this.canUp          = true\r\n        this.upMinimum      = -Infinity\r\n        this.upMaximum      = -Infinity\r\n        this.upMinSpeed     = 0.0\r\n        this.upSpeed        = 1.0\r\n        this.upMaxSpeed     = Infinity\r\n        this.upAcceleration = 1.0\r\n\r\n        this.canDown          = true\r\n        this.downMinimum      = -Infinity\r\n        this.downMaximum      = -Infinity\r\n        this.downMinSpeed     = 0.0\r\n        this.downSpeed        = 1.0\r\n        this.downMaxSpeed     = Infinity\r\n        this.downAcceleration = 1.0\r\n\r\n        this.canLeft          = true\r\n        this.leftMinimum      = -Infinity\r\n        this.leftMaximum      = -Infinity\r\n        this.leftMinSpeed     = 0.0\r\n        this.leftSpeed        = 1.0\r\n        this.leftMaxSpeed     = Infinity\r\n        this.leftAcceleration = 1.0\r\n\r\n        this.canRight          = true\r\n        this.rightMinimum      = -Infinity\r\n        this.rightMaximum      = -Infinity\r\n        this.rightMinSpeed     = 0.0\r\n        this.rightSpeed        = 1.0\r\n        this.rightMaxSpeed     = Infinity\r\n        this.rightAcceleration = 1.0\r\n\r\n        this.canRotate = true\r\n\r\n        /**\r\n         * How far you can orbit vertically, upper and lower limits.\r\n         * Range is 0 to Math.PI radians.\r\n         * @type {number}\r\n         */\r\n        this.minPolarAngle = 0.001\r\n\r\n        /**\r\n         * How far you can orbit horizontally, upper and lower limits.\r\n         * If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\r\n         * @type {number}\r\n         */\r\n        this.maxPolarAngle = ( Math.PI - 0.001 )\r\n        this.minAzimuthAngle    = -Infinity\r\n        this.maxAzimuthAngle    = Infinity\r\n        this.rotateMinSpeed     = 0.0\r\n        this.rotateSpeed        = 1.0\r\n        this.rotateMaxSpeed     = Infinity\r\n        this.rotateAcceleration = 1.0\r\n\r\n        this.canPan          = true\r\n        this.panMinimum      = -Infinity\r\n        this.panMaximum      = -Infinity\r\n        this.panMinSpeed     = 0.0\r\n        this.panSpeed        = 0.001\r\n        this.panMaxSpeed     = Infinity\r\n        this.panAcceleration = 1.0\r\n\r\n        this.canRoll          = true\r\n        this.rollMinimum      = -Infinity\r\n        this.rollMaximum      = -Infinity\r\n        this.rollMinSpeed     = 0.0\r\n        this.rollSpeed        = 0.1\r\n        this.rollMaxSpeed     = Infinity\r\n        this.rollAcceleration = 1.0\r\n\r\n        this.canZoom          = true\r\n        this.zoomMinimum      = 0\r\n        this.zoomMaximum      = Infinity\r\n        this.zoomMinSpeed     = 0.0\r\n        this.zoomSpeed        = 0.001\r\n        this.zoomMaxSpeed     = Infinity\r\n        this.zoomAcceleration = 1.0\r\n\r\n        this.canLookAt = true\r\n\r\n        // The actions map about input events\r\n        this.actionsMap = {\r\n            front:            [ Keys.Z.value, Keys.UP_ARROW.value ],\r\n            back:             [ Keys.S.value, Keys.DOWN_ARROW.value ],\r\n            up:               [ Keys.A.value, Keys.PAGE_UP.value ],\r\n            down:             [ Keys.E.value, Keys.PAGE_DOWN.value ],\r\n            left:             [ Keys.Q.value, Keys.LEFT_ARROW.value ],\r\n            right:            [ Keys.D.value, Keys.RIGHT_ARROW.value ],\r\n            rotate:           [ Mouse.LEFT.value ],\r\n            pan:              [ Mouse.MIDDLE.value ],\r\n            roll:             {\r\n                left:  [ Keys.R.value ],\r\n                right: [ Keys.T.value ]\r\n            },\r\n            zoom:             [ Mouse.WHEEL.value ],\r\n            lookAtFront:      [ Keys.NUMPAD_2.value ],\r\n            lookAtFrontLeft:  [ Keys.NUMPAD_3.value ],\r\n            lookAtFrontRight: [ Keys.NUMPAD_1.value ],\r\n            lookAtBack:       [ Keys.NUMPAD_8.value ],\r\n            lookAtBackLeft:   [ Keys.NUMPAD_9.value ],\r\n            lookAtBackRight:  [ Keys.NUMPAD_7.value ],\r\n            lookAtUp:         [ Keys.NUMPAD_5.value ],\r\n            lookAtDown:       [ Keys.NUMPAD_0.value ],\r\n            lookAtLeft:       [ Keys.NUMPAD_6.value ],\r\n            lookAtRight:      [ Keys.NUMPAD_4.value ]\r\n        }\r\n\r\n        // The current internal state of controller\r\n        this._state = State.None\r\n\r\n    }\r\n\r\n    get camera () {\r\n\r\n        return this._camera\r\n\r\n    }\r\n\r\n    set camera ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Camera cannot be null ! Expect an instance of Camera' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Camera cannot be undefined ! Expect an instance of Camera' ) }\r\n        if ( !( value instanceof Camera ) ) { throw new Error( `Camera cannot be an instance of ${value.constructor.name}. Expect an instance of Camera.` ) }\r\n\r\n        this._camera = value\r\n\r\n    }\r\n\r\n    get target () {\r\n\r\n        return this._target\r\n\r\n    }\r\n\r\n    set target ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Target cannot be null ! Expect an instance of Object3D.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Target cannot be undefined ! Expect an instance of Object3D.' ) }\r\n        if ( !( value instanceof Object3D ) ) { throw new Error( `Target cannot be an instance of ${value.constructor.name}. Expect an instance of Object3D.` ) }\r\n\r\n        this._target = value\r\n\r\n    }\r\n\r\n    get mode () {\r\n        return this._mode\r\n    }\r\n\r\n    set mode ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Mode cannot be null ! Expect a value from CameraControlMode enum.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Mode cannot be undefined ! Expect a value from CameraControlMode enum.' ) }\r\n        if ( !( value instanceof CameraControlMode ) ) { throw new Error( `Mode cannot be an instance of ${value.constructor.name}. Expect a value from TCameraControlMode enum.` ) }\r\n\r\n        this._mode = value\r\n\r\n        if ( this._trackPath ) {\r\n            this._initPathDisplacement()\r\n        }\r\n\r\n    }\r\n\r\n    get paths () {\r\n        return this._paths\r\n    }\r\n\r\n    set paths ( value ) {\r\n\r\n        this._paths = value\r\n\r\n    }\r\n\r\n    get trackPath () {\r\n        return this._trackPath\r\n    }\r\n\r\n    set trackPath ( value ) {\r\n\r\n        if ( isNotBoolean( value ) ) { throw new Error( `Track path cannot be an instance of ${value.constructor.name}. Expect a boolean.` ) }\r\n\r\n        this._trackPath = value\r\n\r\n        if ( this._trackPath ) {\r\n            this._initPathDisplacement()\r\n        }\r\n\r\n    }\r\n\r\n    get domElement () {\r\n\r\n        return this._domElement\r\n\r\n    }\r\n\r\n    set domElement ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'DomElement cannot be null ! Expect an instance of HTMLDocument.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'DomElement cannot be undefined ! Expect an instance of HTMLDocument.' ) }\r\n        if ( !( ( value instanceof Window ) || ( value instanceof HTMLDocument ) || ( value instanceof HTMLDivElement ) || ( value instanceof HTMLCanvasElement ) ) ) { throw new Error( `DomElement cannot be an instance of ${value.constructor.name}. Expect an instance of Window, HTMLDocument or HTMLDivElement.` ) }\r\n\r\n        // Check focusability of given dom element because in case the element is not focusable\r\n        // the keydown event won't work !\r\n\r\n        // Clear previous element\r\n        if ( this._domElement ) {\r\n            this._domElement.removeEventListener( 'mouseenter', this._handlers.onMouseEnter, false )\r\n            this._domElement.removeEventListener( 'mouseleave', this._handlers.onMouseLeave, false )\r\n            this.dispose()\r\n        }\r\n\r\n        this._domElement = value\r\n        this._domElement.addEventListener( 'mouseenter', this._handlers.onMouseEnter, false )\r\n        this._domElement.addEventListener( 'mouseleave', this._handlers.onMouseLeave, false )\r\n        this.impose()\r\n\r\n    }\r\n\r\n    setCamera ( value ) {\r\n\r\n        this.camera = value\r\n        return this\r\n\r\n    }\r\n\r\n    setTarget ( value ) {\r\n\r\n        this.target = value\r\n        return this\r\n\r\n    }\r\n\r\n    setMode ( value ) {\r\n\r\n        this.mode = value\r\n        return this\r\n\r\n    }\r\n\r\n    setPaths ( value ) {\r\n\r\n        this.paths = value\r\n        return this\r\n\r\n    }\r\n\r\n    addPath ( value ) {\r\n\r\n        this._paths.push( value )\r\n        return this\r\n\r\n    }\r\n\r\n    setTrackPath ( value ) {\r\n\r\n        this.trackPath = value\r\n        return this\r\n\r\n    }\r\n\r\n    setDomElement ( value ) {\r\n\r\n        this.domElement = value\r\n        return this\r\n\r\n    }\r\n\r\n    ///////////////\r\n\r\n    impose () {\r\n\r\n        this._domElement.addEventListener( 'keydown', this._handlers.onKeyDown, false )\r\n        this._domElement.addEventListener( 'keyup', this._handlers.onKeyUp, false )\r\n\r\n        this._domElement.addEventListener( 'dblclick', this._handlers.onDblClick, false )\r\n        this._domElement.addEventListener( 'mousedown', this._handlers.onMouseDown, false )\r\n        this._domElement.addEventListener( 'mousemove', this._handlers.onMouseMove, false )\r\n        this._domElement.addEventListener( 'mouseup', this._handlers.onMouseUp, false )\r\n        this._domElement.addEventListener( 'wheel', this._handlers.onMouseWheel, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n\r\n        this._domElement.addEventListener( 'touchcancel', this._handlers.onTouchCancel, false )\r\n        this._domElement.addEventListener( 'touchend', this._handlers.onTouchEnd, false )\r\n        this._domElement.addEventListener( 'touchleave', this._handlers.onTouchLeave, false )\r\n        this._domElement.addEventListener( 'touchmove', this._handlers.onTouchMove, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n        this._domElement.addEventListener( 'touchstart', this._handlers.onTouchStart, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n\r\n        this.dispatchEvent( { type: 'impose' } )\r\n\r\n    }\r\n\r\n    dispose () {\r\n\r\n        this._domElement.removeEventListener( 'keydown', this._handlers.onKeyDown, false )\r\n        this._domElement.removeEventListener( 'keyup', this._handlers.onKeyUp, false )\r\n\r\n        this._domElement.removeEventListener( 'dblclick', this._handlers.onDblClick, false )\r\n        this._domElement.removeEventListener( 'mousedown', this._handlers.onMouseDown, false )\r\n        this._domElement.removeEventListener( 'mousemove', this._handlers.onMouseMove, false )\r\n        this._domElement.removeEventListener( 'mouseup', this._handlers.onMouseUp, false )\r\n        this._domElement.removeEventListener( 'wheel', this._handlers.onMouseWheel, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n\r\n        this._domElement.removeEventListener( 'touchcancel', this._handlers.onTouchCancel, false )\r\n        this._domElement.removeEventListener( 'touchend', this._handlers.onTouchEnd, false )\r\n        this._domElement.removeEventListener( 'touchleave', this._handlers.onTouchLeave, false )\r\n        this._domElement.removeEventListener( 'touchmove', this._handlers.onTouchMove, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n        this._domElement.removeEventListener( 'touchstart', this._handlers.onTouchStart, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n\r\n        this.dispatchEvent( { type: 'dispose' } )\r\n\r\n    }\r\n\r\n    update () {\r\n\r\n    }\r\n\r\n    setCameraPosition ( newCameraPosition ) {\r\n\r\n        this._camera.position.copy( newCameraPosition )\r\n        this._camera.lookAt( this._target.position )\r\n\r\n        return this\r\n\r\n    }\r\n\r\n    setTargetPosition ( newTargetPosition ) {\r\n\r\n        this._target.position.copy( newTargetPosition )\r\n        this._camera.lookAt( this._target.position )\r\n\r\n        return this\r\n\r\n    }\r\n\r\n    // Handlers\r\n    _consumeEvent ( event ) {\r\n\r\n        if ( !event.cancelable ) {\r\n            return\r\n        }\r\n\r\n        event.stopImmediatePropagation()\r\n\r\n    }\r\n\r\n    // Keys\r\n    _onKeyDown ( keyEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        keyEvent.preventDefault()\r\n\r\n        const actionMap = this.actionsMap\r\n        const key       = keyEvent.keyCode\r\n\r\n        //todo\r\n        //        const altActive   = keyEvent.altKey\r\n        //        const ctrlActive  = keyEvent.ctrlKey\r\n        //        const metaActive  = keyEvent.metaKey\r\n        //        const shiftActive = keyEvent.shiftKey\r\n\r\n        if ( actionMap.front.includes( key ) ) {\r\n\r\n            this._front()\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.back.includes( key ) ) {\r\n\r\n            this._back()\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.up.includes( key ) ) {\r\n\r\n            this._up()\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.down.includes( key ) ) {\r\n\r\n            this._down()\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.left.includes( key ) ) {\r\n\r\n            this._left()\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.right.includes( key ) ) {\r\n\r\n            this._right()\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.rotate.includes( key ) ) {\r\n\r\n            this._rotate( 1.0 )\r\n        } else if ( actionMap.pan.includes( key ) ) {\r\n\r\n            this._pan( 1.0 )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.roll.left.includes( key ) ) {\r\n\r\n            this._roll( 1.0 )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.roll.right.includes( key ) ) {\r\n\r\n            this._roll( -1.0 )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.zoom.includes( key ) ) {\r\n\r\n            this._zoom( 1.0 )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtFront.includes( key ) ) {\r\n\r\n            this._lookAt( FRONT )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtFrontLeft.includes( key ) ) {\r\n\r\n            this._lookAt( new Vector3( -1, 0, -1 ).normalize() )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtFrontRight.includes( key ) ) {\r\n\r\n            this._lookAt( new Vector3( 1, 0, -1 ).normalize() )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtBack.includes( key ) ) {\r\n\r\n            this._lookAt( BACK )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtBackLeft.includes( key ) ) {\r\n\r\n            this._lookAt( new Vector3( -1, 0, 1 ).normalize() )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtBackRight.includes( key ) ) {\r\n\r\n            this._lookAt( new Vector3( 1, 0, 1 ).normalize() )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtUp.includes( key ) ) {\r\n\r\n            this._lookAt( UP )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtDown.includes( key ) ) {\r\n\r\n            this._lookAt( DOWN )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtLeft.includes( key ) ) {\r\n\r\n            this._lookAt( LEFT )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.lookAtRight.includes( key ) ) {\r\n\r\n            this._lookAt( RIGHT )\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else {\r\n            // Unmapped key, just ignore it ! May be this is for an other controls.\r\n        }\r\n\r\n    }\r\n\r\n    _onKeyUp ( keyEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        keyEvent.preventDefault()\r\n\r\n    }\r\n\r\n    // Touches\r\n    _onTouchStart ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        this.previousTouches = touchEvent.touches\r\n\r\n    }\r\n\r\n    _onTouchEnd ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        this.previousTouches = []\r\n        this._state          = State.None\r\n\r\n    }\r\n\r\n    _onTouchCancel ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        this.previousTouches = []\r\n        this._state          = State.None\r\n\r\n    }\r\n\r\n    _onTouchLeave ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        this.previousTouches = []\r\n        this._state          = State.None\r\n\r\n    }\r\n\r\n    _onTouchMove ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        const previousTouches         = this.previousTouches\r\n        const currentTouches          = touchEvent.changedTouches\r\n        const numberOfPreviousTouches = previousTouches.length\r\n        const numberOfCurrentTouches  = currentTouches.length\r\n\r\n        if ( numberOfPreviousTouches === 2 && numberOfCurrentTouches === 2 ) {\r\n\r\n            const previousTouchA    = new Vector2( previousTouches[ 0 ].clientX, previousTouches[ 0 ].clientY )\r\n            const previousTouchB    = new Vector2( previousTouches[ 1 ].clientX, previousTouches[ 1 ].clientY )\r\n            const previousGap       = previousTouchA.distanceTo( previousTouchB )\r\n            const previousCenter    = new Vector2().addVectors( previousTouchA, previousTouchB ).divideScalar( 2 )\r\n            const previousDirection = new Vector2().subVectors( previousTouchA, previousTouchB ).normalize()\r\n\r\n            const currentTouchA    = new Vector2( currentTouches[ 0 ].clientX, currentTouches[ 0 ].clientY )\r\n            const currentTouchB    = new Vector2( currentTouches[ 1 ].clientX, currentTouches[ 1 ].clientY )\r\n            const currentGap       = currentTouchA.distanceTo( currentTouchB )\r\n            const currentCenter    = new Vector2().addVectors( currentTouchA, currentTouchB ).divideScalar( 2 )\r\n            const currentDirection = new Vector2().subVectors( previousTouchA, previousTouchB ).normalize()\r\n\r\n            const deltaPan  = new Vector2().subVectors( currentCenter, previousCenter )\r\n            const deltaZoom = currentGap - previousGap\r\n            const deltaRoll = currentDirection.dot( previousDirection )\r\n\r\n            this._pan( deltaPan )\r\n            this._zoom( deltaZoom )\r\n            this._roll( deltaRoll )\r\n            this._consumeEvent( touchEvent )\r\n\r\n        } else if ( numberOfPreviousTouches === 1 && numberOfCurrentTouches === 1 ) {\r\n\r\n            const deltaRotate = new Vector2(\r\n                currentTouches[ 0 ].clientX - previousTouches[ 0 ].clientX,\r\n                currentTouches[ 0 ].clientY - previousTouches[ 0 ].clientY\r\n            ).divideScalar( 10 ) //todo: to high sensibility else !!!\r\n\r\n            this._rotate( deltaRotate )\r\n            this._consumeEvent( touchEvent )\r\n\r\n        } else {\r\n\r\n            this.logger.warn( 'Ignoring inconsistent touches event.' )\r\n\r\n        }\r\n\r\n        this.previousTouches = currentTouches\r\n\r\n    }\r\n\r\n    // Mouse\r\n    _onMouseEnter ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        this.impose()\r\n        if ( mouseEvent.target.constructor !== HTMLDocument ) {\r\n            this._domElement.focus()\r\n        }\r\n\r\n    }\r\n\r\n    _onMouseLeave ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        if ( mouseEvent.target.constructor !== HTMLDocument ) {\r\n            this._domElement.blur()\r\n        }\r\n        this.dispose()\r\n        this._state = State.None\r\n\r\n    }\r\n\r\n    _onMouseDown ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        const actionMap = this.actionsMap\r\n        const button    = mouseEvent.button\r\n\r\n        if ( actionMap.front.includes( button ) ) {\r\n\r\n            this._state = State.Moving\r\n            this._front()\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.back.includes( button ) ) {\r\n\r\n            this._state = State.Moving\r\n            this._back()\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.up.includes( button ) ) {\r\n\r\n            this._state = State.Moving\r\n            this._up()\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.down.includes( button ) ) {\r\n\r\n            this._state = State.Moving\r\n            this._down()\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.left.includes( button ) ) {\r\n\r\n            this._state = State.Moving\r\n            this._left()\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.right.includes( button ) ) {\r\n\r\n            this._state = State.Moving\r\n            this._right()\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.rotate.includes( button ) ) {\r\n\r\n            this._state = State.Rotating\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.pan.includes( button ) ) {\r\n\r\n            this._state = State.Panning\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.roll.left.includes( button ) ) {\r\n\r\n            this._state = State.Rolling\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.roll.right.includes( button ) ) {\r\n\r\n            this._state = State.Rolling\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else if ( actionMap.zoom.includes( button ) ) {\r\n\r\n            this._state = State.Zooming\r\n            this._consumeEvent( mouseEvent )\r\n\r\n        } else {\r\n\r\n            this._state = State.None\r\n\r\n        }\r\n\r\n    }\r\n\r\n    _onMouseMove ( mouseEvent ) {\r\n\r\n        if ( !this.enabled || this._state === State.None ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        const state = this._state\r\n        const delta = {\r\n            x: mouseEvent.movementX || mouseEvent.mozMovementX || mouseEvent.webkitMovementX || 0,\r\n            y: mouseEvent.movementY || mouseEvent.mozMovementY || mouseEvent.webkitMovementY || 0\r\n        }\r\n\r\n        switch ( state ) {\r\n\r\n            case State.Moving:\r\n                break\r\n\r\n            case State.Rotating:\r\n                this._rotate( delta )\r\n                this._consumeEvent( mouseEvent )\r\n                break\r\n\r\n            case State.Panning:\r\n                this._pan( delta )\r\n                this._consumeEvent( mouseEvent )\r\n                break\r\n\r\n            case State.Rolling:\r\n                this._roll( delta )\r\n                this._consumeEvent( mouseEvent )\r\n                break\r\n\r\n            case State.Zooming:\r\n                this._zoom( delta )\r\n                this._consumeEvent( mouseEvent )\r\n                break\r\n\r\n            default:\r\n                throw new RangeError( `Unknown state: ${state}` )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    //todo allow other displacement from wheel\r\n    _onMouseWheel ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        const delta = mouseEvent.wheelDelta || mouseEvent.deltaY\r\n        this._zoom( delta )\r\n        this._consumeEvent( mouseEvent )\r\n\r\n    }\r\n\r\n    _onMouseUp ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        this._state = State.None\r\n\r\n    }\r\n\r\n    _onDblClick ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        this.logger.warn( 'CameraControls: Double click events is not implemented yet, sorry for the disagreement.' )\r\n\r\n    }\r\n\r\n    // Positional methods\r\n    _front () {\r\n\r\n        if ( !this.canMove || !this.canFront ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            const cameraDirection = FRONT.clone().applyQuaternion( this._camera.quaternion )\r\n            const displacement    = ( this._trackPath ) ? this._getPathDisplacement( cameraDirection ) : cameraDirection.multiplyScalar( this.frontSpeed )\r\n\r\n            this._camera.position.add( displacement )\r\n            this._target.position.add( displacement )\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'move' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _back () {\r\n\r\n        if ( !this.canMove || !this.canBack ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            const cameraDirection = BACK.clone().applyQuaternion( this._camera.quaternion )\r\n            const displacement    = ( this._trackPath ) ? this._getPathDisplacement( cameraDirection ) : cameraDirection.multiplyScalar( this.backSpeed )\r\n\r\n            this._camera.position.add( displacement )\r\n            this._target.position.add( displacement )\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'move' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _up () {\r\n\r\n        if ( !this.canMove || !this.canUp ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            const displacement = UP.clone()\r\n                                   .applyQuaternion( this._camera.quaternion )\r\n                                   .multiplyScalar( this.upSpeed )\r\n\r\n            this._camera.position.add( displacement )\r\n            this._target.position.add( displacement )\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'move' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _down () {\r\n\r\n        if ( !this.canMove || !this.canDown ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            const displacement = DOWN.clone()\r\n                                     .applyQuaternion( this._camera.quaternion )\r\n                                     .multiplyScalar( this.downSpeed )\r\n\r\n            this._camera.position.add( displacement )\r\n            this._target.position.add( displacement )\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'move' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _left () {\r\n\r\n        if ( !this.canMove || !this.canLeft ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            const displacement = LEFT.clone()\r\n                                     .applyQuaternion( this._camera.quaternion )\r\n                                     .multiplyScalar( this.leftSpeed )\r\n\r\n            this._camera.position.add( displacement )\r\n            this._target.position.add( displacement )\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'move' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _right () {\r\n\r\n        if ( !this.canMove || !this.canRight ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            const displacement = RIGHT.clone()\r\n                                      .applyQuaternion( this._camera.quaternion )\r\n                                      .multiplyScalar( this.rightSpeed )\r\n\r\n            this._camera.position.add( displacement )\r\n            this._target.position.add( displacement )\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'move' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _rotate ( delta ) {\r\n\r\n        if ( !this.canRotate ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            const cameraPosition = this._camera.position\r\n            const targetPosition = this._target.position\r\n            const distanceTo     = cameraPosition.distanceTo( targetPosition )\r\n            const targetToCamera = new Vector3().subVectors( cameraPosition, targetPosition ).normalize()\r\n            const rotateSpeed    = this.rotateSpeed\r\n\r\n            switch ( this._mode ) {\r\n\r\n                case CameraControlMode.FirstPerson:\r\n\r\n                    //        const normalizedX = (delta.x / this._domElement.clientWidth) - 1.0\r\n                    //        const normalizedY = (delta.y / this._domElement.clientHeight) - 1.0\r\n                    const normalizedX = delta.x\r\n                    const normalizedY = delta.y\r\n\r\n                    const newTargetPosition = new Vector3( -normalizedX, normalizedY, 0 )\r\n                        .applyQuaternion( this._camera.quaternion )\r\n                        .multiplyScalar( rotateSpeed )\r\n                        .add( targetPosition )\r\n\r\n                    // Protect against owl head\r\n                    const cameraToTargetDirection = new Vector3().subVectors( newTargetPosition, cameraPosition ).normalize()\r\n                    const dotProductUp            = UP.clone().dot( cameraToTargetDirection )\r\n                    const dotProductRight         = RIGHT.clone().dot( cameraToTargetDirection )\r\n\r\n                    const max = 0.97\r\n                    if ( dotProductUp < -max || dotProductUp > max || dotProductRight < -2 || dotProductRight > 2 ) {\r\n                        return\r\n                    }\r\n\r\n                    // Care the target distance will change the sensitivity of mouse move\r\n                    // and\r\n                    // We need to set target at pre-defined distance of camera\r\n                    // because if we use newTargetPosition the distance between\r\n                    // camera and target will increase silently over the time\r\n                    const lockedTargetPostion = cameraToTargetDirection.multiplyScalar( 1.0 ) // Todo: option\r\n                                                                       .add( cameraPosition )\r\n                    this.setTargetPosition( lockedTargetPostion )\r\n\r\n                    break\r\n\r\n                case CameraControlMode.Orbit:\r\n\r\n                    // restrict theta and phi between desired limits\r\n                    const spherical = new Spherical().setFromVector3( targetToCamera )\r\n\r\n                    const newTheta  = spherical.theta + ( degreesToRadians( -delta.x ) * rotateSpeed )\r\n                    const newPhi    = spherical.phi + ( degreesToRadians( -delta.y ) * rotateSpeed )\r\n                    spherical.theta = Math.max( this.minAzimuthAngle, Math.min( this.maxAzimuthAngle, newTheta ) )\r\n                    spherical.phi   = Math.max( this.minPolarAngle, Math.min( this.maxPolarAngle, newPhi ) )\r\n\r\n                    const newPosition = new Vector3().setFromSpherical( spherical )\r\n                                                     .multiplyScalar( distanceTo )\r\n                                                     .add( targetPosition )\r\n\r\n                    this.setCameraPosition( newPosition )\r\n\r\n                    break\r\n\r\n                default:\r\n                    throw new RangeError( `Unamanaged rotation for camera mode ${this._mode}` )\r\n\r\n            }\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'rotate' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _pan ( delta ) {\r\n\r\n        if ( !this.canPan ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            // Take into account the distance between the camera and his target\r\n            const cameraPosition = this._camera.position\r\n            const targetPosition = this._target.position\r\n            const distanceTo     = cameraPosition.distanceTo( targetPosition )\r\n            const displacement   = new Vector3( -delta.x, delta.y, 0 ).applyQuaternion( this._camera.quaternion )\r\n                                                                      .multiplyScalar( this.panSpeed * distanceTo )\r\n\r\n            this._camera.position.add( displacement )\r\n            this._target.position.add( displacement )\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'pan' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _roll ( delta ) {\r\n\r\n        if ( !this.canRoll ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            const cameraPosition = this._camera.position\r\n            const targetPosition = this._target.position\r\n            const targetToCamera = new Vector3().subVectors( cameraPosition, targetPosition ).normalize()\r\n            const angle          = delta * this.rollSpeed\r\n\r\n            this._camera.up.applyAxisAngle( targetToCamera, angle )\r\n            this._camera.lookAt( targetPosition )\r\n            //or\r\n            //        this._camera.rotateOnAxis( targetToCamera, angle )\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'roll' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _zoom ( delta ) {\r\n\r\n        if ( !this.canZoom ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            switch ( this._mode ) {\r\n\r\n                case CameraControlMode.FirstPerson:\r\n\r\n                    if ( delta > 0 ) {\r\n                        this._camera.fov--\r\n                    } else {\r\n                        this._camera.fov++\r\n                    }\r\n\r\n                    this._camera.updateProjectionMatrix()\r\n\r\n                    break\r\n\r\n                case CameraControlMode.Orbit:\r\n\r\n                    const cameraPosition                 = this._camera.position\r\n                    const targetPosition                 = this._target.position\r\n                    const distanceBetweenCameraAndTarget = cameraPosition.distanceTo( targetPosition )\r\n                    const displacement                   = FRONT.clone()\r\n                                                                .applyQuaternion( this._camera.quaternion )\r\n                                                                .multiplyScalar( delta * this.zoomSpeed * distanceBetweenCameraAndTarget )\r\n\r\n                    let cameraNextPosition                   = cameraPosition.clone().add( displacement )\r\n                    const currentCameraToNextCameraDirection = new Vector3().subVectors( cameraNextPosition, cameraPosition ).normalize()\r\n                    const targetToCurrentCameraDirection     = new Vector3().subVectors( cameraPosition, targetPosition ).normalize()\r\n                    const targetToNextCameraDirection        = new Vector3().subVectors( cameraNextPosition, targetPosition ).normalize()\r\n                    const dotCurrentDirection                = currentCameraToNextCameraDirection.dot( targetToCurrentCameraDirection )\r\n                    const dotNextDirection                   = currentCameraToNextCameraDirection.dot( targetToNextCameraDirection )\r\n                    const nextCameraToTargetSquaredDistance  = cameraNextPosition.distanceToSquared( targetPosition )\r\n\r\n                    if ( dotCurrentDirection < 0 && ( ( nextCameraToTargetSquaredDistance < ( this.zoomMinimum * this.zoomMinimum ) ) || dotNextDirection > 0 ) ) {\r\n\r\n                        cameraNextPosition = targetToCurrentCameraDirection.clone()\r\n                                                                           .multiplyScalar( this.zoomMinimum )\r\n                                                                           .add( targetPosition )\r\n\r\n                    }\r\n\r\n                    this._camera.position.copy( cameraNextPosition )\r\n\r\n                    break\r\n\r\n                default:\r\n                    throw new RangeError( `Invalid camera control mode parameter: ${this._mode}` )\r\n\r\n            }\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'zoom' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    _lookAt ( direction ) {\r\n\r\n        if ( !this.canLookAt ) { return }\r\n\r\n        if ( this._camera.type === 'PerspectiveCamera' ) {\r\n\r\n            const _direction     = direction.clone()\r\n            const cameraPosition = this._camera.position\r\n            const targetPosition = this._target.position\r\n            const distanceTo     = cameraPosition.distanceTo( targetPosition )\r\n\r\n            switch ( this.mode ) {\r\n\r\n                case CameraControlMode.FirstPerson:\r\n                    // The result is inverted in front of Orbit type but is correct in FP mode except up and down so invert y axis\r\n                    _direction.y            = -( _direction.y )\r\n                    const newTargetPosition = _direction.multiplyScalar( distanceTo ).add( cameraPosition )\r\n                    this.setTargetPosition( newTargetPosition )\r\n                    break\r\n\r\n                case CameraControlMode.Orbit:\r\n                    const newCameraPosition = _direction.multiplyScalar( distanceTo ).add( targetPosition )\r\n                    this.setCameraPosition( newCameraPosition )\r\n                    break\r\n\r\n                default:\r\n                    throw new RangeError( `Invalid camera control mode parameter: ${this._mode}` )\r\n\r\n            }\r\n\r\n        } else {\r\n\r\n            // Todo: ...\r\n\r\n        }\r\n\r\n        this.dispatchEvent( { type: 'lookAt' } )\r\n        this.dispatchEvent( { type: 'change' } )\r\n\r\n    }\r\n\r\n    // Helpers\r\n    _initPathDisplacement () {\r\n\r\n        //todo: project on closest path position\r\n        //todo: move on path in the FRONT camera direction\r\n\r\n        if ( isEmptyArray( this._paths ) ) {\r\n            this.logger.warn( 'Try to init path displacement without any paths' )\r\n            return\r\n        }\r\n\r\n        if ( isNotDefined( this._currentPath ) ) {\r\n\r\n            this._currentPathIndex  = 0\r\n            this._currentPathOffset = 0\r\n            this._currentPath       = this._paths[ 0 ]\r\n\r\n        }\r\n\r\n        this._currentPathPosition = this._currentPath.getPointAt( this._currentPathOffset )\r\n\r\n        switch ( this._mode ) {\r\n\r\n            case CameraControlMode.FirstPerson:\r\n\r\n                if ( this._lockedTarget ) {\r\n\r\n                    const displacement = new Vector3().subVectors( this._currentPathPosition, this.camera.position )\r\n                    this._camera.position.add( displacement )\r\n                    this._target.position.add( displacement )\r\n\r\n                } else {\r\n\r\n                    this.setCameraPosition( this._currentPathPosition )\r\n\r\n                }\r\n\r\n                break\r\n\r\n            case CameraControlMode.Orbit:\r\n\r\n                if ( this._lockedTarget ) {\r\n\r\n                    const displacement = new Vector3().subVectors( this._currentPathPosition, this.target.position )\r\n                    this._camera.position.add( displacement )\r\n                    this._target.position.add( displacement )\r\n\r\n                } else {\r\n\r\n                    this.setTargetPosition( this._currentPathPosition )\r\n\r\n                }\r\n\r\n                break\r\n\r\n            default:\r\n                throw new RangeError( `Invalid camera control _mode parameter: ${this._mode}` )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    _getPathDisplacement ( cameraDirection ) {\r\n\r\n        let displacement = null\r\n\r\n        //Todo: add options to move in camera direction or not\r\n        // try a default positive progress on path\r\n        const currentPathPosition = this._currentPathPosition\r\n\r\n        const nextPositiveOffset   = this._currentPathOffset + this._cameraJump\r\n        const positiveOffset       = ( nextPositiveOffset < 1 ) ? nextPositiveOffset : 1\r\n        const positivePathPosition = this._currentPath.getPointAt( positiveOffset )\r\n        const positiveDisplacement = new Vector3().subVectors( positivePathPosition, currentPathPosition )\r\n        const positiveDirection    = positiveDisplacement.clone().normalize()\r\n        const positiveDot          = cameraDirection.dot( positiveDirection )\r\n\r\n        const nextNegativeOffset   = this._currentPathOffset - this._cameraJump\r\n        const negativeOffset       = ( nextNegativeOffset > 0 ) ? nextNegativeOffset : 0\r\n        const negativePathPosition = this._currentPath.getPointAt( negativeOffset )\r\n        const negativeDisplacement = new Vector3().subVectors( negativePathPosition, currentPathPosition )\r\n        const negativeDirection    = negativeDisplacement.clone().normalize()\r\n        const negativeDot          = cameraDirection.dot( negativeDirection )\r\n\r\n        if ( positiveDot === 0 && negativeDot < 0 ) {\r\n\r\n            // Search closest path\r\n            const pathExtremityMap = this._getDirectionsMap()\r\n\r\n            let indexOfBestPath  = undefined\r\n            let bestDisplacement = undefined\r\n            let bestDotProduct   = -1\r\n            let isFromStart      = undefined\r\n            pathExtremityMap.forEach( ( pathExtremity ) => {\r\n\r\n                const pathIndex = pathExtremity.index\r\n\r\n                const startDisplacement = pathExtremity.startDisplacement\r\n                if ( startDisplacement ) {\r\n\r\n                    const startDirection = startDisplacement.clone().normalize()\r\n                    const startDot       = cameraDirection.dot( startDirection )\r\n\r\n                    if ( startDot > bestDotProduct ) {\r\n\r\n                        indexOfBestPath  = pathIndex\r\n                        bestDisplacement = startDisplacement\r\n                        bestDotProduct   = startDot\r\n                        isFromStart      = true\r\n\r\n                    }\r\n\r\n                }\r\n\r\n                const endDisplacement = pathExtremity.endDisplacement\r\n                if ( endDisplacement ) {\r\n\r\n                    const endDirection = endDisplacement.clone().normalize()\r\n                    const endDot       = cameraDirection.dot( endDirection )\r\n\r\n                    if ( endDot > bestDotProduct ) {\r\n                        indexOfBestPath  = pathIndex\r\n                        bestDisplacement = endDisplacement\r\n                        bestDotProduct   = endDot\r\n                        isFromStart      = false\r\n                    }\r\n\r\n                }\r\n\r\n            } )\r\n\r\n            if ( indexOfBestPath !== undefined ) {\r\n\r\n                this._currentPathIndex    = indexOfBestPath\r\n                this._currentPath         = this._paths[ this._currentPathIndex ]\r\n                this._currentPathOffset   = ( isFromStart ) ? this._cameraJump : 1 - this._cameraJump\r\n                this._currentPathPosition = this._currentPath.getPointAt( this._currentPathOffset )\r\n                displacement              = bestDisplacement\r\n\r\n            } else {\r\n\r\n                this.logger.warn( 'Reach path end.' )\r\n                displacement = new Vector3()\r\n\r\n            }\r\n\r\n        } else if ( positiveDot > 0 && negativeDot <= 0 ) {\r\n\r\n            displacement              = positiveDisplacement\r\n            this._currentPathOffset   = positiveOffset\r\n            this._currentPathPosition = positivePathPosition\r\n\r\n        } else if ( positiveDot <= 0 && negativeDot > 0 ) {\r\n\r\n            displacement              = negativeDisplacement\r\n            this._currentPathOffset   = negativeOffset\r\n            this._currentPathPosition = negativePathPosition\r\n\r\n        } else if ( positiveDot < 0 && negativeDot === 0 ) {\r\n\r\n            // Search closest path\r\n            const pathExtremityMap = this._getDirectionsMap()\r\n\r\n            let indexOfBestPath  = undefined\r\n            let bestDisplacement = undefined\r\n            let bestDotProduct   = -1\r\n            let isFromStart      = undefined\r\n            pathExtremityMap.forEach( ( pathExtremity ) => {\r\n\r\n                const pathIndex = pathExtremity.index\r\n\r\n                const startDisplacement = pathExtremity.startDisplacement\r\n                if ( startDisplacement ) {\r\n\r\n                    const startDirection = startDisplacement.clone().normalize()\r\n                    const startDot       = cameraDirection.dot( startDirection )\r\n\r\n                    if ( startDot > bestDotProduct ) {\r\n\r\n                        indexOfBestPath  = pathIndex\r\n                        bestDisplacement = startDisplacement\r\n                        bestDotProduct   = startDot\r\n                        isFromStart      = true\r\n\r\n                    }\r\n\r\n                }\r\n\r\n                const endDisplacement = pathExtremity.endDisplacement\r\n                if ( endDisplacement ) {\r\n\r\n                    const endDirection = endDisplacement.clone().normalize()\r\n                    const endDot       = cameraDirection.dot( endDirection )\r\n\r\n                    if ( endDot > bestDotProduct ) {\r\n                        indexOfBestPath  = pathIndex\r\n                        bestDisplacement = endDisplacement\r\n                        bestDotProduct   = endDot\r\n                        isFromStart      = false\r\n                    }\r\n\r\n                }\r\n\r\n            } )\r\n\r\n            if ( indexOfBestPath !== undefined ) {\r\n\r\n                this._currentPathIndex    = indexOfBestPath\r\n                this._currentPath         = this._paths[ this._currentPathIndex ]\r\n                this._currentPathOffset   = ( isFromStart ) ? this._cameraJump : 1 - this._cameraJump\r\n                this._currentPathPosition = this._currentPath.getPointAt( this._currentPathOffset )\r\n                displacement              = bestDisplacement\r\n\r\n            } else {\r\n\r\n                this.logger.warn( 'Reach path start.' )\r\n                displacement = new Vector3()\r\n\r\n            }\r\n\r\n        } else if ( ( positiveDot < 0 && negativeDot < 0 ) || ( positiveDot > 0 && negativeDot > 0 ) ) { // Could occurs in high sharp curve with big move step\r\n\r\n            if ( positiveDot > negativeDot ) {\r\n\r\n                displacement              = positiveDisplacement\r\n                this._currentPathOffset   = positiveOffset\r\n                this._currentPathPosition = positivePathPosition\r\n\r\n            } else {\r\n\r\n                displacement              = negativeDisplacement\r\n                this._currentPathOffset   = negativeOffset\r\n                this._currentPathPosition = negativePathPosition\r\n\r\n            }\r\n\r\n        } else {\r\n\r\n            this.logger.warn( 'Unable to find correct next path position.' )\r\n            displacement = new Vector3()\r\n\r\n        }\r\n\r\n        return displacement\r\n\r\n    }\r\n\r\n    _getDirectionsMap () {\r\n\r\n        //todo: use cache !!! Could become a complet map with nodes on path network\r\n\r\n        const currentPathPosition = this._currentPathPosition\r\n        const currentIndex        = this._currentPathIndex\r\n        const jump                = this._cameraJump\r\n        const maxDistance         = this._maxJump\r\n\r\n        return this._paths.reduce( ( array, path, index ) => {\r\n\r\n            if ( index === currentIndex ) { return array }\r\n\r\n            const start           = path.getPointAt( 0 )\r\n            const distanceToStart = currentPathPosition.distanceToSquared( start )\r\n            let startDisplacement = undefined\r\n            if ( distanceToStart < maxDistance ) {\r\n                startDisplacement = new Vector3().subVectors( path.getPointAt( jump ), start )\r\n            }\r\n\r\n            const end           = path.getPointAt( 1 )\r\n            const distanceToEnd = currentPathPosition.distanceToSquared( end )\r\n            let endDisplacement = undefined\r\n            if ( distanceToEnd < maxDistance ) {\r\n                endDisplacement = new Vector3().subVectors( path.getPointAt( 1 - jump ), end )\r\n            }\r\n\r\n            if ( startDisplacement || endDisplacement ) {\r\n                array.push( {\r\n                    index,\r\n                    startDisplacement,\r\n                    endDisplacement\r\n                } )\r\n            }\r\n\r\n            return array\r\n\r\n        }, [] )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport {\r\n    CameraControls,\r\n    CameraControlMode\r\n}\r\n\r\n//// Extra work\r\n\r\n//\r\n//// t: current time, b: begInnIng value, c: change In value, d: duration\r\n//const ease = {\r\n//    def:              'easeOutQuad',\r\n//    easeInQuad:       function ( x, t, b, c, d ) {\r\n//        return c * (t /= d) * t + b;\r\n//    },\r\n//    easeOutQuad:      function ( x, t, b, c, d ) {\r\n//        return -c * (t /= d) * (t - 2) + b;\r\n//    },\r\n//    easeInOutQuad:    function ( x, t, b, c, d ) {\r\n//        if ( (t /= d / 2) < 1 ) {\r\n//            return c / 2 * t * t + b;\r\n//        }\r\n//        return -c / 2 * ((--t) * (t - 2) - 1) + b;\r\n//    },\r\n//    easeInCubic:      function ( x, t, b, c, d ) {\r\n//        return c * (t /= d) * t * t + b;\r\n//    },\r\n//    easeOutCubic:     function ( x, t, b, c, d ) {\r\n//        return c * ((t = t / d - 1) * t * t + 1) + b;\r\n//    },\r\n//    easeInOutCubic:   function ( x, t, b, c, d ) {\r\n//        if ( (t /= d / 2) < 1 ) {\r\n//            return c / 2 * t * t * t + b;\r\n//        }\r\n//        return c / 2 * ((t -= 2) * t * t + 2) + b;\r\n//    },\r\n//    easeInQuart:      function ( x, t, b, c, d ) {\r\n//        return c * (t /= d) * t * t * t + b;\r\n//    },\r\n//    easeOutQuart:     function ( x, t, b, c, d ) {\r\n//        return -c * ((t = t / d - 1) * t * t * t - 1) + b;\r\n//    },\r\n//    easeInOutQuart:   function ( x, t, b, c, d ) {\r\n//        if ( (t /= d / 2) < 1 ) {\r\n//            return c / 2 * t * t * t * t + b;\r\n//        }\r\n//        return -c / 2 * ((t -= 2) * t * t * t - 2) + b;\r\n//    },\r\n//    easeInQuint:      function ( x, t, b, c, d ) {\r\n//        return c * (t /= d) * t * t * t * t + b;\r\n//    },\r\n//    easeOutQuint:     function ( x, t, b, c, d ) {\r\n//        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\r\n//    },\r\n//    easeInOutQuint:   function ( x, t, b, c, d ) {\r\n//        if ( (t /= d / 2) < 1 ) {\r\n//            return c / 2 * t * t * t * t * t + b;\r\n//        }\r\n//        return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\r\n//    },\r\n//    easeInSine:       function ( x, t, b, c, d ) {\r\n//        return -c * Math.cos( t / d * (Math.PI / 2) ) + c + b;\r\n//    },\r\n//    easeOutSine:      function ( x, t, b, c, d ) {\r\n//        return c * Math.sin( t / d * (Math.PI / 2) ) + b;\r\n//    },\r\n//    easeInOutSine:    function ( x, t, b, c, d ) {\r\n//        return -c / 2 * (Math.cos( Math.PI * t / d ) - 1) + b;\r\n//    },\r\n//    easeInExpo:       function ( x, t, b, c, d ) {\r\n//        return (t == 0) ? b : c * Math.pow( 2, 10 * (t / d - 1) ) + b;\r\n//    },\r\n//    easeOutExpo:      function ( x, t, b, c, d ) {\r\n//        return (t == d) ? b + c : c * (-Math.pow( 2, -10 * t / d ) + 1) + b;\r\n//    },\r\n//    easeInOutExpo:    function ( x, t, b, c, d ) {\r\n//        if ( t == 0 ) {\r\n//            return b;\r\n//        }\r\n//        if ( t == d ) {\r\n//            return b + c;\r\n//        }\r\n//        if ( (t /= d / 2) < 1 ) {\r\n//            return c / 2 * Math.pow( 2, 10 * (t - 1) ) + b;\r\n//        }\r\n//        return c / 2 * (-Math.pow( 2, -10 * --t ) + 2) + b;\r\n//    },\r\n//    easeInCirc:       function ( x, t, b, c, d ) {\r\n//        return -c * (Math.sqrt( 1 - (t /= d) * t ) - 1) + b;\r\n//    },\r\n//    easeOutCirc:      function ( x, t, b, c, d ) {\r\n//        return c * Math.sqrt( 1 - (t = t / d - 1) * t ) + b;\r\n//    },\r\n//    easeInOutCirc:    function ( x, t, b, c, d ) {\r\n//        if ( (t /= d / 2) < 1 ) {\r\n//            return -c / 2 * (Math.sqrt( 1 - t * t ) - 1) + b;\r\n//        }\r\n//        return c / 2 * (Math.sqrt( 1 - (t -= 2) * t ) + 1) + b;\r\n//    },\r\n//    easeInElastic:    function ( x, t, b, c, d ) {\r\n//        var s = 1.70158;\r\n//        var p = 0;\r\n//        var a = c;\r\n//        if ( t == 0 ) {\r\n//            return b;\r\n//        }\r\n//        if ( (t /= d) == 1 ) {\r\n//            return b + c;\r\n//        }\r\n//        if ( !p ) {\r\n//            p = d * .3;\r\n//        }\r\n//        if ( a < Math.abs( c ) ) {\r\n//            a     = c;\r\n//            var s = p / 4;\r\n//        }\r\n//        else {\r\n//            var s = p / (2 * Math.PI) * Math.asin( c / a );\r\n//        }\r\n//        return -(a * Math.pow( 2, 10 * (t -= 1) ) * Math.sin( (t * d - s) * (2 * Math.PI) / p )) + b;\r\n//    },\r\n//    easeOutElastic:   function ( x, t, b, c, d ) {\r\n//        var s = 1.70158;\r\n//        var p = 0;\r\n//        var a = c;\r\n//        if ( t == 0 ) {\r\n//            return b;\r\n//        }\r\n//        if ( (t /= d) == 1 ) {\r\n//            return b + c;\r\n//        }\r\n//        if ( !p ) {\r\n//            p = d * .3;\r\n//        }\r\n//        if ( a < Math.abs( c ) ) {\r\n//            a     = c;\r\n//            var s = p / 4;\r\n//        }\r\n//        else {\r\n//            var s = p / (2 * Math.PI) * Math.asin( c / a );\r\n//        }\r\n//        return a * Math.pow( 2, -10 * t ) * Math.sin( (t * d - s) * (2 * Math.PI) / p ) + c + b;\r\n//    },\r\n//    easeInOutElastic: function ( x, t, b, c, d ) {\r\n//        var s = 1.70158;\r\n//        var p = 0;\r\n//        var a = c;\r\n//        if ( t == 0 ) {\r\n//            return b;\r\n//        }\r\n//        if ( (t /= d / 2) == 2 ) {\r\n//            return b + c;\r\n//        }\r\n//        if ( !p ) {\r\n//            p = d * (.3 * 1.5);\r\n//        }\r\n//        if ( a < Math.abs( c ) ) {\r\n//            a     = c;\r\n//            var s = p / 4;\r\n//        }\r\n//        else {\r\n//            var s = p / (2 * Math.PI) * Math.asin( c / a );\r\n//        }\r\n//        if ( t < 1 ) {\r\n//            return -.5 * (a * Math.pow( 2, 10 * (t -= 1) ) * Math.sin( (t * d - s) * (2 * Math.PI) / p )) + b;\r\n//        }\r\n//        return a * Math.pow( 2, -10 * (t -= 1) ) * Math.sin( (t * d - s) * (2 * Math.PI) / p ) * .5 + c + b;\r\n//    },\r\n//    easeInBack:       function ( x, t, b, c, d, s ) {\r\n//        if ( s == undefined ) {\r\n//            s = 1.70158;\r\n//        }\r\n//        return c * (t /= d) * t * ((s + 1) * t - s) + b;\r\n//    },\r\n//    easeOutBack:      function ( x, t, b, c, d, s ) {\r\n//        if ( s == undefined ) {\r\n//            s = 1.70158;\r\n//        }\r\n//        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\r\n//    },\r\n//    easeInOutBack:    function ( x, t, b, c, d, s ) {\r\n//        if ( s == undefined ) {\r\n//            s = 1.70158;\r\n//        }\r\n//        if ( (t /= d / 2) < 1 ) {\r\n//            return c / 2 * (t * t * (((s *= (1.525)) + 1) * t - s)) + b;\r\n//        }\r\n//        return c / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2) + b;\r\n//    },\r\n//    easeInBounce:     function ( x, t, b, c, d ) {\r\n//        return c - jQuery.easing.easeOutBounce( x, d - t, 0, c, d ) + b;\r\n//    },\r\n//    easeOutBounce:    function ( x, t, b, c, d ) {\r\n//        if ( (t /= d) < (1 / 2.75) ) {\r\n//            return c * (7.5625 * t * t) + b;\r\n//        } else if ( t < (2 / 2.75) ) {\r\n//            return c * (7.5625 * (t -= (1.5 / 2.75)) * t + .75) + b;\r\n//        } else if ( t < (2.5 / 2.75) ) {\r\n//            return c * (7.5625 * (t -= (2.25 / 2.75)) * t + .9375) + b;\r\n//        } else {\r\n//            return c * (7.5625 * (t -= (2.625 / 2.75)) * t + .984375) + b;\r\n//        }\r\n//    },\r\n//    easeInOutBounce:  function ( x, t, b, c, d ) {\r\n//        if ( t < d / 2 ) {\r\n//            return jQuery.easing.easeInBounce( x, t * 2, 0, c, d ) * .5 + b;\r\n//        }\r\n//        return jQuery.easing.easeOutBounce( x, t * 2 - d, 0, c, d ) * .5 + c * .5 + b;\r\n//    }\r\n//}\r\n//\r\n////const accelerations = {\r\n////    Linear: function( speed ) {\r\n////        return speed + acceleration\r\n////    }\r\n////}\r\n//\r\n//class Movement {\r\n//\r\n//    constructor ( min, max, minSpeed, currentSpeed, maxSpeed, acceleration ) {\r\n//\r\n//        this.bounds   = {\r\n//            min: -Infinity,\r\n//            max: Infinity\r\n//        }\r\n//        this.speed    = {\r\n//            min:     0,\r\n//            current: 1.0,\r\n//            max:     Infinity\r\n//        }\r\n//        this.minSpeed = 0.0\r\n//        this.speed    = 1.0\r\n//        this.maxSpeed = Infinity\r\n//\r\n//        this.acceleration = function ( timer ) {\r\n//            return speed += 0.1\r\n//        }\r\n//\r\n//        this.deceleration = function ( timer, speed ) {\r\n//            return speed -= 0.1\r\n//        }\r\n//    }\r\n//\r\n//}\r\n","/**\r\n * @author [Tristan Valcke]{@link https://github.com/Itee}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @file Todo\r\n *\r\n * @example Todo\r\n *\r\n */\r\n\r\nimport {\r\n    DefaultLogger as TLogger,\r\n    Keys\r\n}                            from 'itee-client'\r\nimport {\r\n    isNull,\r\n    isUndefined\r\n}                            from 'itee-validators'\r\nimport {\r\n    Camera,\r\n    EventDispatcher,\r\n    MOUSE,\r\n    Object3D,\r\n    Quaternion,\r\n    Vector3\r\n}                            from 'three-full'\r\nimport { CameraControlMode } from './CameraControls'\r\n\r\nconst PI_2    = Math.PI / 2\r\nconst STATE   = {\r\n    NONE:   -1,\r\n    ROTATE: 0,\r\n    ZOOM:   1,\r\n    PAN:    2\r\n}\r\nconst xVector = new Vector3( 1, 0, 0 )\r\nconst yVector = new Vector3( 0, 1, 0 )\r\n\r\n/**\r\n *\r\n * @param camera\r\n * @param domElement\r\n * @constructor\r\n */\r\nfunction CameraPathController ( parameters = {} ) {\r\n\r\n    const _parameters = {\r\n        ...{\r\n            camera:     null,\r\n            target:     new Object3D(),\r\n            mode:       CameraControlMode.Orbit,\r\n            domElement: window\r\n        }, ...parameters\r\n    }\r\n\r\n    const self = this\r\n\r\n    let currentState = STATE.NONE\r\n\r\n    this.camera     = _parameters.camera\r\n    this.cameraJump = 0.0\r\n\r\n    this.paths               = []\r\n    this.pathsMap            = new Map()\r\n    this.currentPath         = undefined\r\n    this.currentPathIndex    = -1\r\n    this.currentPathPosition = 0\r\n\r\n    this.domElement      = ( domElement !== undefined ) ? domElement : document\r\n    this.forwardControl  = this.domElement.children[ 0 ].children[ 0 ].children[ 0 ]\r\n    this.backwardControl = this.domElement.children[ 0 ].children[ 1 ].children[ 0 ]\r\n    this.timeoutId       = undefined\r\n\r\n    // Set to false to disable controls\r\n    this.enabled = false\r\n\r\n    // Set to false to disable zooming\r\n    this.enableZoom = true\r\n    this.zoomSpeed  = 1.0\r\n\r\n    // Set to false to disable rotating\r\n    this.enableRotate = true\r\n    this.rotateSpeed  = 0.0025\r\n\r\n    // Set to false to disable panning\r\n    this.enablePan   = true\r\n    this.keyPanSpeed = 7.0\t// pixels moved per arrow key push\r\n\r\n    this.verticalOffset = 1.5\r\n\r\n    this.keysCodes = {\r\n        forwardKeys:  [ Keys.Z, Keys.UP_ARROW ],\r\n        backwardKeys: [ Keys.S, Keys.BOTTOM_ARROW ]\r\n    }\r\n\r\n    // Mouse\r\n    let mouseQuat = {\r\n        x: new Quaternion(),\r\n        y: new Quaternion()\r\n    }\r\n\r\n    this.mouseButtons = {\r\n        ORBIT: MOUSE.LEFT,\r\n        ZOOM:  MOUSE.MIDDLE,\r\n        PAN:   MOUSE.RIGHT\r\n    }\r\n\r\n    this.orientation = {\r\n        x: 0,\r\n        y: 0\r\n    }\r\n\r\n    // Private methods\r\n    function moveForward () {\r\n\r\n        self.currentPathPosition += self.cameraJump\r\n        if ( self.currentPathPosition > 1 ) {\r\n\r\n            TLogger.log( 'reachEnd' )\r\n            var indexOfNextPath           = self.pathsMap.get( self.currentPathIndex ).indexOfNextPath\r\n            var indexOfNextPathOfNextPath = self.pathsMap.get( indexOfNextPath ).indexOfNextPath\r\n\r\n            // If next path of the next path is the current path that means flows are in the same direction\r\n            // so we need to inverse the current path position to 1 to start at the right position\r\n            if ( indexOfNextPathOfNextPath === self.currentPathIndex ) {\r\n                self.currentPathPosition = 1\r\n            } else {\r\n                self.currentPathPosition = 0\r\n            }\r\n\r\n            self.currentPathIndex = indexOfNextPath\r\n            self.currentPath      = self.paths[ indexOfNextPath ]\r\n\r\n        }\r\n\r\n        self.update()\r\n        self.dispatchEvent( { type: 'move' } )\r\n\r\n    }\r\n\r\n    function moveBackward () {\r\n\r\n        self.currentPathPosition -= self.cameraJump\r\n        if ( self.currentPathPosition < 0 ) {\r\n\r\n            TLogger.log( 'reachStart' )\r\n            var indexOfPreviousPath               = self.pathsMap.get( self.currentPathIndex ).indexOfPreviousPath\r\n            var indexOfPreviousPathOfPreviousPath = self.pathsMap.get( indexOfPreviousPath ).indexOfPreviousPath\r\n\r\n            // If previous path of the previous path is the current path that means flows have the same origin\r\n            // so we need to inverse the current path position to 0 to start at the right position\r\n            if ( indexOfPreviousPathOfPreviousPath === self.currentPathIndex ) {\r\n                self.currentPathPosition = 0\r\n            } else {\r\n                self.currentPathPosition = 1\r\n            }\r\n\r\n            self.currentPathIndex = indexOfPreviousPath\r\n            self.currentPath      = self.paths[ indexOfPreviousPath ]\r\n\r\n        }\r\n\r\n        self.update()\r\n        self.dispatchEvent( { type: 'move' } )\r\n\r\n    }\r\n\r\n    function rotate ( event ) {\r\n\r\n        //TLogger.log( 'handleMouseMoveRotate' )\r\n\r\n        var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0\r\n        var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0\r\n\r\n        var orientation = self.orientation\r\n        orientation.y += movementX * self.rotateSpeed\r\n        orientation.x += movementY * self.rotateSpeed\r\n        orientation.x   = Math.max( -PI_2, Math.min( PI_2, orientation.x ) )\r\n\r\n        self.update()\r\n        self.dispatchEvent( { type: 'rotate' } )\r\n\r\n    }\r\n\r\n    // Handlers\r\n    function onKeyDown ( event ) {\r\n\r\n        if ( self.enabled === false ) {\r\n            return\r\n        }\r\n\r\n        var pathCurrentPoint = self.currentPath.getPointAt( self.currentPathPosition )\r\n        var pathNextPoint    = undefined\r\n        var pathDirection    = undefined\r\n        if ( self.currentPathPosition + self.cameraJump > 1 ) { // end of path\r\n            pathNextPoint = self.currentPath.getPointAt( self.currentPathPosition - self.cameraJump )\r\n            pathDirection = pathNextPoint.sub( pathCurrentPoint ).normalize().negate()\r\n        } else {\r\n            pathNextPoint = self.currentPath.getPointAt( self.currentPathPosition + self.cameraJump )\r\n            pathDirection = pathNextPoint.sub( pathCurrentPoint ).normalize()\r\n        }\r\n\r\n        var cameraDirection = camera.getWorldDirection().normalize()\r\n        var dotProduct      = cameraDirection.dot( pathDirection )\r\n\r\n        if ( dotProduct > 0 && self.keysCodes.forwardKeys.includes( event.keyCode ) ) {\r\n\r\n            event.preventDefault()\r\n            moveForward()\r\n\r\n        } else if ( dotProduct < 0 && self.keysCodes.forwardKeys.includes( event.keyCode ) ) {\r\n\r\n            event.preventDefault()\r\n            moveBackward()\r\n\r\n        } else if ( dotProduct > 0 && self.keysCodes.backwardKeys.includes( event.keyCode ) ) {\r\n\r\n            event.preventDefault()\r\n            moveBackward()\r\n\r\n        } else if ( dotProduct < 0 && self.keysCodes.backwardKeys.includes( event.keyCode ) ) {\r\n\r\n            event.preventDefault()\r\n            moveForward()\r\n\r\n        } else {\r\n\r\n            TLogger.warn( 'The key event is not implemented for key code: ' + event.keyCode )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    function onKeyUp ( event ) {\r\n\r\n        if ( self.enabled === false ) {\r\n            return\r\n        }\r\n\r\n        if ( !self.keysCodes.forwardKeys.includes( event.keyCode ) && !self.keysCodes.backwardKeys.includes( event.keyCode ) ) {\r\n            return\r\n        }\r\n\r\n        if ( event ) { event.preventDefault() }\r\n\r\n        self.dispatchEvent( { type: 'moveEnd' } )\r\n\r\n    }\r\n\r\n    function onMouseDown ( event ) {\r\n\r\n        if ( self.enabled === false ) {\r\n            return\r\n        }\r\n\r\n        event.preventDefault()\r\n\r\n        if ( self.enableRotate === true && event.button === self.mouseButtons.ORBIT ) {\r\n\r\n            currentState = STATE.ROTATE\r\n\r\n        } else if ( self.enableZoom === true && event.button === self.mouseButtons.ZOOM ) {\r\n\r\n            // state = STATE.DOLLY\r\n\r\n        } else if ( self.enablePan === true && event.button === self.mouseButtons.PAN ) {\r\n\r\n            // state = STATE.PAN\r\n\r\n        }\r\n\r\n    }\r\n\r\n    function onMouseMove ( event ) {\r\n\r\n        if ( self.enabled === false ) {\r\n            return\r\n        }\r\n\r\n        event.preventDefault()\r\n\r\n        if ( currentState === STATE.ROTATE ) {\r\n\r\n            rotate( event )\r\n\r\n        } else if ( currentState === STATE.DOLLY ) {\r\n\r\n            // handleMouseMoveDolly( event )\r\n\r\n        } else if ( currentState === STATE.PAN ) {\r\n\r\n            // handleMouseMovePan( event )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    function onMouseUp ( event ) {\r\n\r\n        if ( self.enabled === false ) {\r\n            return\r\n        }\r\n\r\n        if ( event ) { event.preventDefault() }\r\n\r\n        currentState = STATE.NONE\r\n\r\n        self.dispatchEvent( { type: 'rotateEnd' } )\r\n\r\n    }\r\n\r\n    function onForward ( event ) {\r\n\r\n        clearTimeout( self.timeoutId )\r\n\r\n        event.keyCode = Keys.UP_ARROW\r\n        onKeyDown( event )\r\n\r\n        self.timeoutId = setTimeout( onKeyUp.bind( self ), 750 )\r\n\r\n    }\r\n\r\n    function onBackward ( event ) {\r\n\r\n        clearTimeout( self.timeoutId )\r\n\r\n        event.keyCode = Keys.BOTTOM_ARROW\r\n        onKeyDown( event )\r\n\r\n        self.timeoutId = setTimeout( onKeyUp.bind( self ), 750 )\r\n\r\n    }\r\n\r\n    // Public function that access private methods\r\n    this.update = function () {\r\n\r\n        if ( this.enabled === false ) {\r\n            return\r\n        }\r\n\r\n        // Update position\r\n        var newPosition        = this.currentPath.getPointAt( this.currentPathPosition )\r\n        this.camera.position.x = newPosition.x\r\n        this.camera.position.y = newPosition.y + this.verticalOffset\r\n        this.camera.position.z = newPosition.z\r\n\r\n        // Update rotation\r\n        mouseQuat.x.setFromAxisAngle( xVector, this.orientation.x )\r\n        mouseQuat.y.setFromAxisAngle( yVector, this.orientation.y )\r\n        this.camera.quaternion.copy( mouseQuat.y ).multiply( mouseQuat.x )\r\n\r\n    }\r\n\r\n    this.dispose = function () {\r\n\r\n        this.domElement.removeEventListener( 'mousedown', onMouseDown, false )\r\n        this.domElement.removeEventListener( 'mousemove', onMouseMove, false )\r\n        this.domElement.removeEventListener( 'mouseup', onMouseUp, false )\r\n\r\n        window.removeEventListener( 'keydown', onKeyDown, false )\r\n        window.removeEventListener( 'keyup', onKeyUp, false )\r\n\r\n    }\r\n\r\n    this.domElement.addEventListener( 'mousedown', onMouseDown, false )\r\n    this.domElement.addEventListener( 'mousemove', onMouseMove, false )\r\n    this.domElement.addEventListener( 'mouseup', onMouseUp, false )\r\n\r\n    window.addEventListener( 'keydown', onKeyDown, false )\r\n    window.addEventListener( 'keyup', onKeyUp, false )\r\n\r\n    this.forwardControl.addEventListener( 'click', onForward, false )\r\n    this.backwardControl.addEventListener( 'click', onBackward, false )\r\n\r\n}\r\n\r\nObject.assign( CameraPathController.prototype, EventDispatcher.prototype, {\r\n\r\n    get camera () {\r\n\r\n        return this._camera\r\n\r\n    },\r\n\r\n    set camera ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Camera cannot be null ! Expect an instance of Camera' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Camera cannot be undefined ! Expect an instance of Camera' ) }\r\n        if ( !( value instanceof Camera ) ) { throw new Error( `Camera cannot be an instance of ${value.constructor.name}. Expect an instance of Camera.` ) }\r\n\r\n        this._camera = value\r\n\r\n    },\r\n\r\n    setCamera ( value ) {\r\n\r\n        this.camera = value\r\n        return this\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param path\r\n     */\r\n    setPath ( path ) {\r\n\r\n        this.currentPath = path\r\n        this.cameraJump  = 1 / path.getLength()\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param paths\r\n     * @param nameOfFirstPathToFollow\r\n     */\r\n    setPaths ( paths, nameOfFirstPathToFollow ) {\r\n\r\n        this.paths            = paths\r\n        this.currentPathIndex = 0\r\n\r\n        var pathToFollow = this.paths[ this.currentPathIndex ]\r\n\r\n        var numberOfPaths = this.paths.length\r\n\r\n        var firstPath      = undefined\r\n        var startFirstPath = undefined\r\n        var endFirstPath   = undefined\r\n\r\n        var secondPath      = undefined\r\n        var startSecondPath = undefined\r\n        var endSecondPath   = undefined\r\n\r\n        for ( var firstPathIndex = 0 ; firstPathIndex < numberOfPaths ; firstPathIndex++ ) {\r\n\r\n            firstPath      = this.paths[ firstPathIndex ]\r\n            startFirstPath = firstPath.getPointAt( 0 )\r\n            endFirstPath   = firstPath.getPointAt( 1 )\r\n\r\n            if ( nameOfFirstPathToFollow && firstPath.name === nameOfFirstPathToFollow ) {\r\n                pathToFollow          = firstPath\r\n                this.currentPathIndex = firstPathIndex\r\n            }\r\n\r\n            var closestStartDistance    = Infinity\r\n            var closestEndDistance      = Infinity\r\n            var indexOfClosestStartPath = undefined\r\n            var indexOfClosestEndPath   = undefined\r\n\r\n            for ( var secondPathIndex = 0 ; secondPathIndex < numberOfPaths ; secondPathIndex++ ) {\r\n\r\n                if ( firstPathIndex === secondPathIndex ) {\r\n                    continue\r\n                }\r\n\r\n                secondPath      = this.paths[ secondPathIndex ]\r\n                startSecondPath = secondPath.getPointAt( 0 )\r\n                endSecondPath   = secondPath.getPointAt( 1 )\r\n\r\n                if ( startFirstPath.distanceTo( startSecondPath ) < closestStartDistance ) {\r\n\r\n                    closestStartDistance    = startFirstPath.distanceTo( startSecondPath )\r\n                    indexOfClosestStartPath = secondPathIndex\r\n\r\n                }\r\n\r\n                if ( startFirstPath.distanceTo( endSecondPath ) < closestStartDistance ) {\r\n\r\n                    closestStartDistance    = startFirstPath.distanceTo( endSecondPath )\r\n                    indexOfClosestStartPath = secondPathIndex\r\n\r\n                }\r\n\r\n                if ( endFirstPath.distanceTo( startSecondPath ) < closestEndDistance ) {\r\n\r\n                    closestEndDistance    = endFirstPath.distanceTo( startSecondPath )\r\n                    indexOfClosestEndPath = secondPathIndex\r\n\r\n                }\r\n\r\n                if ( endFirstPath.distanceTo( endSecondPath ) < closestEndDistance ) {\r\n\r\n                    closestEndDistance    = endFirstPath.distanceTo( endSecondPath )\r\n                    indexOfClosestEndPath = secondPathIndex\r\n\r\n                }\r\n\r\n            }\r\n\r\n            this.pathsMap.set( firstPathIndex, {\r\n                indexOfPreviousPath: indexOfClosestStartPath,\r\n                indexOfNextPath:     indexOfClosestEndPath\r\n            } )\r\n\r\n        }\r\n\r\n        //        TLogger.log( this.pathsMap )\r\n\r\n        this.setPath( pathToFollow )\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param quat\r\n     */\r\n    setMouseQuat ( quat ) {\r\n\r\n        this.orientation.y = Math.asin( quat.y ) * 2\r\n        this.orientation.x = 0\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    getCurrentPathPosition () {\r\n\r\n        return this.currentPath.getPointAt( this.currentPathPosition )\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @return {undefined}\r\n     */\r\n    getNextPathPosition () {\r\n\r\n        var nextPosition = undefined\r\n\r\n        if ( this.currentPathPosition + this.cameraJump > 1 ) { // end of path\r\n            nextPosition = this.currentPath.getPointAt( this.currentPathPosition - this.cameraJump ).negate()\r\n        } else {\r\n            nextPosition = this.currentPath.getPointAt( this.currentPathPosition + this.cameraJump )\r\n        }\r\n\r\n        return nextPosition\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @return {number}\r\n     */\r\n    getDistanceFromStart () {\r\n\r\n        //Linear distance\r\n        //\t\tvar firstPosition = this.currentPath.getPointAt( 0 )\r\n        //\t\tvar currentPosition = this.currentPath.getPointAt( this.currentPathPosition )\r\n        //\r\n        //\t\treturn firstPosition.distanceTo( currentPosition )\r\n\r\n        // Accordingly to the fact than currentPathPosition is an multiple of cameraJump that is equals to 1 / path.getLength()\r\n        // Todo: need to go the projection to Tronon\r\n        return this.currentPathPosition * this.currentPath.getLength()\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    lookAtPath () {\r\n\r\n        // Set lookup point at the camera height\r\n        var nextPosition = this.getNextPathPosition()\r\n        nextPosition.y   = this.camera.position.y\r\n\r\n        this.camera.lookAt( nextPosition )\r\n\r\n        // We need to update local orientation else on first move event the camera will return to default position !\r\n        this.setMouseQuat( this.camera.quaternion )\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param position\r\n     */\r\n    goTo ( position ) {\r\n\r\n        //Todo: Should use 2D instead of 3D !\r\n\r\n        var numberOfPoints    = undefined\r\n        var currentPath       = undefined\r\n        var currentPathPoints = undefined\r\n        var closestPointIndex = undefined\r\n        var closestPath       = undefined\r\n        var closestPathIndex  = undefined\r\n        var currentDistance   = undefined\r\n        var closestDistance   = Infinity\r\n\r\n        for ( var pathIndex = 0, numberOfPath = this.paths.length ; pathIndex < numberOfPath ; pathIndex++ ) {\r\n\r\n            currentPath       = this.paths[ pathIndex ]\r\n            numberOfPoints    = Math.floor( currentPath.getLength() )\r\n            currentPathPoints = currentPath.getSpacedPoints( numberOfPoints )\r\n\r\n            for ( var pointIndex = 0 ; pointIndex < numberOfPoints ; pointIndex++ ) {\r\n\r\n                currentDistance = position.distanceTo( currentPathPoints[ pointIndex ] )\r\n\r\n                if ( currentDistance < closestDistance ) {\r\n\r\n                    closestDistance   = currentDistance\r\n                    closestPathIndex  = pathIndex\r\n                    closestPath       = currentPath\r\n                    closestPointIndex = pointIndex\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        this.setPath( closestPath )\r\n        this.currentPathIndex    = closestPathIndex\r\n        this.currentPathPosition = this.cameraJump * closestPointIndex\r\n\r\n        this.lookAtPath()\r\n        this.update()\r\n\r\n        this.dispatchEvent( { type: 'moveEnd' } )\r\n        this.dispatchEvent( { type: 'rotateEnd' } )\r\n\r\n    }\r\n\r\n} )\r\n\r\nexport { CameraPathController }\r\n","/**\r\n * @author [Ahmed DCHAR]{@link https://github.com/Dragoneel}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @file Todo\r\n *\r\n * @example Todo\r\n *\r\n */\r\n\r\n/* global Math */\r\n\r\nimport {\r\n    degreesToRadians,\r\n    toEnum\r\n} from 'itee-utils'\r\nimport {\r\n    isArray,\r\n    isDefined,\r\n    isNotArray,\r\n    isNotDefined,\r\n    isNull,\r\n    isUndefined\r\n} from 'itee-validators'\r\nimport {\r\n    Box3,\r\n    BoxBufferGeometry,\r\n    BufferGeometry,\r\n    Camera,\r\n    ConeBufferGeometry,\r\n    CylinderBufferGeometry,\r\n    DoubleSide,\r\n    EdgesGeometry,\r\n    Euler,\r\n    Float32BufferAttribute,\r\n    Line,\r\n    LineBasicMaterial,\r\n    LineSegments,\r\n    Mesh,\r\n    MeshBasicMaterial,\r\n    Object3D,\r\n    OctahedronBufferGeometry,\r\n    Plane,\r\n    PlaneBufferGeometry,\r\n    Quaternion,\r\n    Raycaster,\r\n    SphereBufferGeometry,\r\n    TorusBufferGeometry,\r\n    Vector2,\r\n    Vector3\r\n} from 'three-full'\r\nimport {\r\n    Keys,\r\n    Mouse\r\n} from 'itee-client'\r\n\r\n// Basic Geometries\r\n\r\nclass LineGeometry extends BufferGeometry {\r\n\r\n    constructor ( pointA = new Vector3( 0, 0, 0 ), pointB = new Vector3( 1, 0, 0 ) ) {\r\n        super()\r\n\r\n        this.type = 'LineGeometry'\r\n        this.addAttribute( 'position', new Float32BufferAttribute( [ pointA.x, pointA.y, pointA.z, pointB.x, pointB.y, pointB.z ], 3 ) )\r\n\r\n    }\r\n\r\n}\r\n\r\nclass ClippingBox extends LineSegments {\r\n\r\n    constructor () {\r\n        super()\r\n\r\n        this.geometry = new EdgesGeometry( new BoxBufferGeometry( 2, 2, 2 ) )\r\n        this.material = new LineBasicMaterial( {\r\n            color: 0xffffff\r\n        } )\r\n\r\n        // Planes\r\n        this.normalPlanes = {\r\n            normalRightSide:  new Vector3( -1, 0, 0 ),\r\n            normalLeftSide:   new Vector3( 1, 0, 0 ),\r\n            normalFrontSide:  new Vector3( 0, -1, 0 ),\r\n            normalBackSide:   new Vector3( 0, 1, 0 ),\r\n            normalTopSide:    new Vector3( 0, 0, -1 ),\r\n            normalBottomSide: new Vector3( 0, 0, 1 )\r\n        }\r\n\r\n        this.planes = {\r\n            rightSidePlane:  new Plane( this.normalPlanes.normalRightSide.clone(), 0 ),\r\n            leftSidePlane:   new Plane( this.normalPlanes.normalLeftSide.clone(), 0 ),\r\n            frontSidePlane:  new Plane( this.normalPlanes.normalFrontSide.clone(), 0 ),\r\n            backSidePlane:   new Plane( this.normalPlanes.normalBackSide.clone(), 0 ),\r\n            topSidePlane:    new Plane( this.normalPlanes.normalTopSide.clone(), 0 ),\r\n            bottomSidePlane: new Plane( this.normalPlanes.normalBottomSide.clone(), 0 )\r\n        }\r\n\r\n        this._boundingBox = new Box3()\r\n\r\n    }\r\n\r\n    getBoundingSphere () {\r\n\r\n        this.geometry.computeBoundingSphere()\r\n        this.geometry.boundingSphere.applyMatrix4( this.matrixWorld )\r\n\r\n        return this.geometry.boundingSphere\r\n\r\n    }\r\n\r\n    setColor ( color ) {\r\n\r\n        this.material.color.set( color )\r\n\r\n    }\r\n\r\n    applyClippingTo ( state, objects ) {\r\n\r\n        if ( isNotDefined( objects ) ) { return }\r\n\r\n        let planes = []\r\n        for ( let i in this.planes ) {\r\n            planes.push( this.planes[ i ] )\r\n        }\r\n\r\n        objects.traverse( ( object ) => {\r\n\r\n            if ( isNotDefined( object ) ) { return }\r\n            if ( isNotDefined( object.geometry ) ) { return }\r\n            if ( isNotDefined( object.material ) ) { return }\r\n\r\n            const materials = isArray( object.material ) ? object.material : [ object.material ]\r\n\r\n            for ( let materialIndex = 0, numberOfMaterial = materials.length ; materialIndex < numberOfMaterial ; materialIndex++ ) {\r\n                let material = materials[ materialIndex ]\r\n                if ( !material.clippingPlanes ) {\r\n                    material.clippingPlanes = []\r\n                }\r\n                material.clippingPlanes = ( state ) ? planes : []\r\n            }\r\n\r\n        } )\r\n\r\n    }\r\n\r\n    updateSize ( size ) {\r\n\r\n        this.scale.set( size.x, size.y, size.z )\r\n\r\n    }\r\n\r\n    update () {\r\n\r\n        this._boundingBox.setFromObject( this )\r\n\r\n        const margin = 0.0\r\n        const min    = this._boundingBox.min\r\n        const max    = this._boundingBox.max\r\n\r\n        this.planes.rightSidePlane.constant  = max.x + margin\r\n        this.planes.leftSidePlane.constant   = -min.x + margin\r\n        this.planes.frontSidePlane.constant  = max.y + margin\r\n        this.planes.backSidePlane.constant   = -min.y + margin\r\n        this.planes.topSidePlane.constant    = max.z + margin\r\n        this.planes.bottomSidePlane.constant = -min.z + margin\r\n\r\n    }\r\n\r\n}\r\n\r\n// Materials\r\n\r\nclass HighlightableMaterial extends MeshBasicMaterial {\r\n\r\n    constructor ( parameters ) {\r\n        super( parameters )\r\n        this.isHighlightableMaterial = true\r\n        //        this.type                    = 'HighlightableMaterial'\r\n\r\n        this.depthTest   = false\r\n        this.depthWrite  = false\r\n        this.fog         = false\r\n        this.side        = DoubleSide\r\n        this.transparent = true\r\n        this.oldColor    = this.color.clone()\r\n\r\n    }\r\n\r\n    highlight ( highlighted ) {\r\n\r\n        if ( highlighted ) {\r\n\r\n            const lum = 0.35\r\n            const _r  = this.color.r\r\n            const _g  = this.color.g\r\n            const _b  = this.color.b\r\n            const r   = Math.min( Math.max( 0, _r + ( _r * lum ) ), 1.0 )\r\n            const g   = Math.min( Math.max( 0, _g + ( _g * lum ) ), 1.0 )\r\n            const b   = Math.min( Math.max( 0, _b + ( _b * lum ) ), 1.0 )\r\n            this.color.setRGB( r, g, b )\r\n\r\n        } else {\r\n\r\n            this.color.copy( this.oldColor )\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nclass HighlightableLineMaterial extends LineBasicMaterial {\r\n\r\n    constructor ( parameters ) {\r\n        super( parameters )\r\n        this.isHighlightableMaterial = true\r\n        //        this.type                    = 'HighlightableLineMaterial'\r\n\r\n        this.depthTest   = false\r\n        this.depthWrite  = false\r\n        this.fog         = false\r\n        this.transparent = true\r\n        this.linewidth   = 1\r\n        this.oldColor    = this.color.clone()\r\n\r\n    }\r\n\r\n    highlight ( highlighted ) {\r\n\r\n        if ( highlighted ) {\r\n\r\n            const lum = 0.35\r\n            const _r  = this.color.r\r\n            const _g  = this.color.g\r\n            const _b  = this.color.b\r\n            const r   = Math.min( Math.max( 0, _r + ( _r * lum ) ), 1.0 )\r\n            const g   = Math.min( Math.max( 0, _g + ( _g * lum ) ), 1.0 )\r\n            const b   = Math.min( Math.max( 0, _b + ( _b * lum ) ), 1.0 )\r\n            this.color.setRGB( r, g, b )\r\n\r\n        } else {\r\n\r\n            this.color.copy( this.oldColor )\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n// Pickers\r\n\r\nclass AbstractHitbox extends Mesh {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                geometry: new BufferGeometry(),\r\n                material: new MeshBasicMaterial( {\r\n                    visible:    false,\r\n                    depthTest:  false,\r\n                    depthWrite: false,\r\n                    fog:        false,\r\n                    side:       DoubleSide\r\n                    //                    opacity:     0.0,\r\n                    //                    transparent: true\r\n                } )\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters.geometry, _parameters.material )\r\n        this.isHitbox = true\r\n        this.type     = 'Hitbox'\r\n\r\n    }\r\n}\r\n\r\nclass CylindricaHitbox extends AbstractHitbox {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const cylinderGeometry = new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false )\r\n        cylinderGeometry.translate( 0, 0.5, 0 )\r\n        const _parameters = {\r\n            ...{\r\n                geometry: cylinderGeometry\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isCylindricaHitbox = true\r\n        this.type               = 'CylindricaHitbox'\r\n\r\n    }\r\n\r\n}\r\n\r\nclass PlanarHitbox extends AbstractHitbox {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const planePositions      = [\r\n            0.0, 0.0, 0.0,\r\n            1.1, 0.0, 0.0,\r\n            1.1, 1.1, 0.0,\r\n            0.0, 1.1, 0.0\r\n        ]\r\n        const planeIndexes        = [\r\n            0, 1, 2,\r\n            2, 3, 0\r\n        ]\r\n        const planeBufferGeometry = new BufferGeometry()\r\n        planeBufferGeometry.addAttribute( 'position', new Float32BufferAttribute( planePositions, 3 ) )\r\n        planeBufferGeometry.setIndex( planeIndexes )\r\n\r\n        const _parameters = {\r\n            ...{\r\n                geometry: planeBufferGeometry\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isPlanarHitbox = true\r\n        this.type           = 'PlanarHitbox'\r\n\r\n    }\r\n\r\n}\r\n\r\nclass LozengeHitbox extends AbstractHitbox {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        // Lozenge\r\n        const lozengePositions        = [\r\n            0.0, 0.0, 0.0,\r\n            0.85, 0.0, 0.0,\r\n            1.1, 1.1, 0.0,\r\n            0.0, 0.85, 0.0\r\n        ]\r\n        const lozengeIndexes          = [\r\n            0, 1, 2,\r\n            2, 3, 0\r\n        ]\r\n        const positionBufferAttribute = new Float32BufferAttribute( lozengePositions, 3 )\r\n        const lozengeBufferGeometry   = new BufferGeometry()\r\n        lozengeBufferGeometry.addAttribute( 'position', positionBufferAttribute )\r\n        lozengeBufferGeometry.setIndex( lozengeIndexes )\r\n\r\n        const _parameters = {\r\n            ...{\r\n                geometry: lozengeBufferGeometry\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isPlanarHitbox = true\r\n        this.type           = 'PlanarHitbox'\r\n\r\n    }\r\n\r\n}\r\n\r\nclass OctahedricalHitbox extends AbstractHitbox {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                geometry: new OctahedronBufferGeometry( 1.2, 0 )\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isOctahedricalHitbox = true\r\n        this.type                 = 'OctahedricalHitbox'\r\n\r\n    }\r\n\r\n}\r\n\r\nclass SphericalHitbox extends AbstractHitbox {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                geometry: new SphereBufferGeometry( 1, 8, 6, 0, 2 * Math.PI, 0, Math.PI )\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isSphericalHitbox = true\r\n        this.type              = 'SphericalHitbox'\r\n\r\n    }\r\n\r\n}\r\n\r\nclass TorusHitbox extends AbstractHitbox {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                geometry: new TorusBufferGeometry( 1, 0.12, 4, 12, Math.PI )\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isTorusHitbox = true\r\n        this.type          = 'TorusHitbox'\r\n\r\n    }\r\n\r\n}\r\n\r\n// Handles\r\nclass AbstractHandle extends Object3D {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                color:  0xffffff,\r\n                hitbox: null\r\n            }, ...parameters\r\n        }\r\n\r\n        super()\r\n        this.isHandle = true\r\n        this.type     = 'Handle'\r\n\r\n        this.color  = _parameters.color\r\n        this.hitbox = _parameters.hitbox\r\n\r\n        this.baseQuaternion = new Quaternion()\r\n\r\n    }\r\n\r\n    get color () {\r\n\r\n        return this.line.material.color.clone()\r\n\r\n    }\r\n\r\n    set color ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Color cannot be null ! Expect an instance of Color.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Color cannot be undefined ! Expect an instance of Color.' ) }\r\n        //        if ( !( value instanceof Color ) ) { throw new Error( `Color cannot be an instance of ${value.constructor.name}. Expect an instance of Color.` ) }\r\n\r\n        this.traverse( ( child ) => {\r\n\r\n            let materials = child.material\r\n            if ( !materials ) { return }\r\n\r\n            materials.color.setHex( value )\r\n\r\n        } )\r\n\r\n    }\r\n\r\n    get hitbox () {\r\n        return this._hitbox\r\n    }\r\n\r\n    set hitbox ( value ) {\r\n        this._hitbox = value\r\n        this.add( value )\r\n    }\r\n\r\n    setColor ( value ) {\r\n\r\n        this.color = value\r\n        return this\r\n\r\n    }\r\n\r\n    setHitbox ( value ) {\r\n        this.hitbox = value\r\n        return this\r\n    }\r\n\r\n    setScale ( x, y, z ) {\r\n\r\n        this.scale.set( x, y, z )\r\n        return this\r\n\r\n    }\r\n\r\n    setPosition ( x, y, z ) {\r\n        this.position.set( x, y, z )\r\n        return this\r\n    }\r\n\r\n    highlight ( value ) {\r\n\r\n        for ( let childIndex = 0, numberOfChildren = this.children.length ; childIndex < numberOfChildren ; childIndex++ ) {\r\n            const child = this.children[ childIndex ]\r\n            if ( child.isHitbox ) { continue }\r\n\r\n            const childMaterial = child.material\r\n            if ( isUndefined( childMaterial ) || !childMaterial.isHighlightableMaterial ) { continue }\r\n\r\n            childMaterial.highlight( value )\r\n        }\r\n\r\n    }\r\n\r\n    raycast ( raycaster, intersects ) {\r\n\r\n        const intersections = raycaster.intersectObject( this._hitbox, false )\r\n        if ( intersections.length > 0 ) {\r\n            intersects.push( {\r\n                distance: intersections[ 0 ].distance,\r\n                object:   this\r\n            } )\r\n        }\r\n\r\n    }\r\n\r\n    setRotationFromAxisAndAngle ( axis, angle ) {\r\n\r\n        this.quaternion.setFromAxisAngle( axis, angle )\r\n        this.baseQuaternion.copy( this.quaternion )\r\n        return this\r\n\r\n    }\r\n\r\n    update ( cameraDirection ) {}\r\n\r\n}\r\n\r\nclass TranslateHandle extends AbstractHandle {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                color:     0xffffff,\r\n                hitbox:    new CylindricaHitbox(),\r\n                direction: new Vector3( 0, 1, 0 )\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isTranslateHandle = true\r\n        this.type              = 'TranslateHandle'\r\n\r\n        const lineGeometry = new LineGeometry( new Vector3( 0, 0, 0 ), new Vector3( 0, 0.8, 0 ) )\r\n        const lineMaterial = new HighlightableLineMaterial( { color: _parameters.color } )\r\n        const line         = new Line( lineGeometry, lineMaterial )\r\n        this.add( line )\r\n\r\n        const coneGeometry = new ConeBufferGeometry( 0.05, 0.2, 12, 1, false )\r\n        coneGeometry.translate( 0, 0.9, 0 )\r\n        const coneMaterial = new HighlightableMaterial( { color: _parameters.color } )\r\n        const cone         = new Mesh( coneGeometry, coneMaterial )\r\n        this.add( cone )\r\n\r\n        this.direction = _parameters.direction\r\n\r\n    }\r\n\r\n    get direction () {\r\n\r\n        return this._direction\r\n\r\n    }\r\n\r\n    set direction ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Direction cannot be null ! Expect an instance of Color.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Direction cannot be undefined ! Expect an instance of Color.' ) }\r\n        if ( !( value instanceof Vector3 ) ) { throw new Error( `Direction cannot be an instance of ${value.constructor.name}. Expect an instance of Vector3.` ) }\r\n\r\n        this._direction = value\r\n\r\n        if ( value.y > 0.99999 ) {\r\n\r\n            this.quaternion.set( 0, 0, 0, 1 )\r\n\r\n        } else if ( value.y < -0.99999 ) {\r\n\r\n            this.quaternion.set( 1, 0, 0, 0 )\r\n\r\n        } else {\r\n\r\n            const axis    = new Vector3( value.z, 0, -value.x ).normalize()\r\n            const radians = Math.acos( value.y )\r\n\r\n            this.quaternion.setFromAxisAngle( axis, radians )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    update ( cameraDirection ) {\r\n\r\n        super.update( cameraDirection )\r\n\r\n        const dotProduct = this._direction.dot( cameraDirection )\r\n        if ( dotProduct >= 0 ) {\r\n            this.flipDirection()\r\n        }\r\n\r\n    }\r\n\r\n    setDirection ( direction ) {\r\n\r\n        this.direction = direction\r\n        return this\r\n\r\n    }\r\n\r\n    flipDirection () {\r\n\r\n        this.direction = this._direction.negate()\r\n\r\n    }\r\n\r\n}\r\n\r\nclass ScaleHandle extends AbstractHandle {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                color:     0xffffff,\r\n                hitbox:    new CylindricaHitbox(),\r\n                direction: new Vector3( 0, 1, 0 )\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isScaleHandle = true\r\n        this.type          = 'ScaleHandle'\r\n\r\n        const lineGeometry = new LineGeometry( new Vector3( 0, 0, 0 ), new Vector3( 0, 0.88, 0 ) )\r\n        const lineMaterial = new HighlightableLineMaterial( { color: _parameters.color } )\r\n        const line         = new Line( lineGeometry, lineMaterial )\r\n        this.add( line )\r\n\r\n        const boxGeometry = new BoxBufferGeometry( 0.12, 0.12, 0.12 )\r\n        boxGeometry.translate( 0, 0.94, 0 )\r\n        const boxMaterial = new HighlightableMaterial( { color: _parameters.color } )\r\n        const box         = new Mesh( boxGeometry, boxMaterial )\r\n        this.add( box )\r\n\r\n        this.direction = _parameters.direction\r\n\r\n    }\r\n\r\n    get direction () {\r\n\r\n        return this._direction\r\n\r\n    }\r\n\r\n    set direction ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Direction cannot be null ! Expect an instance of Color.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Direction cannot be undefined ! Expect an instance of Color.' ) }\r\n        if ( !( value instanceof Vector3 ) ) { throw new Error( `Direction cannot be an instance of ${value.constructor.name}. Expect an instance of Vector3.` ) }\r\n\r\n        this._direction = value\r\n\r\n        if ( value.y > 0.99999 ) {\r\n\r\n            this.quaternion.set( 0, 0, 0, 1 )\r\n\r\n        } else if ( value.y < -0.99999 ) {\r\n\r\n            this.quaternion.set( 1, 0, 0, 0 )\r\n\r\n        } else {\r\n\r\n            const axis    = new Vector3( value.z, 0, -value.x ).normalize()\r\n            const radians = Math.acos( value.y )\r\n\r\n            this.quaternion.setFromAxisAngle( axis, radians )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    update ( cameraDirection ) {\r\n\r\n        super.update( cameraDirection )\r\n\r\n        const dotProduct = this._direction.dot( cameraDirection )\r\n        if ( dotProduct >= 0 ) {\r\n            this.flipDirection()\r\n        }\r\n\r\n    }\r\n\r\n    setDirection ( direction ) {\r\n\r\n        this.direction = direction\r\n        return this\r\n\r\n    }\r\n\r\n    flipDirection () {\r\n\r\n        this.direction = this._direction.negate()\r\n\r\n    }\r\n\r\n}\r\n\r\nclass RotateHandle extends AbstractHandle {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{}, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isRotateHandle = true\r\n        this.type           = 'RotateHandle'\r\n\r\n    }\r\n\r\n    update ( cameraDirection ) {\r\n        super.update( cameraDirection )\r\n    }\r\n\r\n}\r\n\r\nclass PlaneHandle extends AbstractHandle {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                color:     0xffffff,\r\n                hitbox:    new PlanarHitbox(),\r\n                direction: new Vector3( 0, 1, 0 )\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isPlaneHandle = true\r\n        this.type          = 'PlaneHandle'\r\n\r\n        // Edge line\r\n        const lineBufferGeometry = new BufferGeometry()\r\n        lineBufferGeometry.addAttribute( 'position', new Float32BufferAttribute( [ 0.75, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.75, 0.0 ], 3 ) )\r\n\r\n        const lineMaterial = new HighlightableLineMaterial( {\r\n            color: _parameters.color\r\n        } )\r\n\r\n        const line = new Line( lineBufferGeometry, lineMaterial )\r\n        this.add( line )\r\n\r\n        // Plane\r\n        const planePositions      = [\r\n            0.1, 0.1, 0.0,\r\n            1.0, 0.1, 0.0,\r\n            1.0, 1.0, 0.0,\r\n            0.1, 1.0, 0.0\r\n        ]\r\n        const planeIndexes        = [\r\n            0, 1, 2,\r\n            2, 3, 0\r\n        ]\r\n        const planeBufferGeometry = new BufferGeometry()\r\n        planeBufferGeometry.addAttribute( 'position', new Float32BufferAttribute( planePositions, 3 ) )\r\n        planeBufferGeometry.setIndex( planeIndexes )\r\n\r\n        const planeMaterial = new HighlightableMaterial( {\r\n            color:       _parameters.color,\r\n            transparent: true,\r\n            opacity:     0.35\r\n        } )\r\n        const plane         = new Mesh( planeBufferGeometry, planeMaterial )\r\n        this.add( plane )\r\n\r\n        this.xAxis = new Vector3( 1, 0, 0 )\r\n        this.yAxis = new Vector3( 0, 1, 0 )\r\n        this.zAxis = new Vector3( 0, 0, 1 )\r\n\r\n        this.xDirection = new Vector3( _parameters.direction.x, 0, 0 )\r\n        this.yDirection = new Vector3( 0, _parameters.direction.y, 0 )\r\n        this.zDirection = new Vector3( 0, 0, _parameters.direction.z )\r\n        this.direction  = _parameters.direction\r\n\r\n    }\r\n\r\n    get direction () {\r\n\r\n        return this._direction\r\n\r\n    }\r\n\r\n    set direction ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Direction cannot be null ! Expect an instance of Color.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Direction cannot be undefined ! Expect an instance of Color.' ) }\r\n        if ( !( value instanceof Vector3 ) ) { throw new Error( `Direction cannot be an instance of ${value.constructor.name}. Expect an instance of Vector3.` ) }\r\n\r\n        this._direction = value\r\n\r\n    }\r\n\r\n    update ( cameraDirection ) {\r\n\r\n        super.update( cameraDirection )\r\n\r\n        // Decompose direction by main orientation\r\n        const xDirection = new Vector3( this._direction.x, 0, 0 )\r\n        const yDirection = new Vector3( 0, this._direction.y, 0 )\r\n        const zDirection = new Vector3( 0, 0, this._direction.z )\r\n        const xDot       = xDirection.dot( cameraDirection )\r\n        const yDot       = yDirection.dot( cameraDirection )\r\n        const zDot       = zDirection.dot( cameraDirection )\r\n\r\n        this.quaternion.copy( this.baseQuaternion )\r\n\r\n        // XY Plane\r\n        if ( xDot > 0 && yDot > 0 && zDot === 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 180 ) )\r\n            this.xDirection.setX( -1 )\r\n            this.yDirection.setY( -1 )\r\n            this.zDirection.setZ( 0 )\r\n\r\n        } else if ( xDot > 0 && yDot < 0 && zDot === 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 90 ) )\r\n            this.xDirection.setX( -1 )\r\n            this.yDirection.setY( 1 )\r\n            this.zDirection.setZ( 0 )\r\n\r\n        } else if ( xDot < 0 && yDot > 0 && zDot === 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 270 ) )\r\n            this.xDirection.setX( 1 )\r\n            this.yDirection.setY( -1 )\r\n            this.zDirection.setZ( 0 )\r\n\r\n        } else if ( xDot < 0 && yDot < 0 && zDot === 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 0 ) )\r\n            this.xDirection.setX( 1 )\r\n            this.yDirection.setY( 1 )\r\n            this.zDirection.setZ( 0 )\r\n\r\n        }\r\n\r\n        // XZ Plane\r\n        else if ( xDot > 0 && yDot === 0 && zDot > 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 180 ) )\r\n            this.xDirection.setX( -1 )\r\n            this.yDirection.setY( 0 )\r\n            this.zDirection.setZ( -1 )\r\n\r\n        } else if ( xDot > 0 && yDot === 0 && zDot < 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 90 ) )\r\n            this.xDirection.setX( -1 )\r\n            this.yDirection.setY( 0 )\r\n            this.zDirection.setZ( 1 )\r\n\r\n        } else if ( xDot < 0 && yDot === 0 && zDot > 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 270 ) )\r\n            this.xDirection.setX( 1 )\r\n            this.yDirection.setY( 0 )\r\n            this.zDirection.setZ( -1 )\r\n\r\n        } else if ( xDot < 0 && yDot === 0 && zDot < 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 0 ) )\r\n            this.xDirection.setX( 1 )\r\n            this.yDirection.setY( 0 )\r\n            this.zDirection.setZ( 1 )\r\n\r\n        }\r\n\r\n        // YZ Plane\r\n        else if ( xDot === 0 && yDot > 0 && zDot > 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 180 ) )\r\n            this.xDirection.setX( 0 )\r\n            this.yDirection.setY( -1 )\r\n            this.zDirection.setZ( -1 )\r\n\r\n        } else if ( xDot === 0 && yDot > 0 && zDot < 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 270 ) )\r\n            this.xDirection.setX( 0 )\r\n            this.yDirection.setY( -1 )\r\n            this.zDirection.setZ( 1 )\r\n\r\n        } else if ( xDot === 0 && yDot < 0 && zDot > 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 90 ) )\r\n            this.xDirection.setX( 0 )\r\n            this.yDirection.setY( 1 )\r\n            this.zDirection.setZ( -1 )\r\n\r\n        } else if ( xDot === 0 && yDot < 0 && zDot < 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 0 ) )\r\n            this.xDirection.setX( 0 )\r\n            this.yDirection.setY( 1 )\r\n            this.zDirection.setZ( 1 )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    setDirection ( direction ) {\r\n\r\n        this.direction = direction\r\n        return this\r\n\r\n    }\r\n\r\n    flipXDirection () {\r\n\r\n        this.xDirection.setX( -this.xDirection.x )\r\n\r\n    }\r\n\r\n    flipYDirection () {\r\n\r\n        this.yDirection.setY( -this.yDirection.y )\r\n\r\n    }\r\n\r\n    flipZDirection () {\r\n\r\n        this.zDirection.setZ( -this.zDirection.z )\r\n\r\n    }\r\n\r\n}\r\n\r\nclass LozengeHandle extends AbstractHandle {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                color:     0xffffff,\r\n                hitbox:    new LozengeHitbox(),\r\n                direction: new Vector3( 1, 1, 0 )\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isPlaneHandle = true\r\n        this.type          = 'PlaneHandle'\r\n\r\n        // Edge line\r\n        const lineBufferGeometry = new BufferGeometry()\r\n        lineBufferGeometry.addAttribute( 'position', new Float32BufferAttribute( [ 0.1, 0.75, 0.0, 1.0, 1.0, 0.0, 0.75, 0.1, 0.0 ], 3 ) )\r\n\r\n        const lineMaterial = new HighlightableLineMaterial( {\r\n            color: _parameters.color\r\n        } )\r\n\r\n        const line = new Line( lineBufferGeometry, lineMaterial )\r\n        this.add( line )\r\n\r\n        // Lozenge\r\n        const lozengePositions      = [\r\n            0.1, 0.1, 0.0,\r\n            0.75, 0.1, 0.0,\r\n            1.0, 1.0, 0.0,\r\n            0.1, 0.75, 0.0\r\n        ]\r\n        const lozengeIndexes        = [\r\n            0, 1, 2,\r\n            2, 3, 0\r\n        ]\r\n        const lozengeBufferGeometry = new BufferGeometry()\r\n        lozengeBufferGeometry.addAttribute( 'position', new Float32BufferAttribute( lozengePositions, 3 ) )\r\n        lozengeBufferGeometry.setIndex( lozengeIndexes )\r\n\r\n        const lozengeMaterial = new HighlightableMaterial( {\r\n            color:       _parameters.color,\r\n            transparent: true,\r\n            opacity:     0.35\r\n        } )\r\n        const lozenge         = new Mesh( lozengeBufferGeometry, lozengeMaterial )\r\n        this.add( lozenge )\r\n\r\n        this.direction  = _parameters.direction\r\n        this.xDirection = new Vector3( _parameters.direction.x, 0, 0 )\r\n        this.yDirection = new Vector3( 0, _parameters.direction.y, 0 )\r\n        this.zDirection = new Vector3( 0, 0, _parameters.direction.z )\r\n        this.xAxis      = new Vector3( 1, 0, 0 )\r\n        this.yAxis      = new Vector3( 0, 1, 0 )\r\n        this.zAxis      = new Vector3( 0, 0, 1 )\r\n    }\r\n\r\n    get direction () {\r\n\r\n        return this._direction\r\n\r\n    }\r\n\r\n    set direction ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Direction cannot be null ! Expect an instance of Color.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Direction cannot be undefined ! Expect an instance of Color.' ) }\r\n        if ( !( value instanceof Vector3 ) ) { throw new Error( `Direction cannot be an instance of ${value.constructor.name}. Expect an instance of Vector3.` ) }\r\n\r\n        this._direction = value\r\n\r\n    }\r\n\r\n    update ( cameraDirection ) {\r\n\r\n        super.update( cameraDirection )\r\n\r\n        const xDot = this.xDirection.dot( cameraDirection )\r\n        const yDot = this.yDirection.dot( cameraDirection )\r\n        const zDot = this.zDirection.dot( cameraDirection )\r\n\r\n        this.quaternion.copy( this.baseQuaternion )\r\n\r\n        // XY Plane\r\n        if ( xDot > 0 && yDot > 0 && zDot === 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 180 ) )\r\n\r\n        } else if ( xDot > 0 && yDot < 0 && zDot === 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 90 ) )\r\n\r\n        } else if ( xDot < 0 && yDot > 0 && zDot === 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 270 ) )\r\n\r\n        } else if ( xDot < 0 && yDot < 0 && zDot === 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 0 ) )\r\n\r\n        }\r\n\r\n        // XZ Plane\r\n        else if ( xDot > 0 && yDot === 0 && zDot > 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 180 ) )\r\n\r\n        } else if ( xDot > 0 && yDot === 0 && zDot < 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 90 ) )\r\n\r\n        } else if ( xDot < 0 && yDot === 0 && zDot > 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 270 ) )\r\n\r\n        } else if ( xDot < 0 && yDot === 0 && zDot < 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 0 ) )\r\n\r\n        }\r\n\r\n        // YZ Plane\r\n        else if ( xDot === 0 && yDot > 0 && zDot > 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 180 ) )\r\n\r\n        } else if ( xDot === 0 && yDot > 0 && zDot < 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 270 ) )\r\n\r\n        } else if ( xDot === 0 && yDot < 0 && zDot > 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 90 ) )\r\n\r\n        } else if ( xDot === 0 && yDot < 0 && zDot < 0 ) {\r\n\r\n            this.rotateOnAxis( this.zAxis, degreesToRadians( 0 ) )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    setDirection ( direction ) {\r\n\r\n        this.direction = direction\r\n        return this\r\n\r\n    }\r\n\r\n    flipXAxis () {\r\n\r\n        const tempDirection = this._direction.clone()\r\n        tempDirection.x     = -tempDirection.x\r\n\r\n        this.direction = tempDirection\r\n\r\n    }\r\n\r\n    flipYAxis () {\r\n\r\n        const tempDirection = this._direction.clone()\r\n        tempDirection.y     = -tempDirection.y\r\n\r\n        this.direction = tempDirection\r\n\r\n    }\r\n\r\n    flipZAxis () {\r\n\r\n        const tempDirection = this._direction.clone()\r\n        tempDirection.z     = -tempDirection.z\r\n\r\n        this.direction = tempDirection\r\n\r\n    }\r\n\r\n}\r\n\r\nclass OctahedricalHandle extends AbstractHandle {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                color:  0xffffff,\r\n                hitbox: new OctahedricalHitbox()\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n        this.isOmnidirectionalHandle = true\r\n        this.type                    = 'OmnidirectionalHandle'\r\n\r\n        const octahedronGeometry = new OctahedronBufferGeometry( 1, 0 )\r\n        const octahedronMaterial = new HighlightableMaterial( {\r\n            color:       _parameters.color,\r\n            transparent: true,\r\n            opacity:     0.55\r\n        } )\r\n        const octahedron         = new Mesh( octahedronGeometry, octahedronMaterial )\r\n        this.add( octahedron )\r\n\r\n        const edgesGeometry = new EdgesGeometry( octahedronGeometry )\r\n        const edgesMaterial = new HighlightableLineMaterial( {\r\n            color:     _parameters.color,\r\n            linewidth: 4\r\n        } )\r\n        const edges         = new LineSegments( edgesGeometry, edgesMaterial )\r\n        this.add( edges )\r\n\r\n    }\r\n\r\n    update ( cameraDirection ) {\r\n        super.update( cameraDirection )\r\n    }\r\n\r\n}\r\n\r\n// Gizmos\r\n\r\nclass AbstractGizmo extends Object3D {\r\n\r\n    constructor () {\r\n\r\n        super()\r\n        this.isGizmo = true\r\n        this.type    = 'AbstractGizmo'\r\n\r\n    }\r\n\r\n    init () {\r\n\r\n        this.handles = new Object3D()\r\n\r\n        this.add( this.handles )\r\n\r\n        //// PLANES\r\n        const planeGeometry = new PlaneBufferGeometry( 50, 50, 2, 2 )\r\n        const planeMaterial = new MeshBasicMaterial( {\r\n            side:    DoubleSide,\r\n            visible: false\r\n            //            transparent: true,\r\n            //            opacity:     0.1\r\n        } )\r\n        this.intersectPlane = new Mesh( planeGeometry, planeMaterial )\r\n        this.add( this.intersectPlane )\r\n\r\n        //// HANDLES\r\n\r\n        const setupGizmos = ( gizmoMap, parent ) => {\r\n\r\n            for ( let name in gizmoMap ) {\r\n\r\n                const element = gizmoMap[ name ]\r\n                if ( isNotArray( element ) ) {\r\n\r\n                    element.name        = name\r\n                    element.renderOrder = Infinity\r\n\r\n                    parent.add( element )\r\n\r\n                } else {\r\n\r\n                    for ( let i = element.length ; i-- ; ) {\r\n\r\n                        const object   = gizmoMap[ name ][ i ][ 0 ]\r\n                        const position = gizmoMap[ name ][ i ][ 1 ]\r\n                        const rotation = gizmoMap[ name ][ i ][ 2 ]\r\n                        const scale    = gizmoMap[ name ][ i ][ 3 ]\r\n                        const tag      = gizmoMap[ name ][ i ][ 4 ]\r\n\r\n                        // name and tag properties are essential for picking and updating logic.\r\n                        object.name = name\r\n                        object.tag  = tag\r\n\r\n                        // avoid being hidden by other transparent objects\r\n                        object.renderOrder = Infinity\r\n\r\n                        if ( position ) {\r\n                            object.position.set( position[ 0 ], position[ 1 ], position[ 2 ] )\r\n                        }\r\n                        if ( rotation ) {\r\n                            object.rotation.set( rotation[ 0 ], rotation[ 1 ], rotation[ 2 ] )\r\n                        }\r\n                        if ( scale ) {\r\n                            object.scale.set( scale[ 0 ], scale[ 1 ], scale[ 2 ] )\r\n                        }\r\n\r\n                        object.updateMatrix()\r\n\r\n                        const tempGeometry = object.geometry.clone()\r\n                        tempGeometry.applyMatrix( object.matrix )\r\n                        object.geometry = tempGeometry\r\n\r\n                        object.position.set( 0, 0, 0 )\r\n                        object.rotation.set( 0, 0, 0 )\r\n                        object.scale.set( 1, 1, 1 )\r\n\r\n                        parent.add( object )\r\n\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        setupGizmos( this.handleGizmos, this.handles )\r\n\r\n    }\r\n\r\n    highlight ( axis ) {\r\n\r\n        // Reset highlight for all of them\r\n        for ( let key in this.handleGizmos ) {\r\n            this.handleGizmos[ key ].highlight( false )\r\n        }\r\n\r\n        // Highlight the picked (if exist)\r\n        const currentHandle = this.handleGizmos[ axis ]\r\n        if ( currentHandle ) {\r\n            currentHandle.highlight( true )\r\n        }\r\n\r\n    }\r\n\r\n    update ( cameraPosition, cameraDirection ) {\r\n\r\n        this.traverse( ( child ) => {\r\n\r\n            if ( !child.isHandle ) { return }\r\n\r\n            child.update( cameraDirection )\r\n\r\n        } )\r\n\r\n        this.updateIntersectPlane( cameraPosition )\r\n\r\n    }\r\n\r\n    updateIntersectPlane ( cameraPosition ) {\r\n\r\n        this.intersectPlane.lookAt( cameraPosition )\r\n\r\n    }\r\n\r\n}\r\n\r\nclass TranslateGizmo extends AbstractGizmo {\r\n\r\n    constructor () {\r\n\r\n        super()\r\n        this.isTranslateGizmo = true\r\n        this.type             = 'TranslateGizmo'\r\n\r\n        this.handleGizmos = {\r\n\r\n            X: new TranslateHandle( {\r\n                color:     0xaa0000,\r\n                direction: new Vector3( 1, 0, 0 )\r\n            } ),\r\n\r\n            Y: new TranslateHandle( {\r\n                color:     0x00aa00,\r\n                direction: new Vector3( 0, 1, 0 )\r\n            } ),\r\n\r\n            Z: new TranslateHandle( {\r\n                color:     0x0000aa,\r\n                direction: new Vector3( 0, 0, 1 )\r\n            } ),\r\n\r\n            XY: new LozengeHandle( {\r\n                color:     0xaaaa00,\r\n                direction: new Vector3( 1, 1, 0 )\r\n            } ).setScale( 0.33, 0.33, 1.0 ),\r\n\r\n            YZ: new LozengeHandle( {\r\n                color:     0x00aaaa,\r\n                direction: new Vector3( 0, 1, 1 )\r\n            } ).setScale( 0.33, 0.33, 1.0 )\r\n               .setRotationFromAxisAndAngle( new Vector3( 0, 1, 0 ), degreesToRadians( -90 ) ),\r\n\r\n            XZ: new LozengeHandle( {\r\n                color:     0xaa00aa,\r\n                direction: new Vector3( 1, 0, 1 )\r\n            } ).setScale( 0.33, 0.33, 1.0 )\r\n               .setRotationFromAxisAndAngle( new Vector3( 1, 0, 0 ), degreesToRadians( 90 ) ),\r\n\r\n            XYZ: new OctahedricalHandle( {\r\n                color: 0xaaaaaa\r\n            } ).setScale( 0.15, 0.15, 0.15 )\r\n\r\n        }\r\n\r\n        this.init()\r\n\r\n    }\r\n\r\n}\r\n\r\nclass RotateGizmo extends AbstractGizmo {\r\n\r\n    constructor () {\r\n\r\n        super()\r\n        this.isRotateGizmo = true\r\n        this.type          = 'RotateGizmo'\r\n\r\n        const CircleGeometry = ( radius, facing, arc ) => {\r\n\r\n            const geometry = new BufferGeometry()\r\n            let vertices   = []\r\n            arc            = arc ? arc : 1\r\n\r\n            for ( let i = 0 ; i <= 64 * arc ; ++i ) {\r\n\r\n                if ( facing === 'x' ) {\r\n                    vertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius )\r\n                }\r\n                if ( facing === 'y' ) {\r\n                    vertices.push( Math.cos( i / 32 * Math.PI ) * radius, 0, Math.sin( i / 32 * Math.PI ) * radius )\r\n                }\r\n                if ( facing === 'z' ) {\r\n                    vertices.push( Math.sin( i / 32 * Math.PI ) * radius, Math.cos( i / 32 * Math.PI ) * radius, 0 )\r\n                }\r\n\r\n            }\r\n\r\n            geometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) )\r\n            return geometry\r\n\r\n        }\r\n\r\n        this.handleGizmos = {\r\n\r\n            X: [\r\n                [ new Line( new CircleGeometry( 1, 'x', 0.5 ), new HighlightableLineMaterial( { color: 0xff0000 } ) ) ],\r\n                [ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), new HighlightableMaterial( { color: 0xff0000 } ) ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ] ]\r\n            ],\r\n\r\n            Y: [\r\n                [ new Line( new CircleGeometry( 1, 'y', 0.5 ), new HighlightableLineMaterial( { color: 0x00ff00 } ) ) ],\r\n                [ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), new HighlightableMaterial( { color: 0x00ff00 } ) ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ] ]\r\n            ],\r\n\r\n            Z: [\r\n                [ new Line( new CircleGeometry( 1, 'z', 0.5 ), new HighlightableLineMaterial( { color: 0x0000ff } ) ) ],\r\n                [ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), new HighlightableMaterial( { color: 0x0000ff } ) ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ] ]\r\n            ],\r\n\r\n            E: [\r\n                [ new Line( new CircleGeometry( 1.25, 'z', 1 ), new HighlightableLineMaterial( { color: 0xcccc00 } ) ) ]\r\n            ],\r\n\r\n            XYZ: [\r\n                [ new Line( new CircleGeometry( 1, 'z', 1 ), new HighlightableLineMaterial( { color: 0x787878 } ) ) ]\r\n            ]\r\n\r\n        }\r\n\r\n        this.pickerGizmos = {\r\n\r\n            X: [\r\n                [ new TorusHitbox(), [ 0, 0, 0 ], [ 0, -Math.PI / 2, -Math.PI / 2 ] ]\r\n            ],\r\n\r\n            Y: [\r\n                [ new TorusHitbox(), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ] ]\r\n            ],\r\n\r\n            Z: [\r\n                [ new TorusHitbox(), [ 0, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]\r\n            ],\r\n\r\n            E: [\r\n                [\r\n                    new TorusHitbox( {\r\n                        radius:          1.25,\r\n                        tube:            0.12,\r\n                        radialSegments:  2,\r\n                        tubularSegments: 24\r\n                    } )\r\n                ]\r\n            ],\r\n\r\n            XYZ: [\r\n                [ new TorusHitbox() ]\r\n            ]\r\n\r\n        }\r\n\r\n        //        this.pickerGizmos.XYZ[ 0 ][ 0 ].visible = false // disable XYZ picker gizmo\r\n\r\n        this.init()\r\n\r\n    }\r\n\r\n    /*\r\n     update ( rotation, eye2 ) {\r\n\r\n     super.update( rotation, eye2 )\r\n\r\n     const tempMatrix     = new Matrix4()\r\n     const worldRotation  = new Euler( 0, 0, 1 )\r\n     const tempQuaternion = new Quaternion()\r\n     const unitX          = new Vector3( 1, 0, 0 )\r\n     const unitY          = new Vector3( 0, 1, 0 )\r\n     const unitZ          = new Vector3( 0, 0, 1 )\r\n     const quaternionX    = new Quaternion()\r\n     const quaternionY    = new Quaternion()\r\n     const quaternionZ    = new Quaternion()\r\n     const eye            = eye2.clone()\r\n\r\n     worldRotation.copy( this.planes[ 'XY' ].rotation )\r\n     tempQuaternion.setFromEuler( worldRotation )\r\n\r\n     tempMatrix.makeRotationFromQuaternion( tempQuaternion ).getInverse( tempMatrix )\r\n     eye.applyMatrix4( tempMatrix )\r\n\r\n     this.traverse( child => {\r\n\r\n     tempQuaternion.setFromEuler( worldRotation )\r\n\r\n     if ( child.name === 'X' ) {\r\n\r\n     quaternionX.setFromAxisAngle( unitX, Math.atan2( -eye.y, eye.z ) )\r\n     tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionX )\r\n     child.quaternion.copy( tempQuaternion )\r\n\r\n     }\r\n\r\n     if ( child.name === 'Y' ) {\r\n\r\n     quaternionY.setFromAxisAngle( unitY, Math.atan2( eye.x, eye.z ) )\r\n     tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionY )\r\n     child.quaternion.copy( tempQuaternion )\r\n\r\n     }\r\n\r\n     if ( child.name === 'Z' ) {\r\n\r\n     quaternionZ.setFromAxisAngle( unitZ, Math.atan2( eye.y, eye.x ) )\r\n     tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionZ )\r\n     child.quaternion.copy( tempQuaternion )\r\n\r\n     }\r\n\r\n     } )\r\n\r\n     }\r\n     */\r\n\r\n}\r\n\r\nclass ScaleGizmo extends AbstractGizmo {\r\n\r\n    constructor () {\r\n\r\n        super()\r\n        this.isScaleGizmo = true\r\n        this.type         = 'ScaleGizmo'\r\n\r\n        this.handleGizmos = {\r\n\r\n            XYZ: new OctahedricalHandle( {\r\n                color: 0xaaaaaa\r\n            } ).setScale( 0.15, 0.15, 0.15 ),\r\n\r\n            XY: new PlaneHandle( {\r\n                color:     0xaaaa00,\r\n                direction: new Vector3( 1, 1, 0 )\r\n            } ).setScale( 0.33, 0.33, 1.0 ),\r\n\r\n            YZ: new PlaneHandle( {\r\n                color:     0x00aaaa,\r\n                direction: new Vector3( 0, 1, 1 )\r\n            } ).setScale( 0.33, 0.33, 1.0 )\r\n               .setRotationFromAxisAndAngle( new Vector3( 0, 1, 0 ), degreesToRadians( -90 ) ),\r\n\r\n            XZ: new PlaneHandle( {\r\n                color:     0xaa00aa,\r\n                direction: new Vector3( 1, 0, 1 )\r\n            } ).setScale( 0.33, 0.33, 1.0 )\r\n               .setRotationFromAxisAndAngle( new Vector3( 1, 0, 0 ), degreesToRadians( 90 ) ),\r\n\r\n            X: new ScaleHandle( {\r\n                color:     0xaa0000,\r\n                direction: new Vector3( 1, 0, 0 )\r\n            } ),\r\n\r\n            Y: new ScaleHandle( {\r\n                color:     0x00aa00,\r\n                direction: new Vector3( 0, 1, 0 )\r\n            } ),\r\n\r\n            Z: new ScaleHandle( {\r\n                color:     0x0000aa,\r\n                direction: new Vector3( 0, 0, 1 )\r\n            } )\r\n\r\n        }\r\n\r\n        this.init()\r\n\r\n    }\r\n\r\n}\r\n\r\n// Controller\r\nconst ClippingModes = toEnum( {\r\n    None:      0,\r\n    Translate: 1,\r\n    Rotate:    2,\r\n    Scale:     3\r\n} )\r\n\r\nclass ClippingControls extends Object3D {\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                camera:        null,\r\n                domElement:    window,\r\n                mode:          ClippingModes.None,\r\n                objectsToClip: new Object3D()\r\n            }, ...parameters\r\n        }\r\n\r\n        super()\r\n\r\n        // Need to be defined before domElement to make correct binding events\r\n        this._handlers                 = {\r\n            onMouseEnter:  this._onMouseEnter.bind( this ),\r\n            onMouseLeave:  this._onMouseLeave.bind( this ),\r\n            onMouseDown:   this._onMouseDown.bind( this ),\r\n            onMouseMove:   this._onMouseMove.bind( this ),\r\n            onMouseWheel:  this._onMouseWheel.bind( this ),\r\n            onMouseUp:     this._onMouseUp.bind( this ),\r\n            onDblClick:    this._onDblClick.bind( this ),\r\n            onTouchStart:  this._onTouchStart.bind( this ),\r\n            onTouchEnd:    this._onTouchEnd.bind( this ),\r\n            onTouchCancel: this._onTouchCancel.bind( this ),\r\n            onTouchLeave:  this._onTouchLeave.bind( this ),\r\n            onTouchMove:   this._onTouchMove.bind( this ),\r\n            onKeyDown:     this._onKeyDown.bind( this ),\r\n            onKeyUp:       this._onKeyUp.bind( this )\r\n        }\r\n        // Could/Should(?) use the objectsToClip boundingbox if exist ! [only in case we are sure that boundingbox (is/must be) implemented for each object3D.]\r\n        this._objectsToClipBoundingBox = new Box3()\r\n\r\n        this._clippingBox = new ClippingBox()\r\n        this.add( this._clippingBox )\r\n\r\n        this.camera          = _parameters.camera\r\n        this.domElement      = _parameters.domElement\r\n        this.mode            = _parameters.mode\r\n        this.objectsToClip   = _parameters.objectsToClip\r\n        this.translationSnap = 0.1\r\n        this.scaleSnap       = 0.1\r\n        this.rotationSnap    = 0.1\r\n\r\n        this.enabled = false // Should be true by default\r\n\r\n        this.size = 1\r\n\r\n        this._dragging          = false\r\n        this._firstPoint        = new Vector3()\r\n        this._secondPoint       = new Vector3()\r\n        this._mouseDisplacement = new Vector3()\r\n        this._offset            = new Vector3()\r\n        this._raycaster         = new Raycaster()\r\n        this._pointerVector     = new Vector2()\r\n        this._directionToMouse  = new Vector3()\r\n        this._cameraPosition    = new Vector3()\r\n        this._cameraDirection   = new Vector3()\r\n        this._worldPosition     = new Vector3()\r\n        this._worldRotation     = new Euler()\r\n\r\n        this._gizmos = {\r\n            //            'None':      null,\r\n            'Translate': new TranslateGizmo(),\r\n            'Scale':     new ScaleGizmo()\r\n            //            'Rotate':    new RotateGizmo(),\r\n        }\r\n        for ( let mode in this._gizmos ) {\r\n            this.add( this._gizmos[ mode ] )\r\n        }\r\n        this._currentGizmo  = null\r\n        this._currentHandle = null\r\n\r\n        this._events = {\r\n            change:       { type: 'change' },\r\n            mouseEnter:   { type: 'mouseEnter' },\r\n            mouseLeave:   { type: 'mouseLeave' },\r\n            mouseDown:    { type: 'mouseDown' },\r\n            mouseUp:      { type: 'mouseUp' },\r\n            objectChange: { type: 'objectChange' }\r\n        }\r\n\r\n        // The actions map about input events\r\n        this.actionsMap = {\r\n            setMode:   {\r\n                translate: [ Keys.T.value ],\r\n                rotate:    [ Keys.R.value ],\r\n                scale:     [ Keys.S.value ]\r\n            },\r\n            translate: {\r\n                front: [ Keys.Z.value, Keys.UP_ARROW.value ],\r\n                back:  [ Keys.S.value, Keys.DOWN_ARROW.value ],\r\n                up:    [ Keys.A.value, Keys.PAGE_UP.value ],\r\n                down:  [ Keys.E.value, Keys.PAGE_DOWN.value ],\r\n                left:  [ Keys.Q.value, Keys.LEFT_ARROW.value ],\r\n                right: [ Keys.D.value, Keys.RIGHT_ARROW.value ]\r\n            },\r\n            scale:     {\r\n                widthPlus:   [ Keys.LEFT_ARROW.value ],\r\n                widthMinus:  [ Keys.RIGHT_ARROW.value ],\r\n                heightPlus:  [ Keys.PAGE_UP.value ],\r\n                heightMinus: [ Keys.PAGE_DOWN.value ],\r\n                depthPlus:   [ Keys.UP_ARROW.value ],\r\n                depthMinus:  [ Keys.DOWN_ARROW.value ]\r\n            },\r\n            rotate:    {\r\n                xAxis: [ Keys.X.value ],\r\n                yAxis: [ Keys.Y.value ],\r\n                zAxis: [ Keys.Z.value ]\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    get objectsToClip () {\r\n        return this._objectsToClip\r\n    }\r\n\r\n    set objectsToClip ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Objects to clip cannot be null ! Expect an instance of Object3D' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Objects to clip cannot be undefined ! Expect an instance of Object3D' ) }\r\n        if ( !( value instanceof Object3D ) ) { throw new Error( `Objects to clip cannot be an instance of ${value.constructor.name}. Expect an instance of Object3D.` ) }\r\n\r\n        this._objectsToClip = value\r\n\r\n        const size = new Vector3()\r\n        this._objectsToClipBoundingBox\r\n            .makeEmpty()\r\n            .expandByObject( value )\r\n            .getSize( size )\r\n\r\n        const x = Math.round( size.x ) || 50\r\n        const y = Math.round( size.y ) || 22\r\n        const z = Math.round( size.z ) || 70\r\n        this.scale.set( x, y, z )\r\n        //        this.scale.set( 50, 22, 70 )\r\n\r\n        this._clippingBox.update()\r\n\r\n    }\r\n\r\n    get camera () {\r\n        return this._camera\r\n    }\r\n\r\n    set camera ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Camera cannot be null ! Expect an instance of Camera' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Camera cannot be undefined ! Expect an instance of Camera' ) }\r\n        if ( !( value instanceof Camera ) ) { throw new Error( `Camera cannot be an instance of ${value.constructor.name}. Expect an instance of Camera.` ) }\r\n\r\n        this._camera = value\r\n\r\n    }\r\n\r\n    get domElement () {\r\n        return this._domElement\r\n    }\r\n\r\n    set domElement ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'DomElement cannot be null ! Expect an instance of Window, HTMLDocument, HTMLDivElement or HTMLCanvasElement.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'DomElement cannot be undefined ! Expect an instance of Window, HTMLDocument, HTMLDivElement or HTMLCanvasElement.' ) }\r\n        if ( !( ( value instanceof Window ) || ( value instanceof HTMLDocument ) || ( value instanceof HTMLDivElement ) || ( value instanceof HTMLCanvasElement ) ) ) { throw new Error( `Target cannot be an instance of ${value.constructor.name}. Expect an instance of Window, HTMLDocument, HTMLDivElement or HTMLCanvasElement.` ) }\r\n\r\n        // Clear previous element\r\n        if ( this._domElement ) {\r\n            this._domElement.removeEventListener( 'mouseenter', this._handlers.onMouseEnter, false )\r\n            this._domElement.removeEventListener( 'mouseleave', this._handlers.onMouseLeave, false )\r\n            this.dispose()\r\n        }\r\n\r\n        this._domElement = value\r\n        this._domElement.addEventListener( 'mouseenter', this._handlers.onMouseEnter, false )\r\n        this._domElement.addEventListener( 'mouseleave', this._handlers.onMouseLeave, false )\r\n        this.impose()\r\n\r\n    }\r\n\r\n    get mode () {\r\n        return this._mode\r\n    }\r\n\r\n    set mode ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new Error( 'Mode cannot be null ! Expect a value from ClippingModes enum.' ) }\r\n        if ( isUndefined( value ) ) { throw new Error( 'Mode cannot be undefined ! Expect a value from ClippingModes enum.' ) }\r\n        if ( !( value instanceof ClippingModes ) ) { throw new Error( `Mode cannot be an instance of ${value.constructor.name}. Expect a value from TClippingModes enum.` ) }\r\n\r\n        this._mode = value\r\n\r\n        // Reset gizmos visibility\r\n        for ( let mode in this._gizmos ) {\r\n            this._gizmos[ mode ].visible = false\r\n        }\r\n\r\n        if ( this._mode === ClippingModes.None ) {\r\n\r\n            this._currentGizmo = null\r\n\r\n        } else {\r\n\r\n            this._currentGizmo         = this._gizmos[ this._mode.name ]\r\n            this._currentGizmo.visible = true\r\n\r\n        }\r\n\r\n    }\r\n\r\n    setCamera ( value ) {\r\n\r\n        this.camera = value\r\n        return this\r\n\r\n    }\r\n\r\n    setDomElement ( value ) {\r\n\r\n        this.domElement = value\r\n        return this\r\n\r\n    }\r\n\r\n    setMode ( value ) {\r\n\r\n        this.mode = value\r\n        return this\r\n\r\n    }\r\n\r\n    setObjectsToClip ( objects ) {\r\n\r\n        this.objectsToClip = objects\r\n        return this\r\n\r\n    }\r\n\r\n    impose () {\r\n\r\n        this._domElement.addEventListener( 'keydown', this._handlers.onKeyDown, false )\r\n        this._domElement.addEventListener( 'keyup', this._handlers.onKeyUp, false )\r\n\r\n        this._domElement.addEventListener( 'dblclick', this._handlers.onDblClick, false )\r\n        this._domElement.addEventListener( 'mousedown', this._handlers.onMouseDown, false )\r\n        this._domElement.addEventListener( 'mousemove', this._handlers.onMouseMove, false )\r\n        this._domElement.addEventListener( 'mouseup', this._handlers.onMouseUp, false )\r\n        this._domElement.addEventListener( 'wheel', this._handlers.onMouseWheel, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n\r\n        this._domElement.addEventListener( 'touchcancel', this._handlers.onTouchCancel, false )\r\n        this._domElement.addEventListener( 'touchend', this._handlers.onTouchEnd, false )\r\n        this._domElement.addEventListener( 'touchleave', this._handlers.onTouchLeave, false )\r\n        this._domElement.addEventListener( 'touchmove', this._handlers.onTouchMove, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n        this._domElement.addEventListener( 'touchstart', this._handlers.onTouchStart, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n\r\n        this.dispatchEvent( { type: 'impose' } )\r\n\r\n    }\r\n\r\n    dispose () {\r\n\r\n        this._domElement.removeEventListener( 'keydown', this._handlers.onKeyDown, false )\r\n        this._domElement.removeEventListener( 'keyup', this._handlers.onKeyUp, false )\r\n\r\n        this._domElement.removeEventListener( 'dblclick', this._handlers.onDblClick, false )\r\n        this._domElement.removeEventListener( 'mousedown', this._handlers.onMouseDown, false )\r\n        this._domElement.removeEventListener( 'mousemove', this._handlers.onMouseMove, false )\r\n        this._domElement.removeEventListener( 'mouseup', this._handlers.onMouseUp, false )\r\n        this._domElement.removeEventListener( 'wheel', this._handlers.onMouseWheel, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n\r\n        this._domElement.removeEventListener( 'touchcancel', this._handlers.onTouchCancel, false )\r\n        this._domElement.removeEventListener( 'touchend', this._handlers.onTouchEnd, false )\r\n        this._domElement.removeEventListener( 'touchleave', this._handlers.onTouchLeave, false )\r\n        this._domElement.removeEventListener( 'touchmove', this._handlers.onTouchMove, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n        this._domElement.removeEventListener( 'touchstart', this._handlers.onTouchStart, {\r\n            capture: true,\r\n            once:    false,\r\n            passive: false\r\n        } )\r\n\r\n        this.dispatchEvent( { type: 'dispose' } )\r\n\r\n    }\r\n\r\n    setTranslationSnap ( translationSnap ) {\r\n        this.translationSnap = translationSnap\r\n    }\r\n\r\n    setRotationSnap ( rotationSnap ) {\r\n        this.rotationSnap = rotationSnap\r\n    }\r\n\r\n    enable () {\r\n\r\n        this.visible = true\r\n        this.enabled = true\r\n        this.updateClipping()\r\n\r\n    }\r\n\r\n    disable () {\r\n\r\n        this.visible = false\r\n        this.enabled = false\r\n        this.updateClipping()\r\n\r\n    }\r\n\r\n    updateClipping () {\r\n\r\n        if ( isNotDefined( this._objectsToClip ) ) { return }\r\n\r\n        this._clippingBox.update()\r\n        this._clippingBox.applyClippingTo( this.enabled, this._objectsToClip )\r\n\r\n    }\r\n\r\n    update () {\r\n\r\n        if ( !this.enabled ) { return }\r\n        if ( this._mode === ClippingModes.None ) { return }\r\n        if ( isNotDefined( this._currentGizmo ) ) { return }\r\n\r\n        this._camera.getWorldPosition( this._cameraPosition )\r\n        this._camera.getWorldDirection( this._cameraDirection )\r\n        this._currentGizmo.update( this._cameraPosition, this._cameraDirection )\r\n\r\n    }\r\n\r\n    /// Handlers\r\n    _consumeEvent ( event ) {\r\n\r\n        if ( !event.cancelable ) {\r\n            return\r\n        }\r\n\r\n        event.stopImmediatePropagation()\r\n\r\n    }\r\n\r\n    // Keyboard\r\n    _onKeyDown ( keyEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        keyEvent.preventDefault()\r\n\r\n        const actionMap   = this.actionsMap\r\n        const key         = keyEvent.keyCode\r\n        const altActive   = keyEvent.altKey\r\n        const ctrlActive  = keyEvent.ctrlKey\r\n        const metaActive  = keyEvent.metaKey\r\n        const shiftActive = keyEvent.shiftKey\r\n\r\n        if ( altActive ) {\r\n\r\n        } else if ( ctrlActive ) {\r\n\r\n            switch ( this._mode ) {\r\n\r\n                case ClippingModes.Translate:\r\n\r\n                    if ( actionMap.translate.front.includes( key ) ) {\r\n\r\n                        this._translateZ( this.translationSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.translate.back.includes( key ) ) {\r\n\r\n                        this._translateZ( -this.translationSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.translate.right.includes( key ) ) {\r\n\r\n                        this._translateX( this.translationSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.translate.left.includes( key ) ) {\r\n\r\n                        this._translateX( -this.translationSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.translate.up.includes( key ) ) {\r\n\r\n                        this._translateY( this.translationSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.translate.down.includes( key ) ) {\r\n\r\n                        this._translateY( -this.translationSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    }\r\n\r\n                    break\r\n\r\n                case ClippingModes.Rotate:\r\n\r\n                    break\r\n\r\n                case ClippingModes.Scale:\r\n\r\n                    if ( actionMap.scale.depthPlus.includes( key ) ) {\r\n\r\n                        this._scaleZ( this.scaleSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.scale.depthMinus.includes( key ) ) {\r\n\r\n                        this._scaleZ( -this.scaleSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.scale.widthPlus.includes( key ) ) {\r\n\r\n                        this._scaleX( this.scaleSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.scale.widthMinus.includes( key ) ) {\r\n\r\n                        this._scaleX( -this.scaleSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.scale.heightPlus.includes( key ) ) {\r\n\r\n                        this._scaleY( this.scaleSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    } else if ( actionMap.scale.heightMinus.includes( key ) ) {\r\n\r\n                        this._scaleY( -this.scaleSnap )\r\n                        this.updateClipping()\r\n                        this._consumeEvent( keyEvent )\r\n                        this.dispatchEvent( this._events.objectChange )\r\n\r\n                    }\r\n\r\n                    break\r\n\r\n                default:\r\n                    break\r\n\r\n            }\r\n\r\n        } else if ( metaActive ) {\r\n        } else if ( shiftActive ) {\r\n        } else if ( actionMap.setMode.translate.includes( key ) ) {\r\n\r\n            this.setMode( ClippingModes.Translate )\r\n            this.updateClipping()\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.setMode.rotate.includes( key ) ) {\r\n\r\n            this.setMode( ClippingModes.Rotate )\r\n            this.updateClipping()\r\n            this._consumeEvent( keyEvent )\r\n\r\n        } else if ( actionMap.setMode.scale.includes( key ) ) {\r\n\r\n            this.setMode( ClippingModes.Scale )\r\n            this.updateClipping()\r\n            this._consumeEvent( keyEvent )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    _onKeyUp ( keyEvent ) {\r\n\r\n        if ( !this.enabled || keyEvent.defaultPrevented ) { return }\r\n        keyEvent.preventDefault()\r\n\r\n        // Todo...\r\n\r\n    }\r\n\r\n    // Mouse\r\n    _onDblClick ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        if ( this._mode === ClippingModes.None ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        // Todo...\r\n\r\n    }\r\n\r\n    _onMouseDown ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        if ( this._mode === ClippingModes.None ) { return }\r\n        if ( mouseEvent.button !== Mouse.LEFT.value ) { return }\r\n        if ( isNotDefined( this._currentHandle ) ) { return }\r\n\r\n        mouseEvent.preventDefault()\r\n\r\n        this._dragging = true\r\n\r\n        // Set the current plane to intersect with mouse\r\n        // Add first reference to mouse position for next usage under mouse move\r\n        const planeIntersect = this.intersectObjects( mouseEvent, [ this._currentGizmo.intersectPlane ] )\r\n        if ( planeIntersect ) {\r\n            this._firstPoint = planeIntersect.point\r\n        }\r\n\r\n        this._consumeEvent( mouseEvent )\r\n        this.dispatchEvent( this._events.mouseDown )\r\n\r\n    }\r\n\r\n    _onMouseEnter ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        if ( this._mode === ClippingModes.None ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        this.impose()\r\n        if ( mouseEvent.target.constructor !== HTMLDocument ) {\r\n            this._domElement.focus()\r\n        }\r\n\r\n    }\r\n\r\n    _onMouseLeave ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        if ( this._mode === ClippingModes.None ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        this._dragging = false\r\n\r\n        if ( mouseEvent.target.constructor !== HTMLDocument ) {\r\n            this._domElement.blur()\r\n        }\r\n        this.dispose()\r\n\r\n    }\r\n\r\n    _onMouseMove ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        if ( this._mode === ClippingModes.None ) { return }\r\n\r\n        mouseEvent.preventDefault()\r\n\r\n        // Check for hovering or not\r\n        if ( this._dragging === false ) {\r\n\r\n            // Check mouseIn\r\n            const intersect = this.intersectObjects( mouseEvent, this._currentGizmo.handles.children )\r\n            if ( intersect ) {\r\n\r\n                const handle = intersect.object\r\n\r\n                // Check if a previous handle is already selected\r\n                if ( this._currentHandle && handle !== this._currentHandle ) {\r\n                    this._currentHandle.highlight( false )\r\n                    this.dispatchEvent( this._events.mouseLeave )\r\n                }\r\n\r\n                this._currentHandle = handle\r\n                this._currentHandle.highlight( true )\r\n                this.dispatchEvent( this._events.mouseEnter )\r\n\r\n                this._consumeEvent( mouseEvent )\r\n\r\n            } else if ( isDefined( this._currentHandle ) ) {\r\n\r\n                this._currentHandle.highlight( false )\r\n                this._currentHandle = null\r\n                this.dispatchEvent( this._events.mouseLeave )\r\n\r\n            }\r\n\r\n        } else {\r\n\r\n            const currentHandle     = this._currentHandle\r\n            const currentHandleName = currentHandle.name\r\n\r\n            const planeIntersect = this.intersectObjects( mouseEvent, [ this._currentGizmo.intersectPlane ] )\r\n            if ( planeIntersect ) {\r\n\r\n                this._secondPoint = planeIntersect.point\r\n\r\n            }\r\n\r\n            // Update the mouse displacement in world coordinates\r\n            this._mouseDisplacement.subVectors( this._secondPoint, this._firstPoint )\r\n            this._firstPoint.copy( this._secondPoint )\r\n\r\n            // Apply change\r\n            switch ( this._mode ) {\r\n\r\n                case ClippingModes.Translate:\r\n\r\n                    if ( currentHandleName === 'X' ) {\r\n\r\n                        this._offset.set( 1, 0, 0 )\r\n\r\n                    } else if ( currentHandleName === 'Y' ) {\r\n\r\n                        this._offset.set( 0, 1, 0 )\r\n\r\n                    } else if ( currentHandleName === 'Z' ) {\r\n\r\n                        this._offset.set( 0, 0, 1 )\r\n\r\n                    } else if ( currentHandleName === 'XY' ) {\r\n\r\n                        this._offset.set( 1, 1, 0 )\r\n\r\n                    } else if ( currentHandleName === 'YZ' ) {\r\n\r\n                        this._offset.set( 0, 1, 1 )\r\n\r\n                    } else if ( currentHandleName === 'XZ' ) {\r\n\r\n                        this._offset.set( 1, 0, 1 )\r\n\r\n                    } else if ( currentHandleName === 'XYZ' ) {\r\n\r\n                        this._offset.set( 1, 1, 1 )\r\n\r\n                    }\r\n\r\n                    this._offset.multiply( this._mouseDisplacement )\r\n                    this._translate( this._offset )\r\n                    break\r\n\r\n                case ClippingModes.Rotate:\r\n\r\n                    if ( currentHandle.isRotateHandle ) {\r\n\r\n                    } else if ( currentHandle.isPlaneHandle ) {\r\n\r\n                    } else if ( currentHandle.isOmnidirectionalHandle ) {\r\n\r\n                    }\r\n\r\n                    break\r\n\r\n                case ClippingModes.Scale:\r\n\r\n                    if ( currentHandle.isScaleHandle ) {\r\n\r\n                        this._offset\r\n                            .copy( this._currentHandle.direction )\r\n                            .multiply( this._mouseDisplacement )\r\n\r\n                    } else if ( currentHandle.isPlaneHandle ) {\r\n\r\n                        const xDot = this._currentHandle.xDirection.dot( this._mouseDisplacement )\r\n                        if ( xDot > 0 ) {\r\n                            this._offset.setX( Math.abs( this._mouseDisplacement.x ) )\r\n                        } else if ( xDot < 0 ) {\r\n                            this._offset.setX( -Math.abs( this._mouseDisplacement.x ) )\r\n                        } else {\r\n                            this._offset.setX( 0 )\r\n                        }\r\n\r\n                        const yDot = this._currentHandle.yDirection.dot( this._mouseDisplacement )\r\n                        if ( yDot > 0 ) {\r\n                            this._offset.setY( Math.abs( this._mouseDisplacement.y ) )\r\n                        } else if ( yDot < 0 ) {\r\n                            this._offset.setY( -Math.abs( this._mouseDisplacement.y ) )\r\n                        } else {\r\n                            this._offset.setY( 0 )\r\n                        }\r\n\r\n                        const zDot = this._currentHandle.zDirection.dot( this._mouseDisplacement )\r\n                        if ( zDot > 0 ) {\r\n                            this._offset.setZ( Math.abs( this._mouseDisplacement.z ) )\r\n                        } else if ( zDot < 0 ) {\r\n                            this._offset.setZ( -Math.abs( this._mouseDisplacement.z ) )\r\n                        } else {\r\n                            this._offset.setZ( 0 )\r\n                        }\r\n\r\n                    } else if ( currentHandle.isOmnidirectionalHandle ) {\r\n\r\n                        this.getWorldPosition( this._worldPosition )\r\n                        this._directionToMouse.subVectors( this._firstPoint, this._worldPosition )\r\n                        const worldDot = this._directionToMouse.dot( this._mouseDisplacement )\r\n                        const length   = ( worldDot > 0 ) ? this._mouseDisplacement.length() : -this._mouseDisplacement.length()\r\n                        this._offset.set( length, length, length )\r\n\r\n                    }\r\n\r\n                    this._scale( this._offset )\r\n                    break\r\n\r\n                default:\r\n                    throw new RangeError( `Invalid switch parameter: ${this._mode}` )\r\n                    break\r\n\r\n            }\r\n\r\n            this.updateClipping()\r\n            this._consumeEvent( mouseEvent )\r\n            this.dispatchEvent( this._events.objectChange )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    _onMouseUp ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        if ( this._mode === ClippingModes.None ) { return }\r\n        if ( event.button !== Mouse.LEFT.value ) { return }\r\n\r\n        mouseEvent.preventDefault()\r\n        this._consumeEvent( mouseEvent )\r\n\r\n        this._dragging = false\r\n        this.dispatchEvent( this._events.mouseUp )\r\n\r\n        // Check mouseIn\r\n        const intersect = this.intersectObjects( mouseEvent, this._currentGizmo.handles.children )\r\n        if ( intersect ) {\r\n\r\n            const handle = intersect.object\r\n\r\n            this._currentHandle = handle\r\n            this._currentHandle.highlight( true )\r\n\r\n            this._consumeEvent( mouseEvent )\r\n            this.dispatchEvent( this._events.mouseEnter )\r\n\r\n        } else if ( isDefined( this._currentHandle ) ) {\r\n\r\n            this._currentHandle.highlight( false )\r\n            this._currentHandle = null\r\n\r\n            this.dispatchEvent( this._events.mouseLeave )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    _onMouseWheel ( mouseEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        mouseEvent.preventDefault()\r\n\r\n        // Todo...\r\n\r\n    }\r\n\r\n    // Touche\r\n    _onTouchCancel ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        // Todo...\r\n\r\n    }\r\n\r\n    _onTouchEnd ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        // Todo...\r\n\r\n    }\r\n\r\n    _onTouchLeave ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        // Todo...\r\n\r\n    }\r\n\r\n    _onTouchMove ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        // Todo...\r\n\r\n    }\r\n\r\n    _onTouchStart ( touchEvent ) {\r\n\r\n        if ( !this.enabled ) { return }\r\n        touchEvent.preventDefault()\r\n\r\n        // Todo...\r\n\r\n    }\r\n\r\n    /// Utils\r\n    getActiveHandle ( pointer ) {\r\n\r\n    }\r\n\r\n    intersectObjects ( pointer, objects ) {\r\n\r\n        // calculate mouse position in normalized device coordinates\r\n        // (-1 to +1) for both components\r\n        /*\r\n         const mousePositionX  = mouseEvent.layerX || mouseEvent.offsetX || 1\r\n         const mousePositionY  = mouseEvent.layerY || mouseEvent.offsetY || 1\r\n         const containerWidth  = this._domElement.offsetWidth\r\n         const containerHeight = this._domElement.offsetHeight\r\n         const x               = ( mousePositionX / containerWidth ) * 2 - 1\r\n         const y               = -( mousePositionY / containerHeight ) * 2 + 1\r\n         */\r\n\r\n        const clientRect = this._domElement.getBoundingClientRect()\r\n        const x          = ( ( ( pointer.clientX - clientRect.left ) / clientRect.width ) * 2 ) - 1\r\n        const y          = ( -( ( pointer.clientY - clientRect.top ) / clientRect.height ) * 2 ) + 1\r\n\r\n        this._pointerVector.set( x, y )\r\n        this._raycaster.setFromCamera( this._pointerVector, this._camera )\r\n\r\n        const intersections = this._raycaster.intersectObjects( objects, false )\r\n        return intersections[ 0 ] ? intersections[ 0 ] : null\r\n\r\n    }\r\n\r\n    // Methods\r\n\r\n    // Moving\r\n    _translate ( displacement ) {\r\n\r\n        this.position.add( displacement )\r\n\r\n    }\r\n\r\n    _translateX ( deltaX ) {\r\n\r\n        this.position.setX( this.position.x + deltaX )\r\n\r\n    }\r\n\r\n    _translateY ( deltaY ) {\r\n\r\n        this.position.setY( this.position.y + deltaY )\r\n\r\n    }\r\n\r\n    _translateZ ( deltaZ ) {\r\n\r\n        this.position.setZ( this.position.z + deltaZ )\r\n\r\n    }\r\n\r\n    _translateXY ( deltaX, deltaY ) {\r\n\r\n        this.position.setX( this.position.x + deltaX )\r\n        this.position.setY( this.position.y + deltaY )\r\n\r\n    }\r\n\r\n    _translateXZ ( deltaX, deltaZ ) {\r\n\r\n        this.position.setX( this.position.x + deltaX )\r\n        this.position.setZ( this.position.z + deltaZ )\r\n\r\n    }\r\n\r\n    _translateYZ ( deltaY, deltaZ ) {\r\n\r\n        this.position.setY( this.position.y + deltaY )\r\n        this.position.setZ( this.position.z + deltaZ )\r\n\r\n    }\r\n\r\n    _translateXYZ ( deltaX, deltaY, deltaZ ) {\r\n\r\n        this.position.set( this.position.x + deltaX, this.position.y + deltaY, this.position.z + deltaZ )\r\n\r\n    }\r\n\r\n    // Rotating\r\n    _rotateX ( delta ) {}\r\n\r\n    _rotateY ( delta ) {}\r\n\r\n    _rotateZ ( delta ) {}\r\n\r\n    _rotateXY ( delta ) {}\r\n\r\n    _rotateXZ ( delta ) {}\r\n\r\n    _rotateYZ ( delta ) {}\r\n\r\n    _rotateXYZ ( delta ) {}\r\n\r\n    // Scaling\r\n    _scale ( changeAmout ) {\r\n\r\n        this.scale.add( changeAmout )\r\n\r\n    }\r\n\r\n    _scaleX ( deltaX ) {\r\n\r\n        this.scale.setX( this.scale.x + deltaX )\r\n\r\n    }\r\n\r\n    _scaleY ( deltaY ) {\r\n\r\n        this.scale.setY( this.scale.y + deltaY )\r\n\r\n    }\r\n\r\n    _scaleZ ( deltaZ ) {\r\n\r\n        this.scale.setZ( this.scale.z + deltaZ )\r\n\r\n    }\r\n\r\n    _scaleXY ( deltaX, deltaY ) {\r\n\r\n        this.scale.setX( this.scale.x + deltaX )\r\n        this.scale.setY( this.scale.y + deltaY )\r\n\r\n    }\r\n\r\n    _scaleXZ ( deltaX, deltaZ ) {\r\n\r\n        this.scale.setX( this.scale.x + deltaX )\r\n        this.scale.setZ( this.scale.z + deltaZ )\r\n\r\n    }\r\n\r\n    _scaleYZ ( deltaY, deltaZ ) {\r\n\r\n        this.scale.setY( this.scale.y + deltaY )\r\n        this.scale.setZ( this.scale.z + deltaZ )\r\n\r\n    }\r\n\r\n    _scaleXYZ ( deltaX, deltaY, deltaZ ) {\r\n\r\n        this.scale.set( this.scale.x + deltaX, this.scale.y + deltaY, this.scale.z + deltaZ )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport {\r\n    ClippingBox,\r\n    HighlightableMaterial,\r\n    HighlightableLineMaterial,\r\n    AbstractGizmo,\r\n    TranslateGizmo,\r\n    RotateGizmo,\r\n    ScaleGizmo,\r\n    ClippingModes,\r\n    ClippingControls\r\n}\r\n","/**\r\n * @author [Tristan Valcke]{@link https://github.com/Itee}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @file Todo\r\n *\r\n * @example Todo\r\n *\r\n */\r\n\r\nimport { TDataBaseManager } from 'itee-client'\r\nimport { isObject }         from 'itee-validators'\r\nimport {\r\n    Object3D,\r\n    Scene\r\n}                           from 'three-full'\r\n\r\n/**\r\n *\r\n * @constructor\r\n */\r\nfunction BufferGeometriesManager () {\r\n\r\n    TDataBaseManager.call( this )\r\n    this.basePath = '/buffergeometries'\r\n\r\n}\r\n\r\nBufferGeometriesManager.prototype = Object.assign( Object.create( TDataBaseManager.prototype ), {\r\n\r\n    /**\r\n     *\r\n     */\r\n    constructor: BufferGeometriesManager,\r\n\r\n    /**\r\n     *\r\n     * @param jsonData\r\n     * @param onError\r\n     * @return {*}\r\n     */\r\n    convert ( data, onError ) {\r\n\r\n        const textureType = data.type\r\n        let texture       = undefined\r\n\r\n        switch ( textureType ) {\r\n\r\n            case 'Scene':\r\n                texture = new Scene()\r\n                break\r\n\r\n            default:\r\n                texture = new Object3D()\r\n                break\r\n\r\n        }\r\n\r\n        // Common object properties\r\n\r\n        if ( textureType === 'Line' ) {\r\n\r\n        }\r\n\r\n        return texture\r\n\r\n    }\r\n\r\n} )\r\n\r\nObject.defineProperties( BufferGeometriesManager.prototype, {\r\n\r\n    /**\r\n     *\r\n     */\r\n    _onJson: {\r\n        value: function _onJson ( jsonData, onSuccess, onProgress, onError ) {\r\n\r\n            // Normalize to array\r\n            const datas   = ( isObject( jsonData ) ) ? [ jsonData ] : jsonData\r\n            const results = {}\r\n            let result    = undefined\r\n\r\n            for ( let dataIndex = 0, numberOfDatas = datas.length, data = undefined ; dataIndex < numberOfDatas ; dataIndex++ ) {\r\n\r\n                data   = datas[ dataIndex ]\r\n                result = this.convert( data, onError )\r\n                if ( result ) { results[ data._id ] = result }\r\n\r\n                onProgress( dataIndex / numberOfDatas )\r\n\r\n            }\r\n\r\n            onSuccess( results )\r\n\r\n        }\r\n    }\r\n\r\n} )\r\n\r\nexport { BufferGeometriesManager }\r\n","/**\r\n * @author [Tristan Valcke]{@link https://github.com/Itee}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @file Todo\r\n *\r\n * @example Todo\r\n *\r\n */\r\n\r\nimport { TDataBaseManager } from 'itee-client'\r\nimport { isObject }         from 'itee-validators'\r\nimport {\r\n    ArcCurve,\r\n    CatmullRomCurve3,\r\n    CubicBezierCurve,\r\n    CubicBezierCurve3,\r\n    Curve,\r\n    CurvePath,\r\n    EllipseCurve,\r\n    LineCurve,\r\n    LineCurve3,\r\n    Path,\r\n    QuadraticBezierCurve,\r\n    QuadraticBezierCurve3,\r\n    Shape,\r\n    SplineCurve\r\n}                           from 'three-full'\r\n\r\n/**\r\n *\r\n * @constructor\r\n */\r\nfunction CurvesManager () {\r\n\r\n    TDataBaseManager.call( this )\r\n    this.basePath = '/curves'\r\n\r\n}\r\n\r\nCurvesManager.prototype = Object.assign( Object.create( TDataBaseManager.prototype ), {\r\n\r\n    /**\r\n     *\r\n     */\r\n    constructor: CurvesManager,\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @return {*}\r\n     */\r\n    convert ( data ) {\r\n\r\n        if ( !data ) {\r\n            throw new Error( 'CurvesManager: Unable to convert null or undefined data !' )\r\n        }\r\n\r\n        const curveType = data.type\r\n        let curve       = undefined\r\n\r\n        switch ( curveType ) {\r\n\r\n            case 'ArcCurve':\r\n                curve = new ArcCurve()\r\n                break\r\n\r\n            case 'CatmullRomCurve3':\r\n                curve = new CatmullRomCurve3()\r\n                break\r\n\r\n            case 'CubicBezierCurve':\r\n                curve = new CubicBezierCurve()\r\n                break\r\n\r\n            case 'CubicBezierCurve3':\r\n                curve = new CubicBezierCurve3()\r\n                break\r\n\r\n            case 'Curve':\r\n                curve = new Curve()\r\n                break\r\n\r\n            case 'CurvePath':\r\n                curve = new CurvePath()\r\n                break\r\n\r\n            case 'EllipseCurve':\r\n                curve = new EllipseCurve()\r\n                break\r\n\r\n            case 'LineCurve':\r\n                curve = new LineCurve()\r\n                break\r\n\r\n            case 'LineCurve3':\r\n                curve = new LineCurve3()\r\n                break\r\n\r\n            // Missing NURBSCurve\r\n\r\n            case 'Path':\r\n                curve = new Path()\r\n                break\r\n\r\n            case 'QuadraticBezierCurve':\r\n                curve = new QuadraticBezierCurve()\r\n                break\r\n\r\n            case 'QuadraticBezierCurve3':\r\n                curve = new QuadraticBezierCurve3()\r\n                break\r\n\r\n            case 'SplineCurve':\r\n                curve = new SplineCurve()\r\n                break\r\n\r\n            case 'Shape':\r\n                curve = new Shape()\r\n                break\r\n\r\n            default:\r\n                throw new Error( `TCurvesManager: Unknown curve of type: ${curveType}` )\r\n                break\r\n\r\n        }\r\n\r\n        curve.fromJSON( data )\r\n\r\n        return curve\r\n\r\n    }\r\n\r\n} )\r\n\r\nObject.defineProperties( CurvesManager.prototype, {\r\n\r\n    /**\r\n     *\r\n     */\r\n    _onJson: {\r\n        value: function _onJson ( jsonData, onSuccess, onProgress, onError ) {\r\n\r\n            // Normalize to array\r\n            const datas   = ( isObject( jsonData ) ) ? [ jsonData ] : jsonData\r\n            const results = {}\r\n\r\n            for ( let dataIndex = 0, numberOfDatas = datas.length, data = undefined ; dataIndex < numberOfDatas ; dataIndex++ ) {\r\n\r\n                data = datas[ dataIndex ]\r\n\r\n                try {\r\n                    results[ data._id ] = this.convert( data )\r\n                } catch ( err ) {\r\n                    onError( err )\r\n                }\r\n\r\n                onProgress( dataIndex / numberOfDatas )\r\n\r\n            }\r\n\r\n            onSuccess( results )\r\n\r\n        }\r\n    }\r\n\r\n} )\r\n\r\nexport { CurvesManager }\r\n","/**\r\n * @author [Tristan Valcke]{@link https://github.com/Itee}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @class GeometriesManager\r\n * @classdesc Todo...\r\n * @example Todo...\r\n *\r\n * @requires {@link TDataBaseManager}\r\n * @requires '../../../node_modules/three/src/core/Geometry'\r\n * @requires { BufferGeometry } from 'three'\r\n * @requires '../../../node_modules/three/src/core/BufferAttribute'\r\n *\r\n */\r\n\r\n/* eslint-env browser */\r\n\r\nimport { TDataBaseManager } from 'itee-client'\r\nimport {\r\n    isDefined,\r\n    isNotBoolean,\r\n    isNull,\r\n    isObject,\r\n    isUndefined\r\n}                           from 'itee-validators'\r\nimport {\r\n    BoxBufferGeometry,\r\n    BoxGeometry,\r\n    BufferAttribute,\r\n    BufferGeometry,\r\n    CircleBufferGeometry,\r\n    CircleGeometry,\r\n    ConeBufferGeometry,\r\n    ConeGeometry,\r\n    CylinderBufferGeometry,\r\n    CylinderGeometry,\r\n    DodecahedronBufferGeometry,\r\n    DodecahedronGeometry,\r\n    EdgesGeometry,\r\n    ExtrudeBufferGeometry,\r\n    ExtrudeGeometry,\r\n    Face3,\r\n    Geometry,\r\n    IcosahedronBufferGeometry,\r\n    IcosahedronGeometry,\r\n    InstancedBufferGeometry,\r\n    LatheBufferGeometry,\r\n    LatheGeometry,\r\n    OctahedronBufferGeometry,\r\n    OctahedronGeometry,\r\n    ParametricBufferGeometry,\r\n    ParametricGeometry,\r\n    PlaneBufferGeometry,\r\n    PlaneGeometry,\r\n    PolyhedronBufferGeometry,\r\n    PolyhedronGeometry,\r\n    RingBufferGeometry,\r\n    RingGeometry,\r\n    Shape,\r\n    ShapeGeometry,\r\n    SphereBufferGeometry,\r\n    SphereGeometry,\r\n    TetrahedronBufferGeometry,\r\n    TetrahedronGeometry,\r\n    TextBufferGeometry,\r\n    TextGeometry,\r\n    TorusBufferGeometry,\r\n    TorusGeometry,\r\n    TorusKnotBufferGeometry,\r\n    TorusKnotGeometry,\r\n    TubeBufferGeometry,\r\n    TubeGeometry,\r\n    Vector3,\r\n    WireframeGeometry\r\n}                           from 'three-full'\r\n\r\nconst ArrayType = {\r\n    Int8Array:         0,\r\n    Uint8Array:        1,\r\n    Uint8ClampedArray: 2,\r\n    Int16Array:        3,\r\n    Uint16Array:       4,\r\n    Int32Array:        5,\r\n    Uint32Array:       6,\r\n    Float32Array:      7,\r\n    Float64Array:      8\r\n}\r\n\r\nclass GeometriesManager extends TDataBaseManager {\r\n\r\n    /**\r\n     *\r\n     * @param parameters\r\n     */\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                basePath:              '/geometries',\r\n                projectionSystem:      'zBack',\r\n                globalScale:           1,\r\n                computeNormals:        true,\r\n                computeBoundingBox:    true,\r\n                computeBoundingSphere: true\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n\r\n        this.projectionSystem      = _parameters.projectionSystem\r\n        this.globalScale           = _parameters.globalScale\r\n        this.computeNormals        = _parameters.computeNormals\r\n        this.computeBoundingBox    = _parameters.computeBoundingBox\r\n        this.computeBoundingSphere = _parameters.computeBoundingSphere\r\n    }\r\n\r\n    //// Getter/Setter\r\n\r\n    get computeBoundingBox () {\r\n        return this._computeBoundingBox\r\n    }\r\n\r\n    set computeBoundingBox ( value ) {\r\n        if ( isNull( value ) ) { throw new TypeError( 'Compute bounding box cannot be null ! Expect a boolean.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Compute bounding box cannot be undefined ! Expect a boolean.' ) }\r\n        if ( isNotBoolean( value ) ) { throw new TypeError( `Compute bounding box cannot be an instance of ${value.constructor.name} ! Expect a boolean.` ) }\r\n\r\n        this._computeBoundingBox = value\r\n    }\r\n\r\n    get computeBoundingSphere () {\r\n        return this._computeBoundingSphere\r\n    }\r\n\r\n    set computeBoundingSphere ( value ) {\r\n        if ( isNull( value ) ) { throw new TypeError( 'Compute bounding sphere cannot be null ! Expect a boolean.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Compute bounding sphere cannot be undefined ! Expect a boolean.' ) }\r\n        if ( isNotBoolean( value ) ) { throw new TypeError( `Compute bounding sphere cannot be an instance of ${value.constructor.name} ! Expect a boolean.` ) }\r\n\r\n        this._computeBoundingSphere = value\r\n    }\r\n\r\n    get computeNormals () {\r\n        return this._computeNormals\r\n    }\r\n\r\n    set computeNormals ( value ) {\r\n        if ( isNull( value ) ) { throw new TypeError( 'Compute normals cannot be null ! Expect a boolean.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Compute normals cannot be undefined ! Expect a boolean.' ) }\r\n        if ( isNotBoolean( value ) ) { throw new TypeError( `Compute normals cannot be an instance of ${value.constructor.name} ! Expect a boolean.` ) }\r\n\r\n        this._computeNormals = value\r\n    }\r\n\r\n    get projectionSystem () {\r\n        return this._projectionSystem\r\n    }\r\n\r\n    set projectionSystem ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Projection system cannot be null ! Expect a positive number.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Projection system cannot be undefined ! Expect a positive number.' ) }\r\n\r\n        this._projectionSystem = value\r\n\r\n    }\r\n\r\n    get globalScale () {\r\n        return this._globalScale\r\n    }\r\n\r\n    set globalScale ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Global scale cannot be null ! Expect a positive number.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Global scale cannot be undefined ! Expect a positive number.' ) }\r\n\r\n        this._globalScale = value\r\n\r\n    }\r\n\r\n    setComputeBoundingBox ( value ) {\r\n\r\n        this.computeBoundingBox = value\r\n        return this\r\n\r\n    }\r\n\r\n    setComputeBoundingShpere ( value ) {\r\n\r\n        this.computeBoundingSphere = value\r\n        return this\r\n\r\n    }\r\n\r\n    setComputeNormals ( value ) {\r\n        this.computeNormals = value\r\n        return this\r\n    }\r\n\r\n    setProjectionSystem ( value ) {\r\n\r\n        this.projectionSystem = value\r\n        return this\r\n\r\n    }\r\n\r\n    setGlobalScale ( value ) {\r\n\r\n        this.globalScale = value\r\n        return this\r\n\r\n    }\r\n\r\n    //// Methods\r\n\r\n    _onJson ( jsonData, onSuccess, onProgress, onError ) {\r\n\r\n        // Normalize to array\r\n        const datas   = ( isObject( jsonData ) ) ? [ jsonData ] : jsonData\r\n        const results = {}\r\n\r\n        for ( let dataIndex = 0, numberOfDatas = datas.length, data = undefined ; dataIndex < numberOfDatas ; dataIndex++ ) {\r\n\r\n            data = datas[ dataIndex ]\r\n\r\n            try {\r\n                results[ data._id ] = this.convert( data )\r\n            } catch ( err ) {\r\n                onError( err )\r\n            }\r\n\r\n            onProgress( new ProgressEvent( 'GeometriesManager', {\r\n                lengthComputable: true,\r\n                loaded:           dataIndex + 1,\r\n                total:            numberOfDatas\r\n            } ) )\r\n\r\n        }\r\n\r\n        onSuccess( results )\r\n\r\n    }\r\n\r\n    /**\r\n     * @public\r\n     * @memberOf GeometriesManager.prototype\r\n     *\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    convert ( data ) {\r\n\r\n        if ( !data ) {\r\n            throw new Error( 'GeometriesManager: Unable to convert null or undefined data !' )\r\n        }\r\n\r\n        const geometryType = data.type\r\n        if ( !geometryType ) {\r\n            throw new Error( 'GeometriesManager: Unable to convert untyped data !' )\r\n        }\r\n\r\n        let geometry = null\r\n\r\n        // Keep backward compat to next Major release\r\n        if ( data.isBufferGeometry || geometryType.includes( 'BufferGeometry' ) ) {\r\n\r\n            geometry = this._convertJsonToBufferGeometry( data )\r\n            if ( this._computeNormals ) {\r\n                geometry.computeVertexNormals()\r\n            }\r\n\r\n        } else if ( data.isGeometry || geometryType.includes( 'Geometry' ) ) {\r\n\r\n            geometry = this._convertJsonToGeometry( data )\r\n            if ( this._computeNormals ) {\r\n                geometry.computeFaceNormals()\r\n            }\r\n\r\n        } else {\r\n\r\n            throw new Error( `TGeometriesManager: Unable to retrieve geometry of type ${geometryType} !` )\r\n\r\n        }\r\n\r\n        // Todo: Allow to force if exist\r\n        if ( this.computeBoundingBox ) {\r\n            geometry.boundingBox = null\r\n            geometry.computeBoundingBox()\r\n        }\r\n\r\n        if ( this.computeBoundingSphere ) {\r\n            geometry.boundingSphere = null\r\n            geometry.computeBoundingSphere()\r\n        }\r\n\r\n        return geometry\r\n\r\n    }\r\n\r\n    _convertJsonToGeometry ( data ) {\r\n\r\n        const geometryType = data.types\r\n        let geometry       = null\r\n\r\n        switch ( geometryType ) {\r\n\r\n            case 'BoxGeometry':\r\n                geometry = new BoxGeometry()\r\n                break\r\n\r\n            case 'CircleGeometry':\r\n                geometry = new CircleGeometry()\r\n                break\r\n\r\n            case 'CylinderGeometry':\r\n                geometry = new CylinderGeometry()\r\n                break\r\n\r\n            case 'ConeGeometry':\r\n                geometry = new ConeGeometry()\r\n                break\r\n\r\n            case 'EdgesGeometry':\r\n                geometry = new EdgesGeometry()\r\n                break\r\n\r\n            case 'DodecahedronGeometry':\r\n                geometry = new DodecahedronGeometry()\r\n                break\r\n\r\n            case 'ExtrudeGeometry':\r\n                geometry = new ExtrudeGeometry()\r\n                break\r\n\r\n            case 'Geometry':\r\n                geometry = new Geometry()\r\n                break\r\n\r\n            case 'IcosahedronGeometry':\r\n                geometry = new IcosahedronGeometry()\r\n                break\r\n\r\n            case 'LatheGeometry':\r\n                geometry = new LatheGeometry()\r\n                break\r\n\r\n            case 'OctahedronGeometry':\r\n                geometry = new OctahedronGeometry()\r\n                break\r\n\r\n            case 'ParametricGeometry':\r\n                geometry = new ParametricGeometry()\r\n                break\r\n\r\n            case 'PlaneGeometry':\r\n                geometry = new PlaneGeometry()\r\n                break\r\n\r\n            case 'PolyhedronGeometry':\r\n                geometry = new PolyhedronGeometry()\r\n                break\r\n\r\n            case 'RingGeometry':\r\n                geometry = new RingGeometry()\r\n                break\r\n\r\n            case 'ShapeGeometry':\r\n                geometry = new ShapeGeometry()\r\n                break\r\n\r\n            case 'TetrahedronGeometry':\r\n                geometry = new TetrahedronGeometry()\r\n                break\r\n\r\n            case 'TextGeometry':\r\n                geometry = new TextGeometry()\r\n                break\r\n\r\n            case 'TorusGeometry':\r\n                geometry = new TorusGeometry()\r\n                break\r\n\r\n            case 'TorusKnotGeometry':\r\n                geometry = new TorusKnotGeometry()\r\n                break\r\n\r\n            case 'TubeGeometry':\r\n                geometry = new TubeGeometry()\r\n                break\r\n\r\n            case 'SphereGeometry':\r\n                geometry = new SphereGeometry()\r\n                break\r\n\r\n            case 'WireframeGeometry':\r\n                geometry = new WireframeGeometry()\r\n                break\r\n\r\n            default:\r\n                throw new Error( `TGeometriesManager: Unknown geometry of type: ${geometryType}` )\r\n                break\r\n\r\n        }\r\n\r\n        geometry.uuid = data.uuid\r\n        geometry.name = data.name\r\n        geometry.type = data.type\r\n\r\n        var vertices = []\r\n        var vertex   = undefined\r\n        for ( var index = 0, numberOfVertices = data.vertices.length ; index < numberOfVertices ; ++index ) {\r\n\r\n            vertex = data.vertices[ index ]\r\n            vertices.push( new Vector3( vertex.x, vertex.y, vertex.z ) )\r\n\r\n        }\r\n        geometry.vertices = vertices\r\n        //                geometry.colors                  = data.colors\r\n\r\n        var faces = []\r\n        var face  = undefined\r\n        for ( var faceIndex = 0, numberOfFaces = data.faces.length ; faceIndex < numberOfFaces ; faceIndex++ ) {\r\n            face = data.faces[ faceIndex ]\r\n            faces.push( new Face3( face.a, face.b, face.c, face.normal, face.color, face.materialIndex ) )\r\n        }\r\n        geometry.faces         = faces\r\n        //                geometry.faceVertexUvs           = [ [ Number ] ]\r\n        geometry.morphTargets  = []\r\n        geometry.morphNormals  = []\r\n        geometry.skinWeights   = []\r\n        geometry.skinIndices   = []\r\n        geometry.lineDistances = []\r\n\r\n        geometry.elementsNeedUpdate      = true //data.elementsNeedUpdate\r\n        geometry.verticesNeedUpdate      = true //data.verticesNeedUpdate\r\n        geometry.uvsNeedUpdate           = true //data.uvsNeedUpdate\r\n        geometry.normalsNeedUpdate       = true //data.normalsNeedUpdate\r\n        geometry.colorsNeedUpdate        = true //data.colorsNeedUpdate\r\n        geometry.lineDistancesNeedUpdate = true //data.lineDistancesNeedUpdate\r\n        geometry.groupsNeedUpdate        = true //data.groupsNeedUpdate\r\n\r\n    }\r\n\r\n    _convertJsonToBufferGeometry ( data ) {\r\n\r\n        const bufferGeometryType = data.type\r\n        let bufferGeometry       = null\r\n\r\n        switch ( bufferGeometryType ) {\r\n\r\n            case 'BoxBufferGeometry':\r\n                bufferGeometry = new BoxBufferGeometry()\r\n                break\r\n\r\n            case 'BufferGeometry':\r\n                bufferGeometry = new BufferGeometry()\r\n                break\r\n\r\n            case 'CircleBufferGeometry':\r\n                bufferGeometry = new CircleBufferGeometry()\r\n                break\r\n\r\n            case 'CylinderBufferGeometry':\r\n                bufferGeometry = new CylinderBufferGeometry()\r\n                break\r\n\r\n            case 'ConeBufferGeometry':\r\n                bufferGeometry = new ConeBufferGeometry()\r\n                break\r\n\r\n            case 'DodecahedronBufferGeometry':\r\n                bufferGeometry = new DodecahedronBufferGeometry()\r\n                break\r\n\r\n            case 'ExtrudeBufferGeometry':\r\n                bufferGeometry = new ExtrudeBufferGeometry()\r\n                break\r\n\r\n            case 'IcosahedronBufferGeometry':\r\n                bufferGeometry = new IcosahedronBufferGeometry()\r\n                break\r\n\r\n            case 'LatheBufferGeometry':\r\n                bufferGeometry = new LatheBufferGeometry()\r\n                break\r\n\r\n            case 'OctahedronBufferGeometry':\r\n                bufferGeometry = new OctahedronBufferGeometry()\r\n                break\r\n\r\n            case 'ParametricBufferGeometry':\r\n                bufferGeometry = new ParametricBufferGeometry()\r\n                break\r\n\r\n            case 'PlaneBufferGeometry':\r\n                bufferGeometry = new PlaneBufferGeometry()\r\n                break\r\n\r\n            case 'PolyhedronBufferGeometry':\r\n                bufferGeometry = new PolyhedronBufferGeometry()\r\n                break\r\n\r\n            case 'RingBufferGeometry':\r\n                bufferGeometry = new RingBufferGeometry()\r\n                break\r\n\r\n            case 'ShapeBufferGeometry':\r\n                bufferGeometry = new BufferGeometry()\r\n                //                bufferGeometry = new ShapeBufferGeometry(  )\r\n                break\r\n\r\n            case 'TetrahedronBufferGeometry':\r\n                bufferGeometry = new TetrahedronBufferGeometry()\r\n                break\r\n\r\n            case 'TextBufferGeometry':\r\n                bufferGeometry = new TextBufferGeometry()\r\n                break\r\n\r\n            case 'TorusBufferGeometry':\r\n                bufferGeometry = new TorusBufferGeometry()\r\n                break\r\n\r\n            case 'TorusKnotBufferGeometry':\r\n                bufferGeometry = new TorusKnotBufferGeometry()\r\n                break\r\n\r\n            case 'TubeBufferGeometry':\r\n                bufferGeometry = new TubeBufferGeometry()\r\n                break\r\n\r\n            case 'SphereBufferGeometry':\r\n                bufferGeometry = new SphereBufferGeometry()\r\n                break\r\n\r\n            case 'InstancedBufferGeometry':\r\n                bufferGeometry = new InstancedBufferGeometry()\r\n                break\r\n\r\n            default:\r\n                throw new Error( `TGeometriesManager: Unknown buffer geometry of type: ${bufferGeometryType}` )\r\n\r\n        }\r\n\r\n        // COMMON PARTS\r\n        bufferGeometry._id  = data._id\r\n        bufferGeometry.uuid = data.uuid\r\n        bufferGeometry.name = data.name\r\n\r\n        // Extract index\r\n        const dataIndexes = data.index\r\n        if ( dataIndexes && dataIndexes.array && dataIndexes.array.length > 0 ) {\r\n\r\n            const arrayBuffer    = this.__convertBase64ToArrayBuffer( dataIndexes.array )\r\n            const typedArray     = this.__convertArrayBufferToTypedArray( arrayBuffer )\r\n            bufferGeometry.index = new BufferAttribute( typedArray, dataIndexes.itemSize, dataIndexes.normalized )\r\n\r\n        }\r\n\r\n        // Extract attributes\r\n        const dataAttributes = data.attributes\r\n        if ( dataAttributes ) {\r\n\r\n            let attributes = {}\r\n\r\n            // TODO: using loop instead !!\r\n            const positionAttributes = dataAttributes.position\r\n            if ( positionAttributes ) {\r\n\r\n                const arrayBuffer = this.__convertBase64ToArrayBuffer( positionAttributes.array )\r\n                const typedArray  = this.__convertArrayBufferToTypedArray( arrayBuffer )\r\n                const globalScale = this.globalScale\r\n\r\n                const positionArray = new Float32Array( typedArray )\r\n\r\n                if ( this._projectionSystem === 'zBack' ) {\r\n\r\n                    let x = null\r\n                    let y = null\r\n                    let z = null\r\n                    for ( let pi = 0, numPos = positionArray.length ; pi < numPos ; pi += 3 ) {\r\n                        x                       = positionArray[ pi ] / globalScale\r\n                        y                       = positionArray[ pi + 2 ] / globalScale\r\n                        z                       = -positionArray[ pi + 1 ] / globalScale\r\n                        positionArray[ pi ]     = x\r\n                        positionArray[ pi + 1 ] = y\r\n                        positionArray[ pi + 2 ] = z\r\n                    }\r\n\r\n                } else {\r\n\r\n                    for ( let posIndex = 0, numPos = positionArray.length ; posIndex < numPos ; posIndex++ ) {\r\n                        positionArray[ posIndex ] /= globalScale\r\n                    }\r\n\r\n                }\r\n\r\n                attributes[ 'position' ] = new BufferAttribute( positionArray, positionAttributes.itemSize, positionAttributes.normalized )\r\n\r\n            }\r\n\r\n            const normalAttributes = dataAttributes.normal\r\n            if ( normalAttributes ) {\r\n\r\n                const arrayBuffer      = this.__convertBase64ToArrayBuffer( normalAttributes.array )\r\n                const typedArray       = this.__convertArrayBufferToTypedArray( arrayBuffer )\r\n                attributes[ 'normal' ] = new BufferAttribute( typedArray, normalAttributes.itemSize, normalAttributes.normalized )\r\n\r\n            }\r\n\r\n            const uvAttributes = dataAttributes.uv\r\n            if ( uvAttributes ) {\r\n\r\n                const arrayBuffer  = this.__convertBase64ToArrayBuffer( uvAttributes.array )\r\n                const typedArray   = this.__convertArrayBufferToTypedArray( arrayBuffer )\r\n                attributes[ 'uv' ] = new BufferAttribute( typedArray, uvAttributes.itemSize, uvAttributes.normalized )\r\n\r\n            }\r\n\r\n            bufferGeometry.attributes = attributes\r\n\r\n        }\r\n\r\n        if ( isDefined( data.groups ) ) {\r\n            bufferGeometry.groups = data.groups\r\n        }\r\n\r\n        // Need to set null because only checked vs undefined data.boundingBox\r\n        if ( isDefined( data.boundingBox ) ) {\r\n            bufferGeometry.boundingBox = data.boundingBox\r\n        }\r\n\r\n        // idem... data.boundingSphere\r\n        if ( isDefined( data.boundingSphere ) ) {\r\n            bufferGeometry.boundingSphere = data.boundingSphere\r\n        }\r\n\r\n        //        if ( isDefined( data.drawRange ) ) {\r\n        //            bufferGeometry.drawRange = data.drawRange\r\n        //        }\r\n\r\n        if ( bufferGeometryType === 'ShapeBufferGeometry' ) {\r\n\r\n            bufferGeometry.shapes        = data.shapes.map( jsonShape => {return new Shape().fromJSON( jsonShape )} )\r\n            bufferGeometry.curveSegments = data.curveSegments\r\n\r\n        } else {\r\n\r\n        }\r\n\r\n        return bufferGeometry\r\n\r\n    }\r\n\r\n    __convertArrayBufferToTypedArray ( arrayBuffer ) {\r\n\r\n        const ONE_BYTE       = 1\r\n        const TWO_BYTE       = 2\r\n        const FOUR_BYTE      = 4\r\n        const HEIGHT_BYTE    = 8\r\n        const dataView       = new DataView( arrayBuffer )\r\n        const dataByteLength = arrayBuffer.byteLength - 1\r\n        const type           = dataView.getUint8( 0 )\r\n\r\n        let typedArray = null\r\n\r\n        switch ( type ) {\r\n\r\n            case ArrayType.Int8Array:\r\n                typedArray = new Int8Array( dataByteLength / ONE_BYTE )\r\n                for ( let index = 0, offset = 1 ; offset < dataByteLength ; index++, offset += ONE_BYTE ) {\r\n                    typedArray[ index ] = dataView.getInt8( offset )\r\n                }\r\n                break\r\n\r\n            case ArrayType.Uint8Array:\r\n                typedArray = new Uint8Array( dataByteLength / ONE_BYTE )\r\n                for ( let index = 0, offset = 1 ; offset < dataByteLength ; index++, offset += ONE_BYTE ) {\r\n                    typedArray[ index ] = dataView.getUint8( offset )\r\n                }\r\n                break\r\n\r\n            case ArrayType.Uint8ClampedArray:\r\n                typedArray = new Uint8ClampedArray( dataByteLength / ONE_BYTE )\r\n                for ( let index = 0, offset = 1 ; offset < dataByteLength ; index++, offset += ONE_BYTE ) {\r\n                    typedArray[ index ] = dataView.getUint8( offset )\r\n                }\r\n                break\r\n\r\n            case ArrayType.Int16Array:\r\n                typedArray = new Int16Array( dataByteLength / TWO_BYTE )\r\n                for ( let index = 0, offset = 1 ; offset < dataByteLength ; index++, offset += TWO_BYTE ) {\r\n                    typedArray[ index ] = dataView.getInt16( offset )\r\n                }\r\n                break\r\n\r\n            case ArrayType.Uint16Array:\r\n                typedArray = new Uint16Array( dataByteLength / TWO_BYTE )\r\n                for ( let index = 0, offset = 1 ; offset < dataByteLength ; index++, offset += TWO_BYTE ) {\r\n                    typedArray[ index ] = dataView.getUint16( offset )\r\n                }\r\n                break\r\n\r\n            case ArrayType.Int32Array:\r\n                typedArray = new Int32Array( dataByteLength / FOUR_BYTE )\r\n                for ( let index = 0, offset = 1 ; offset < dataByteLength ; index++, offset += FOUR_BYTE ) {\r\n                    typedArray[ index ] = dataView.getInt32( offset )\r\n                }\r\n                break\r\n\r\n            case ArrayType.Uint32Array:\r\n                typedArray = new Uint32Array( dataByteLength / FOUR_BYTE )\r\n                for ( let index = 0, offset = 1 ; offset < dataByteLength ; index++, offset += FOUR_BYTE ) {\r\n                    typedArray[ index ] = dataView.getUint32( offset )\r\n                }\r\n                break\r\n\r\n            case ArrayType.Float32Array:\r\n                typedArray = new Float32Array( dataByteLength / FOUR_BYTE )\r\n                for ( let index = 0, offset = 1 ; offset < dataByteLength ; index++, offset += FOUR_BYTE ) {\r\n                    typedArray[ index ] = dataView.getFloat32( offset )\r\n                }\r\n                break\r\n\r\n            case ArrayType.Float64Array:\r\n                typedArray = new Float64Array( dataByteLength / HEIGHT_BYTE )\r\n                for ( let index = 0, offset = 1 ; offset < dataByteLength ; index++, offset += HEIGHT_BYTE ) {\r\n                    typedArray[ index ] = dataView.getFloat64( offset )\r\n                }\r\n                break\r\n\r\n            default:\r\n                throw new RangeError( `Invalid switch parameter: ${type}` )\r\n\r\n        }\r\n\r\n        return typedArray\r\n\r\n    }\r\n\r\n    __convertBase64ToArrayBuffer ( base64 ) {\r\n\r\n        const chars  = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\r\n        const lookup = new Uint8Array( 256 )\r\n        for ( let i = 0 ; i < chars.length ; i++ ) {\r\n            lookup[ chars.charCodeAt( i ) ] = i\r\n        }\r\n\r\n        ////////\r\n\r\n        const base64Length = base64.length\r\n\r\n        let bufferLength = base64Length * 0.75\r\n        if ( base64[ base64Length - 1 ] === '=' ) {\r\n            bufferLength--\r\n            if ( base64[ base64Length - 2 ] === '=' ) {\r\n                bufferLength--\r\n            }\r\n        }\r\n\r\n        let arraybuffer = new ArrayBuffer( bufferLength )\r\n        let bytes       = new Uint8Array( arraybuffer )\r\n        let encoded1    = undefined\r\n        let encoded2    = undefined\r\n        let encoded3    = undefined\r\n        let encoded4    = undefined\r\n\r\n        for ( let i = 0, pointer = 0 ; i < base64Length ; i += 4 ) {\r\n            encoded1 = lookup[ base64.charCodeAt( i ) ]\r\n            encoded2 = lookup[ base64.charCodeAt( i + 1 ) ]\r\n            encoded3 = lookup[ base64.charCodeAt( i + 2 ) ]\r\n            encoded4 = lookup[ base64.charCodeAt( i + 3 ) ]\r\n\r\n            bytes[ pointer++ ] = ( encoded1 << 2 ) | ( encoded2 >> 4 )\r\n            bytes[ pointer++ ] = ( ( encoded2 & 15 ) << 4 ) | ( encoded3 >> 2 )\r\n            bytes[ pointer++ ] = ( ( encoded3 & 3 ) << 6 ) | ( encoded4 & 63 )\r\n        }\r\n\r\n        return arraybuffer\r\n\r\n    }\r\n\r\n}\r\n\r\nexport { GeometriesManager }\r\n","/**\r\n * @author [Tristan Valcke]{@link https://github.com/Itee}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @file Todo\r\n *\r\n * @example Todo\r\n *\r\n */\r\n\r\nimport { TDataBaseManager } from 'itee-client'\r\nimport { isObject }         from 'itee-validators'\r\n\r\n/**\r\n *\r\n * @constructor\r\n */\r\nfunction TexturesManager () {\r\n\r\n    TDataBaseManager.call( this )\r\n    this.basePath = '/textures'\r\n\r\n}\r\n\r\nTexturesManager.prototype = Object.assign( Object.create( TDataBaseManager.prototype ), {\r\n\r\n    /**\r\n     *\r\n     */\r\n    constructor: TexturesManager,\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @return {*}\r\n     */\r\n    convert ( data ) {\r\n\r\n        if ( !data ) {\r\n            throw new Error( 'TexturesManager: Unable to convert null or undefined data !' )\r\n        }\r\n\r\n        const textureType = data.type\r\n        let texture       = undefined\r\n\r\n        switch ( textureType ) {\r\n\r\n            default:\r\n                throw new Error( `TTexturesManager: Unknown texture of type: ${textureType}` )\r\n                break\r\n\r\n        }\r\n\r\n        // Common object properties\r\n\r\n        if ( textureType === 'Line' ) {\r\n\r\n        }\r\n\r\n        return texture\r\n\r\n    }\r\n\r\n} )\r\n\r\nObject.defineProperties( TexturesManager.prototype, {\r\n\r\n    /**\r\n     *\r\n     */\r\n    _onJson: {\r\n        value: function _onJson ( jsonData, onSuccess, onProgress, onError ) {\r\n\r\n            // Normalize to array\r\n            const datas   = ( isObject( jsonData ) ) ? [ jsonData ] : jsonData\r\n            const results = {}\r\n\r\n            for ( let dataIndex = 0, numberOfDatas = datas.length, data = undefined ; dataIndex < numberOfDatas ; dataIndex++ ) {\r\n\r\n                data = datas[ dataIndex ]\r\n\r\n                try {\r\n                    results[ data._id ] = this.convert( data )\r\n                } catch ( err ) {\r\n                    onError( err )\r\n                }\r\n\r\n                onProgress( dataIndex / numberOfDatas )\r\n\r\n            }\r\n\r\n            onSuccess( results )\r\n        }\r\n    }\r\n\r\n} )\r\n\r\nexport { TexturesManager }\r\n","/**\r\n * @author [Tristan Valcke]{@link https://github.com/Itee}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @class TScenesManager\r\n * @classdesc Todo...\r\n * @example Todo...\r\n * @requires TDataBaseManager\r\n *\r\n */\r\n\r\n/* eslint-env browser */\r\n\r\nimport { TDataBaseManager } from 'itee-client'\r\nimport {\r\n    isBlankString,\r\n    isDefined,\r\n    isEmptyString,\r\n    isNotBoolean,\r\n    isNotDefined,\r\n    isNotEmptyString,\r\n    isNotString,\r\n    isNull,\r\n    isObject,\r\n    isString,\r\n    isUndefined\r\n}                           from 'itee-validators'\r\nimport {\r\n    Color,\r\n    ImageLoader,\r\n    LinearFilter,\r\n    LineBasicMaterial,\r\n    MeshLambertMaterial,\r\n    MeshPhongMaterial,\r\n    PointsMaterial,\r\n    TextureLoader,\r\n    Vector2\r\n}                           from 'three-full'\r\nimport { TexturesManager }  from './TexturesManager'\r\n\r\nconst DEFAULT_IMAGE = new ImageLoader().load( 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4gkKDRoGpGNegQAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAMSURBVAjXY/j//z8ABf4C/tzMWecAAAAASUVORK5CYII=' )\r\n\r\nclass MaterialsManager extends TDataBaseManager {\r\n\r\n    /**\r\n     *\r\n     * @param basePath\r\n     * @param responseType\r\n     * @param bunchSize\r\n     * @param progressManager\r\n     * @param errorManager\r\n     * @param texturesPath\r\n     * @param texturesProvider\r\n     */\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                basePath:         '/materials',\r\n                texturesPath:     '/textures',\r\n                texturesProvider: new TextureLoader(),\r\n                generateMipmap:   false,\r\n                autoFillTextures: true\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n\r\n        this.texturesPath     = _parameters.texturesPath\r\n        this.texturesProvider = _parameters.texturesProvider\r\n        this.generateMipmap   = _parameters.generateMipmap\r\n        this.autoFillTextures = _parameters.autoFillTextures\r\n\r\n    }\r\n\r\n    get texturesPath () {\r\n        return this._texturesPath\r\n    }\r\n\r\n    set texturesPath ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Textures path cannot be null ! Expect a non empty string.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Textures path cannot be undefined ! Expect a non empty string.' ) }\r\n        if ( isNotString( value ) ) { throw new TypeError( `Textures path cannot be an instance of ${value.constructor.name} ! Expect a non empty string.` ) }\r\n        if ( isEmptyString( value ) ) { throw new TypeError( 'Textures path cannot be empty ! Expect a non empty string.' ) }\r\n        if ( isBlankString( value ) ) { throw new TypeError( 'Textures path cannot contain only whitespace ! Expect a non empty string.' ) }\r\n\r\n        this._texturesPath = value\r\n\r\n    }\r\n\r\n    get texturesProvider () {\r\n        return this._texturesProvider\r\n    }\r\n\r\n    set texturesProvider ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Textures provider cannot be null ! Expect an instance of TextureLoader.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Textures provider cannot be undefined ! Expect an instance of TextureLoader.' ) }\r\n        if ( !( value instanceof TexturesManager ) && !( value instanceof TextureLoader ) ) { throw new TypeError( `Textures provider cannot be an instance of ${value.constructor.name} ! Expect an instance of TTexturesManager.` ) }\r\n\r\n        this._texturesProvider = value\r\n\r\n    }\r\n\r\n    get generateMipmap () {\r\n        return this._generateMipmap\r\n    }\r\n\r\n    set generateMipmap ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Generate mipmap cannot be null ! Expect a boolean.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Generate mipmap cannot be undefined ! Expect a boolean.' ) }\r\n        if ( isNotBoolean( value ) ) { throw new TypeError( `Generate mipmap cannot be an instance of ${value.constructor.name} ! Expect a boolean.` ) }\r\n\r\n        this._generateMipmap = value\r\n    }\r\n\r\n    get autoFillTextures () {\r\n        return this._autoFillTextures\r\n    }\r\n\r\n    set autoFillTextures ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Global scale cannot be null ! Expect a boolean.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Global scale cannot be undefined ! Expect a positive number.' ) }\r\n        if ( isNotBoolean( value ) ) { throw new TypeError( 'Global scale cannot be null ! Expect a boolean.' ) }\r\n\r\n        this._autoFillTextures = value\r\n\r\n    }\r\n\r\n    setTexturesPath ( value ) {\r\n\r\n        this.texturesPath = value\r\n        return this\r\n\r\n    }\r\n\r\n    setTexturesProvider ( value ) {\r\n\r\n        this.texturesProvider = value\r\n        return this\r\n\r\n    }\r\n\r\n    setGenerateMipmap ( value ) {\r\n\r\n        this.generateMipmap = value\r\n        return this\r\n\r\n    }\r\n\r\n    setAutoFillTextures ( value ) {\r\n\r\n        this.autoFillTextures = value\r\n        return this\r\n\r\n    }\r\n\r\n    //// Methods\r\n\r\n    _onJson ( jsonData, onSuccess, onProgress, onError ) {\r\n\r\n        // Normalize to array\r\n        const datas   = ( isObject( jsonData ) ) ? [ jsonData ] : jsonData\r\n        const results = {}\r\n\r\n        for ( let dataIndex = 0, numberOfDatas = datas.length, data = undefined ; dataIndex < numberOfDatas ; dataIndex++ ) {\r\n\r\n            data = datas[ dataIndex ]\r\n\r\n            try {\r\n                results[ data._id ] = this.convert( data )\r\n            } catch ( err ) {\r\n                onError( err )\r\n            }\r\n\r\n            onProgress( new ProgressEvent( 'MaterialsManager', {\r\n                lengthComputable: true,\r\n                loaded:           dataIndex + 1,\r\n                total:            numberOfDatas\r\n            } ) )\r\n\r\n        }\r\n\r\n        if ( this._autoFillTextures ) {\r\n            this.fillTextures( results, onSuccess, onProgress, onError )\r\n        } else {\r\n            onSuccess( results )\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @return {undefined}\r\n     */\r\n    convert ( data ) {\r\n\r\n        if ( !data ) {\r\n            throw new Error( 'MaterialsManager: Unable to convert null or undefined data !' )\r\n        }\r\n\r\n        const type   = data.type\r\n        let material = null\r\n\r\n        switch ( type ) {\r\n\r\n            case 'MeshPhongMaterial': {\r\n                material = new MeshPhongMaterial()\r\n                this._fillBaseMaterialData( material, data )\r\n\r\n                const color = data.color\r\n                if ( isDefined( color ) ) {\r\n                    material.color = this._setColor( color )\r\n                }\r\n\r\n                const specular = data.specular\r\n                if ( isDefined( specular ) ) {\r\n                    material.specular = this._setColor( specular )\r\n                }\r\n\r\n                const shininess = data.shininess\r\n                if ( isDefined( shininess ) ) {\r\n                    material.shininess = shininess\r\n                }\r\n\r\n                const map = data.map\r\n                if ( isDefined( map ) ) {\r\n                    material.map = map\r\n                }\r\n\r\n                const lightMap = data.lightMap\r\n                if ( isDefined( lightMap ) ) {\r\n                    material.lightMap = lightMap\r\n                }\r\n\r\n                const lightMapIntensity = data.lightMapIntensity\r\n                if ( isDefined( lightMapIntensity ) ) {\r\n                    material.lightMapIntensity = lightMapIntensity\r\n                }\r\n\r\n                const aoMap = data.aoMap\r\n                if ( isDefined( aoMap ) ) {\r\n                    material.aoMap = aoMap\r\n                }\r\n\r\n                const aoMapIntensity = data.aoMapIntensity\r\n                if ( isDefined( aoMapIntensity ) ) {\r\n                    material.aoMapIntensity = aoMapIntensity\r\n                }\r\n\r\n                const emissive = data.emissive\r\n                if ( isDefined( emissive ) ) {\r\n                    material.emissive = this._setColor( emissive )\r\n                }\r\n\r\n                const emissiveIntensity = data.emissiveIntensity\r\n                if ( isDefined( emissiveIntensity ) ) {\r\n                    material.emissiveIntensity = emissiveIntensity\r\n                }\r\n\r\n                const emissiveMap = data.emissiveMap\r\n                if ( isDefined( emissiveMap ) ) {\r\n                    material.emissiveMap = emissiveMap\r\n                }\r\n\r\n                const bumpMap = data.bumpMap\r\n                if ( isDefined( bumpMap ) ) {\r\n                    material.bumpMap = bumpMap\r\n                }\r\n\r\n                const bumpScale = data.bumpScale\r\n                if ( isDefined( bumpScale ) ) {\r\n                    material.bumpScale = bumpScale\r\n                }\r\n\r\n                const normalMap = data.normalMap\r\n                if ( isDefined( normalMap ) ) {\r\n                    material.normalMap = normalMap\r\n                }\r\n\r\n                const normalScale = data.normalScale\r\n                if ( isDefined( normalScale ) ) {\r\n                    material.normalScale = this._setVector2( normalScale )\r\n                }\r\n\r\n                const displacementMap = data.displacementMap\r\n                if ( isDefined( displacementMap ) ) {\r\n                    material.displacementMap = displacementMap\r\n                }\r\n\r\n                const displacementScale = data.displacementScale\r\n                if ( isDefined( displacementScale ) ) {\r\n                    material.displacementScale = displacementScale\r\n                }\r\n\r\n                const displacementBias = data.displacementBias\r\n                if ( isDefined( displacementBias ) ) {\r\n                    material.displacementBias = displacementBias\r\n                }\r\n\r\n                const specularMap = data.specularMap\r\n                if ( isDefined( specularMap ) ) {\r\n                    material.specularMap = specularMap\r\n                }\r\n\r\n                const alphaMap = data.alphaMap\r\n                if ( isDefined( alphaMap ) ) {\r\n                    material.alphaMap = alphaMap\r\n                }\r\n\r\n                const envMap = data.envMap\r\n                if ( isDefined( envMap ) ) {\r\n                    material.envMap = envMap\r\n                }\r\n\r\n                const combine = data.combine\r\n                if ( isDefined( combine ) ) {\r\n                    material.combine = combine\r\n                }\r\n\r\n                const reflectivity = data.reflectivity\r\n                if ( isDefined( reflectivity ) ) {\r\n                    material.reflectivity = reflectivity\r\n                }\r\n\r\n                const refractionRatio = data.refractionRatio\r\n                if ( isDefined( refractionRatio ) ) {\r\n                    material.refractionRatio = refractionRatio\r\n                }\r\n\r\n                const wireframe = data.wireframe\r\n                if ( isDefined( wireframe ) ) {\r\n                    material.wireframe = wireframe\r\n                }\r\n\r\n                const wireframeLinewidth = data.wireframeLinewidth\r\n                if ( isDefined( wireframeLinewidth ) ) {\r\n                    material.wireframeLinewidth = wireframeLinewidth\r\n                }\r\n\r\n                const wireframeLinecap = data.wireframeLinecap\r\n                if ( isDefined( wireframeLinecap ) ) {\r\n                    material.wireframeLinecap = wireframeLinecap\r\n                }\r\n\r\n                const wireframeLinejoin = data.wireframeLinejoin\r\n                if ( isDefined( wireframeLinejoin ) ) {\r\n                    material.wireframeLinejoin = wireframeLinejoin\r\n                }\r\n\r\n                const skinning = data.skinning\r\n                if ( isDefined( skinning ) ) {\r\n                    material.skinning = skinning\r\n                }\r\n\r\n                const morphTargets = data.morphTargets\r\n                if ( isDefined( morphTargets ) ) {\r\n                    material.morphTargets = morphTargets\r\n                }\r\n\r\n                const morphNormals = data.morphNormals\r\n                if ( isDefined( morphNormals ) ) {\r\n                    material.morphNormals = morphNormals\r\n                }\r\n\r\n                break\r\n            }\r\n\r\n            case 'MeshLambertMaterial': {\r\n                material = new MeshLambertMaterial()\r\n                this._fillBaseMaterialData( material, data )\r\n\r\n                const color = data.color\r\n                if ( isDefined( color ) ) {\r\n                    material.color = this._setColor( color )\r\n                }\r\n\r\n                const map = data.map\r\n                if ( isDefined( map ) ) {\r\n                    material.map = map\r\n                }\r\n\r\n                const lightMap = data.lightMap\r\n                if ( isDefined( lightMap ) ) {\r\n                    material.lightMap = lightMap\r\n                }\r\n\r\n                const lightMapIntensity = data.lightMapIntensity\r\n                if ( isDefined( lightMapIntensity ) ) {\r\n                    material.lightMapIntensity = lightMapIntensity\r\n                }\r\n\r\n                const aoMap = data.aoMap\r\n                if ( isDefined( aoMap ) ) {\r\n                    material.aoMap = aoMap\r\n                }\r\n\r\n                const aoMapIntensity = data.aoMapIntensity\r\n                if ( isDefined( aoMapIntensity ) ) {\r\n                    material.aoMapIntensity = aoMapIntensity\r\n                }\r\n\r\n                const emissive = data.emissive\r\n                if ( isDefined( emissive ) ) {\r\n                    material.emissive = this._setColor( emissive )\r\n                }\r\n\r\n                const emissiveIntensity = data.emissiveIntensity\r\n                if ( isDefined( emissiveIntensity ) ) {\r\n                    material.emissiveIntensity = emissiveIntensity\r\n                }\r\n\r\n                const emissiveMap = data.emissiveMap\r\n                if ( isDefined( emissiveMap ) ) {\r\n                    material.emissiveMap = emissiveMap\r\n                }\r\n\r\n                const specularMap = data.specularMap\r\n                if ( isDefined( specularMap ) ) {\r\n                    material.specularMap = specularMap\r\n                }\r\n\r\n                const alphaMap = data.alphaMap\r\n                if ( isDefined( alphaMap ) ) {\r\n                    material.alphaMap = alphaMap\r\n                }\r\n\r\n                const envMap = data.envMap\r\n                if ( isDefined( envMap ) ) {\r\n                    material.envMap = envMap\r\n                }\r\n\r\n                const combine = data.combine\r\n                if ( isDefined( combine ) ) {\r\n                    material.combine = combine\r\n                }\r\n\r\n                const reflectivity = data.reflectivity\r\n                if ( isDefined( reflectivity ) ) {\r\n                    material.reflectivity = reflectivity\r\n                }\r\n\r\n                const refractionRatio = data.refractionRatio\r\n                if ( isDefined( refractionRatio ) ) {\r\n                    material.refractionRatio = refractionRatio\r\n                }\r\n\r\n                const wireframe = data.wireframe\r\n                if ( isDefined( wireframe ) ) {\r\n                    material.wireframe = wireframe\r\n                }\r\n\r\n                const wireframeLinewidth = data.wireframeLinewidth\r\n                if ( isDefined( wireframeLinewidth ) ) {\r\n                    material.wireframeLinewidth = wireframeLinewidth\r\n                }\r\n\r\n                const wireframeLinecap = data.wireframeLinecap\r\n                if ( isDefined( wireframeLinecap ) ) {\r\n                    material.wireframeLinecap = wireframeLinecap\r\n                }\r\n\r\n                const wireframeLinejoin = data.wireframeLinejoin\r\n                if ( isDefined( wireframeLinejoin ) ) {\r\n                    material.wireframeLinejoin = wireframeLinejoin\r\n                }\r\n\r\n                const skinning = data.skinning\r\n                if ( isDefined( skinning ) ) {\r\n                    material.skinning = skinning\r\n                }\r\n\r\n                const morphTargets = data.morphTargets\r\n                if ( isDefined( morphTargets ) ) {\r\n                    material.morphTargets = morphTargets\r\n                }\r\n\r\n                const morphNormals = data.morphNormals\r\n                if ( isDefined( morphNormals ) ) {\r\n                    material.morphNormals = morphNormals\r\n                }\r\n\r\n                break\r\n            }\r\n\r\n            case 'LineBasicMaterial': {\r\n                material = new LineBasicMaterial()\r\n                this._fillBaseMaterialData( material, data )\r\n\r\n                const color = data.color\r\n                if ( isDefined( color ) ) {\r\n                    material.color = this._setColor( color )\r\n                }\r\n\r\n                break\r\n            }\r\n\r\n            case 'PointsMaterial': {\r\n                material = new PointsMaterial()\r\n                this._fillBaseMaterialData( material, data )\r\n\r\n                const color = data.color\r\n                if ( isDefined( color ) ) {\r\n                    material.color = this._setColor( color )\r\n                }\r\n\r\n                const map = data.map\r\n                if ( isDefined( map ) ) {\r\n                    material.map = map\r\n                }\r\n\r\n                const morphTargets = data.morphTargets\r\n                if ( isDefined( morphTargets ) ) {\r\n                    material.morphTargets = morphTargets\r\n                }\r\n\r\n                const size = data.size\r\n                if ( isDefined( size ) ) {\r\n                    material.size = size\r\n                }\r\n\r\n                const sizeAttenuation = data.sizeAttenuation\r\n                if ( isDefined( sizeAttenuation ) ) {\r\n                    material.sizeAttenuation = sizeAttenuation\r\n                }\r\n\r\n                break\r\n            }\r\n\r\n            default:\r\n                throw new Error( `TMaterialsManager: Unmanaged material of type: ${type}` )\r\n                break\r\n\r\n        }\r\n\r\n        return material\r\n\r\n    }\r\n\r\n    _fillBaseMaterialData ( material, data ) {\r\n\r\n        const _id = data._id\r\n        if ( isDefined( _id ) && isString( _id ) ) {\r\n            material._id = _id\r\n        }\r\n\r\n        const uuid = data.uuid\r\n        if ( isDefined( uuid ) && isString( uuid ) ) {\r\n            material.uuid = uuid\r\n        }\r\n\r\n        const name = data.name\r\n        if ( isDefined( name ) && isString( name ) ) {\r\n            material.name = name\r\n        }\r\n\r\n        const fog = data.fog\r\n        if ( isDefined( fog ) ) {\r\n            material.fog = fog\r\n        }\r\n\r\n        const lights = data.lights\r\n        if ( isDefined( lights ) ) {\r\n            material.lights = lights\r\n        }\r\n\r\n        const blending = data.blending\r\n        if ( isDefined( blending ) ) {\r\n            material.blending = blending\r\n        }\r\n\r\n        const side = data.side\r\n        if ( isDefined( side ) ) {\r\n            material.side = side\r\n        }\r\n\r\n        const flatShading = data.flatShading\r\n        if ( isDefined( flatShading ) ) {\r\n            material.flatShading = flatShading\r\n        }\r\n\r\n        const vertexColors = data.vertexColors\r\n        if ( isDefined( vertexColors ) ) {\r\n            material.vertexColors = vertexColors\r\n        }\r\n\r\n        const opacity = data.opacity\r\n        if ( isDefined( opacity ) ) {\r\n            material.opacity = opacity\r\n        }\r\n\r\n        const transparent = data.transparent\r\n        if ( isDefined( transparent ) ) {\r\n            material.transparent = transparent\r\n        }\r\n\r\n        const blendSrc = data.blendSrc\r\n        if ( isDefined( blendSrc ) ) {\r\n            material.blendSrc = blendSrc\r\n        }\r\n\r\n        const blendDst = data.blendDst\r\n        if ( isDefined( blendDst ) ) {\r\n            material.blendDst = blendDst\r\n        }\r\n\r\n        const blendEquation = data.blendEquation\r\n        if ( isDefined( blendEquation ) ) {\r\n            material.blendEquation = blendEquation\r\n        }\r\n\r\n        const blendSrcAlpha = data.blendSrcAlpha\r\n        if ( isDefined( blendSrcAlpha ) ) {\r\n            material.blendSrcAlpha = blendSrcAlpha\r\n        }\r\n\r\n        const blendDstAlpha = data.blendDstAlpha\r\n        if ( isDefined( blendDstAlpha ) ) {\r\n            material.blendDstAlpha = blendDstAlpha\r\n        }\r\n\r\n        const blendEquationAlpha = data.blendEquationAlpha\r\n        if ( isDefined( blendEquationAlpha ) ) {\r\n            material.blendEquationAlpha = blendEquationAlpha\r\n        }\r\n\r\n        const depthFunc = data.depthFunc\r\n        if ( isDefined( depthFunc ) ) {\r\n            material.depthFunc = depthFunc\r\n        }\r\n\r\n        const depthTest = data.depthTest\r\n        if ( isDefined( depthTest ) ) {\r\n            material.depthTest = depthTest\r\n        }\r\n\r\n        const depthWrite = data.depthWrite\r\n        if ( isDefined( depthWrite ) ) {\r\n            material.depthWrite = depthWrite\r\n        }\r\n\r\n        const clippingPlanes = data.clippingPlanes\r\n        if ( isDefined( clippingPlanes ) ) {\r\n            material.clippingPlanes = clippingPlanes\r\n        }\r\n\r\n        const clipIntersection = data.clipIntersection\r\n        if ( isDefined( clipIntersection ) ) {\r\n            material.clipIntersection = clipIntersection\r\n        }\r\n\r\n        const clipShadows = data.clipShadows\r\n        if ( isDefined( clipShadows ) ) {\r\n            material.clipShadows = clipShadows\r\n        }\r\n\r\n        const colorWrite = data.colorWrite\r\n        if ( isDefined( colorWrite ) ) {\r\n            material.colorWrite = colorWrite\r\n        }\r\n\r\n        const precision = data.precision\r\n        if ( isDefined( precision ) ) {\r\n            material.precision = precision\r\n        }\r\n\r\n        const polygonOffset = data.polygonOffset\r\n        if ( isDefined( polygonOffset ) ) {\r\n            material.polygonOffset = polygonOffset\r\n        }\r\n\r\n        const polygonOffsetFactor = data.polygonOffsetFactor\r\n        if ( isDefined( polygonOffsetFactor ) ) {\r\n            material.polygonOffsetFactor = polygonOffsetFactor\r\n        }\r\n\r\n        const polygonOffsetUnits = data.polygonOffsetUnits\r\n        if ( isDefined( polygonOffsetUnits ) ) {\r\n            material.polygonOffsetUnits = polygonOffsetUnits\r\n        }\r\n\r\n        const dithering = data.dithering\r\n        if ( isDefined( dithering ) ) {\r\n            material.dithering = dithering\r\n        }\r\n\r\n        const alphaTest = data.alphaTest\r\n        if ( isDefined( alphaTest ) ) {\r\n            material.alphaTest = alphaTest\r\n        }\r\n\r\n        const premultipliedAlpha = data.premultipliedAlpha\r\n        if ( isDefined( premultipliedAlpha ) ) {\r\n            material.premultipliedAlpha = premultipliedAlpha\r\n        }\r\n\r\n        const overdraw = data.overdraw\r\n        if ( isDefined( overdraw ) ) {\r\n            material.overdraw = overdraw\r\n        }\r\n\r\n        const visible = data.visible\r\n        if ( isDefined( visible ) ) {\r\n            material.visible = visible\r\n        }\r\n\r\n        const userData = data.userData\r\n        if ( isDefined( userData ) ) {\r\n            material.userData = userData\r\n        }\r\n\r\n        const needsUpdate = data.needsUpdate\r\n        if ( isDefined( needsUpdate ) ) {\r\n            material.needsUpdate = needsUpdate\r\n        }\r\n\r\n    }\r\n\r\n    _setVector2 ( vec2 ) {\r\n\r\n        const x = vec2.x\r\n        const y = vec2.y\r\n        if ( isNotDefined( x ) || isNotDefined( y ) ) {\r\n            throw new Error( 'MaterialsManager: Unable to convert null or undefined vector 2 !' )\r\n        }\r\n\r\n        return new Vector2( x, y )\r\n\r\n    }\r\n\r\n    _setColor ( color ) {\r\n\r\n        const r = color.r\r\n        const g = color.g\r\n        const b = color.b\r\n        if ( isNotDefined( r ) || isNotDefined( g ) || isNotDefined( b ) ) {\r\n            throw new Error( 'MaterialsManager: Unable to convert null or undefined color !' )\r\n        }\r\n\r\n        return new Color( r, g, b )\r\n\r\n    }\r\n\r\n    fillTextures ( materials, onSuccess, onProgress, onError ) {\r\n\r\n        const texturesMap = this._retrieveTexturesOf( materials )\r\n\r\n        for ( let key in materials ) {\r\n\r\n            const material = materials[ key ]\r\n            const textures = texturesMap[ key ]\r\n\r\n            for ( let textureKey in textures ) {\r\n                material[ textureKey ] = textures[ textureKey ]\r\n            }\r\n\r\n        }\r\n\r\n        // Don't forget to return all input object to callback,\r\n        // else some ids won't never be considered as processed !\r\n        onSuccess( materials )\r\n\r\n    }\r\n\r\n    _retrieveTexturesOf ( materials ) {\r\n\r\n        const availableTextures = [ 'map', 'lightMap', 'aoMap', 'emissiveMap', 'bumpMap', 'normalMap', 'displacementMap', 'specularMap', 'alphaMap', 'envMap' ]\r\n        const texturesMap       = {}\r\n        const localCache        = {}\r\n\r\n        for ( let id in materials ) {\r\n\r\n            const material = materials[ id ]\r\n\r\n            let textures = {}\r\n            for ( let i = 0, numberOfAvailableTextures = availableTextures.length ; i < numberOfAvailableTextures ; i++ ) {\r\n                let mapType = availableTextures[ i ]\r\n\r\n                const map = material[ mapType ]\r\n                if ( isDefined( map ) && isString( map ) && isNotEmptyString( map ) ) {\r\n\r\n                    const texturePath  = `${this._texturesPath}/${map}`\r\n                    const cachedResult = localCache[ texturePath ]\r\n\r\n                    if ( isDefined( cachedResult ) ) {\r\n\r\n                        textures[ mapType ] = cachedResult\r\n\r\n                    } else {\r\n\r\n                        const texture = this._texturesProvider.load(\r\n                            texturePath,\r\n                            () => {},\r\n                            () => {},\r\n                            () => {\r\n\r\n                                if ( !texture.image ) {\r\n                                    texture.image       = DEFAULT_IMAGE\r\n                                    texture.needsUpdate = true\r\n                                }\r\n\r\n                            }\r\n                        )\r\n                        texture.name  = map\r\n\r\n                        if ( !this._generateMipmap ) {\r\n                            texture.generateMipmaps = false\r\n                            texture.magFilter       = LinearFilter\r\n                            texture.minFilter       = LinearFilter\r\n                        }\r\n\r\n                        localCache[ texturePath ] = texture\r\n                        textures[ mapType ]       = texture\r\n\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n\r\n            texturesMap[ id ] = textures\r\n\r\n        }\r\n\r\n        return texturesMap\r\n\r\n    }\r\n\r\n}\r\n\r\nexport { MaterialsManager }\r\n","/**\r\n * @author [Tristan Valcke]{@link https://github.com/Itee}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @class OrbitControlsHelper\r\n * @classdesc Todo...\r\n * @example Todo...\r\n *\r\n */\r\n\r\n/* eslint-env browser */\r\n\r\nimport {\r\n    BufferGeometry,\r\n    Color,\r\n    Float32BufferAttribute,\r\n    LineBasicMaterial,\r\n    LineSegments,\r\n    VertexColors\r\n} from 'three-full'\r\n\r\nclass OrbitControlsHelper extends LineSegments {\r\n\r\n    static _createInternalGeometry ( RADIUS, RADIALS, CIRCLES, DIVISIONS, color1, color2 ) {\r\n\r\n        const vertices = []\r\n        const colors   = []\r\n\r\n        let x, z, v, i, j, r, color\r\n\r\n        // create the radials\r\n        for ( i = 0 ; i <= RADIALS ; i++ ) {\r\n\r\n            v = ( i / RADIALS ) * ( Math.PI * 2 )\r\n\r\n            x = Math.sin( v ) * RADIUS\r\n            z = Math.cos( v ) * RADIUS\r\n\r\n            vertices.push( 0, 0, 0 )\r\n            vertices.push( x, 0, z )\r\n\r\n            color = ( i & 1 ) ? color1 : color2\r\n\r\n            colors.push( color.r, color.g, color.b )\r\n            colors.push( color.r, color.g, color.b )\r\n\r\n        }\r\n\r\n        // create the circles\r\n        for ( i = 0 ; i <= CIRCLES ; i++ ) {\r\n\r\n            color = ( i & 1 ) ? color1 : color2\r\n\r\n            r = RADIUS - ( RADIUS / CIRCLES * i )\r\n\r\n            for ( j = 0 ; j < DIVISIONS ; j++ ) {\r\n\r\n                // first vertex\r\n                v = ( j / DIVISIONS ) * ( Math.PI * 2 )\r\n\r\n                x = Math.sin( v ) * r\r\n                z = Math.cos( v ) * r\r\n\r\n                vertices.push( x, 0, z )\r\n                colors.push( color.r, color.g, color.b )\r\n\r\n                // second vertex\r\n                v = ( ( j + 1 ) / DIVISIONS ) * ( Math.PI * 2 )\r\n\r\n                x = Math.sin( v ) * r\r\n                z = Math.cos( v ) * r\r\n\r\n                vertices.push( x, 0, z )\r\n                colors.push( color.r, color.g, color.b )\r\n\r\n            }\r\n\r\n            // create axis\r\n            vertices.push(\r\n                -1, 0, 0, 1, 0, 0,\r\n                0, -1, 0, 0, 1, 0,\r\n                0, 0, -1, 0, 0, 1\r\n            )\r\n            colors.push(\r\n                1, 0, 0, 1, 0.6, 0,\r\n                0, 1, 0, 0.6, 1, 0,\r\n                0, 0, 1, 0, 0.6, 1\r\n            )\r\n\r\n        }\r\n\r\n        const positionBufferAttribute = new Float32BufferAttribute( vertices, 3 )\r\n        positionBufferAttribute.name  = 'TOrbitControlsHelperPositionBufferAttribute'\r\n\r\n        const colorBufferAttribute = new Float32BufferAttribute( colors, 3 )\r\n        colorBufferAttribute.name  = 'TOrbitControlsHelperColorBufferAttribute'\r\n\r\n        const geometry = new BufferGeometry()\r\n        geometry.addAttribute( 'position', positionBufferAttribute )\r\n        geometry.addAttribute( 'color', colorBufferAttribute )\r\n        geometry.name = 'TOrbitControlsHelperGeometry'\r\n\r\n        return geometry\r\n\r\n    }\r\n\r\n    static _createInternalMaterial () {\r\n\r\n        const material       = new LineBasicMaterial( { vertexColors: VertexColors } )\r\n        material.transparent = true\r\n        material.opacity     = 0.0\r\n        material.name        = 'TOrbitControlsHelperMaterial'\r\n\r\n        return material\r\n\r\n    }\r\n\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                radius:     2,\r\n                radials:    16,\r\n                circles:    2,\r\n                divisions:  64,\r\n                innerColor: new Color( 0x444444 ),\r\n                outerColor: new Color( 0x888888 )\r\n            }, ...parameters\r\n        }\r\n\r\n        super( OrbitControlsHelper._createInternalGeometry( _parameters.radius, _parameters.radials, _parameters.circles, _parameters.divisions, _parameters.innerColor, _parameters.outerColor ), OrbitControlsHelper._createInternalMaterial() )\r\n\r\n        //        this.control     = control\r\n        this._intervalId = undefined\r\n\r\n        //        this.impose()\r\n\r\n    }\r\n\r\n    startOpacityAnimation () {\r\n\r\n        // In case fade off is running, kill it an restore opacity to 1\r\n        if ( this._intervalId !== undefined ) {\r\n\r\n            clearInterval( this._intervalId )\r\n            this._intervalId = undefined\r\n\r\n        }\r\n\r\n        this.material.opacity = 1.0\r\n\r\n    }\r\n\r\n    endOpacityAnimation () {\r\n\r\n        // Manage transparency interval\r\n        this._intervalId = setInterval( function () {\r\n\r\n            if ( this.material.opacity <= 0.0 ) {\r\n\r\n                this.material.opacity = 0.0\r\n                clearInterval( this._intervalId )\r\n                this._intervalId = undefined\r\n\r\n            } else {\r\n\r\n                this.material.opacity -= 0.1\r\n\r\n            }\r\n\r\n        }.bind( this ), 100 )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport { OrbitControlsHelper }\r\n","/**\r\n * @author [Ahmed DCHAR]{@link https://github.com/Dragoneel}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @class ClassName\r\n * @classdesc Todo...\r\n * @example Todo...\r\n *\r\n */\r\n\r\n/* eslint-env browser */\r\n\r\nimport {\r\n    DefaultLogger as TLogger,\r\n    ResponseType,\r\n    TDataBaseManager\r\n} from 'itee-client'\r\nimport {\r\n    isNotDefined,\r\n    isObject\r\n} from 'itee-validators'\r\nimport {\r\n    BufferGeometry,\r\n    Float32BufferAttribute,\r\n    Line,\r\n    LineBasicMaterial,\r\n    Mesh,\r\n    MeshPhongMaterial,\r\n    SphereBufferGeometry\r\n} from 'three-full'\r\n\r\nclass FilairesManager extends TDataBaseManager {\r\n\r\n    /**\r\n     *\r\n     * @param basePath\r\n     * @param responseType\r\n     * @param bunchSize\r\n     * @param progressManager\r\n     * @param errorManager\r\n     */\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                basePath:               '/',\r\n                responseType:           ResponseType.Json,\r\n                bunchSize:              500,\r\n                requestAggregationTime: 200,\r\n                requestsConcurrency:    6,\r\n                logger:                 TLogger\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n\r\n    }\r\n\r\n    //// Methods\r\n\r\n    _onJson ( jsonData, onSuccess, onProgress, onError ) {\r\n\r\n        // Normalize to array\r\n        const datas   = ( isObject( jsonData ) ) ? [ jsonData ] : jsonData\r\n        const results = {}\r\n\r\n        for ( let dataIndex = 0, numberOfDatas = datas.length, data = undefined ; dataIndex < numberOfDatas ; dataIndex++ ) {\r\n\r\n            data = datas[ dataIndex ]\r\n\r\n            try {\r\n                results[ data.id ] = this.convert( data )\r\n            } catch ( err ) {\r\n                onError( err )\r\n            }\r\n\r\n            onProgress( new ProgressEvent( 'FilairesManager', {\r\n                lengthComputable: true,\r\n                loaded:           dataIndex + 1,\r\n                total:            numberOfDatas\r\n            } ) )\r\n\r\n        }\r\n\r\n        onSuccess( results )\r\n\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @return {*}\r\n     */\r\n    convert ( data ) {\r\n\r\n        if ( !data ) {\r\n            throw new Error( 'FilairesManager: Unable to convert null or undefined data !' )\r\n        }\r\n\r\n        const objectType = data.type\r\n        let object       = null\r\n\r\n        if ( isNotDefined( objectType ) ) {\r\n            throw new Error( `TFilaireManager.convert() : data type must be defined !!!` )\r\n        }\r\n\r\n        switch ( objectType ) {\r\n\r\n            case 'NaissanceVoute':\r\n                object = this._parseFilaire( data, 0x875100 )\r\n                break\r\n\r\n            case 'Radier':\r\n                object = this._parseFilaire( data, 0x0089af )\r\n                break\r\n\r\n            case 'Intrados':\r\n                object = this._parseFilaire( data, 0xc100b4 )\r\n                break\r\n\r\n            case 'Br':\r\n            case 'Bp':\r\n            case 'Src':\r\n                object = this._parsePoint( data, 0x00ff00 )\r\n                break\r\n\r\n            default:\r\n                throw new Error( `TFilaireManager: Unknown object of type: ${objectType}` )\r\n\r\n        }\r\n\r\n        return object\r\n\r\n    }\r\n\r\n    _parseFilaire ( data, color ) {\r\n\r\n        const geoJson   = JSON.parse( data.geojson )\r\n        const positions = geoJson.coordinates.reduce( ( acc, val ) => acc.concat( val ), [] )\r\n\r\n        if ( isNotDefined( positions ) ) {\r\n            throw new Error( `TFilaireManager._parseFilaire() : ${data.type} geometry doesn't contains coordinates !!!` )\r\n        }\r\n\r\n        const material = new LineBasicMaterial( {\r\n            color: color\r\n        } )\r\n\r\n        const bufferGeometry = new BufferGeometry()\r\n        bufferGeometry.addAttribute( 'position', new Float32BufferAttribute( positions, 3 ) )\r\n\r\n        let object = new Line( bufferGeometry, material )\r\n        if ( !isNotDefined( data.type ) ) {\r\n            object.name = ''.concat( data.type, '_' ).concat( data.numero_bloc, '_' ).concat( data.id )\r\n        } else {\r\n            object.name = ''.concat( data.id )\r\n        }\r\n\r\n        return object\r\n\r\n    }\r\n\r\n    _parsePoint ( data, color ) {\r\n\r\n        const geoJson   = JSON.parse( data.geojson )\r\n        const positions = geoJson.coordinates.reduce( ( acc, val ) => acc.concat( val ), [] )\r\n\r\n        if ( isNotDefined( positions ) ) {\r\n            throw new Error( 'FilairesManager._parsePoint() : '.concat( data.type, ' geometry doesn\\'t contains coordinates !!!' ) )\r\n        }\r\n\r\n        let geometry = new SphereBufferGeometry( parseFloat( data.attribut ), 50, 50, 0, Math.PI * 2, 0, Math.PI * 2 )\r\n        geometry.computeVertexNormals()\r\n\r\n        let material = new MeshPhongMaterial( { color: color } )\r\n        let object   = new Mesh( geometry, material )\r\n\r\n        object.position.set( positions[ '0' ], positions[ '1' ], positions[ '2' ] )\r\n\r\n        if ( !isNotDefined( data.type ) ) {\r\n            object.name = ''.concat( data.type, '_' ).concat( data.numero_bloc, '_' ).concat( data.id )\r\n        } else {\r\n            object.name = ''.concat( data.id )\r\n        }\r\n\r\n        return object\r\n\r\n    }\r\n\r\n}\r\n\r\nexport { FilairesManager }\r\n","/**\r\n * @author [Tristan Valcke]{@link https://github.com/Itee}\r\n * @license [BSD-3-Clause]{@link https://opensource.org/licenses/BSD-3-Clause}\r\n *\r\n * @class ClassName\r\n * @classdesc Todo...\r\n * @example Todo...\r\n *\r\n */\r\n\r\n/* eslint-env browser */\r\n\r\nimport { TDataBaseManager }   from 'itee-client'\r\nimport {\r\n    isDefined,\r\n    isNotBoolean,\r\n    isNotEmptyArray,\r\n    isNull,\r\n    isUndefined\r\n}                            from 'itee-validators'\r\nimport {\r\n    AmbientLight,\r\n    Color,\r\n    DirectionalLight,\r\n    Fog,\r\n    FogExp2,\r\n    Group,\r\n    HemisphereLight,\r\n    Line,\r\n    LineLoop,\r\n    LineSegments,\r\n    LOD,\r\n    Mesh,\r\n    Object3D,\r\n    OrthographicCamera,\r\n    PerspectiveCamera,\r\n    PointLight,\r\n    Points,\r\n    RectAreaLight,\r\n    Scene,\r\n    SkinnedMesh,\r\n    SpotLight,\r\n    Sprite\r\n}                            from 'three-full'\r\nimport { GeometriesManager } from './GeometriesManager'\r\nimport { MaterialsManager }  from './MaterialsManager'\r\n\r\nclass ObjectsManager extends TDataBaseManager {\r\n\r\n    /**\r\n     *\r\n     * @param parameters\r\n     */\r\n    constructor ( parameters = {} ) {\r\n\r\n        const _parameters = {\r\n            ...{\r\n                basePath:           '/objects',\r\n                geometriesProvider: new GeometriesManager(),\r\n                materialsProvider:  new MaterialsManager(),\r\n                projectionSystem:   'zBack',\r\n                globalScale:        1,\r\n                autoFillObjects3D:  true\r\n            }, ...parameters\r\n        }\r\n\r\n        super( _parameters )\r\n\r\n        this.geometriesProvider = _parameters.geometriesProvider\r\n        this.materialsProvider  = _parameters.materialsProvider\r\n        this.projectionSystem   = _parameters.projectionSystem\r\n        this.globalScale        = _parameters.globalScale\r\n        this.autoFillObjects3D  = _parameters.autoFillObjects3D\r\n\r\n    }\r\n\r\n    //// Getter/Setter\r\n\r\n    get geometriesProvider () {\r\n        return this._geometriesProvider\r\n    }\r\n\r\n    set geometriesProvider ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Geometries provider cannot be null ! Expect an instance of GeometriesManager.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Geometries provider cannot be undefined ! Expect an instance of GeometriesManager.' ) }\r\n        if ( !( value instanceof GeometriesManager ) ) { throw new TypeError( `Geometries provider cannot be an instance of ${value.constructor.name} ! Expect an instance of TGeometriesManager.` ) }\r\n\r\n        this._geometriesProvider = value\r\n\r\n    }\r\n\r\n    get materialsProvider () {\r\n        return this._materialsProvider\r\n    }\r\n\r\n    set materialsProvider ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Materials provider cannot be null ! Expect an instance of MaterialsManager.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Materials provider cannot be undefined ! Expect an instance of MaterialsManager.' ) }\r\n        if ( !( value instanceof MaterialsManager ) ) { throw new TypeError( `Materials provider cannot be an instance of ${value.constructor.name} ! Expect an instance of TMaterialsManager.` ) }\r\n\r\n        this._materialsProvider = value\r\n\r\n    }\r\n\r\n    get projectionSystem () {\r\n        return this._projectionSystem\r\n    }\r\n\r\n    set projectionSystem ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Projection system cannot be null ! Expect a positive number.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Projection system cannot be undefined ! Expect a positive number.' ) }\r\n\r\n        this._projectionSystem = value\r\n\r\n    }\r\n\r\n    get globalScale () {\r\n        return this._globalScale\r\n    }\r\n\r\n    set globalScale ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Global scale cannot be null ! Expect a positive number.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Global scale cannot be undefined ! Expect a positive number.' ) }\r\n\r\n        this._globalScale = value\r\n\r\n    }\r\n\r\n    get autoFillObjects3D () {\r\n        return this._autoFillObjects3D\r\n    }\r\n\r\n    set autoFillObjects3D ( value ) {\r\n\r\n        if ( isNull( value ) ) { throw new TypeError( 'Global scale cannot be null ! Expect a boolean.' ) }\r\n        if ( isUndefined( value ) ) { throw new TypeError( 'Global scale cannot be undefined ! Expect a positive number.' ) }\r\n        if ( isNotBoolean( value ) ) { throw new TypeError( 'Global scale cannot be null ! Expect a boolean.' ) }\r\n\r\n        this._autoFillObjects3D = value\r\n\r\n    }\r\n\r\n    setGeometriesProvider ( value ) {\r\n\r\n        this.geometriesProvider = value\r\n        return this\r\n\r\n    }\r\n\r\n    setMaterialsProvider ( value ) {\r\n\r\n        this.materialsProvider = value\r\n        return this\r\n\r\n    }\r\n\r\n    setProjectionSystem ( value ) {\r\n\r\n        this.projectionSystem = value\r\n        return this\r\n\r\n    }\r\n\r\n    setGlobalScale ( value ) {\r\n\r\n        this.globalScale = value\r\n        return this\r\n\r\n    }\r\n\r\n    setAutoFillObjects3D ( value ) {\r\n\r\n        this.autoFillObjects3D = value\r\n        return this\r\n\r\n    }\r\n\r\n    //// Methods\r\n\r\n    _onJson ( jsonData, onSuccess, onProgress, onError ) {\r\n\r\n        // Convert data from db to instanced object and add them into a map\r\n        const results = {}\r\n        for ( let dataIndex = 0, numberOfDatas = jsonData.length, data = undefined ; dataIndex < numberOfDatas ; dataIndex++ ) {\r\n\r\n            data = jsonData[ dataIndex ]\r\n\r\n            try {\r\n                results[ data._id ] = this.convert( data )\r\n            } catch ( err ) {\r\n                onError( err )\r\n            }\r\n\r\n            onProgress( new ProgressEvent( 'ObjectsManager', {\r\n                lengthComputable: true,\r\n                loaded:           dataIndex + 1,\r\n                total:            numberOfDatas\r\n            } ) )\r\n\r\n        }\r\n\r\n        // In case autoFill is true query materials and geometry\r\n        if ( this._autoFillObjects3D ) {\r\n            this.fillObjects3D( results, onSuccess, onProgress, onError )\r\n        } else {\r\n            onSuccess( results )\r\n        }\r\n\r\n    }\r\n\r\n    _onArrayBuffer ( data, onSuccess, onProgress, onError ) {}\r\n\r\n    _onBlob ( data, onSuccess, onProgress, onError ) {}\r\n\r\n    _onText ( data, onSuccess, onProgress, onError ) {}\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @return {*}\r\n     */\r\n    convert ( data ) {\r\n\r\n        if ( !data ) {\r\n            throw new Error( 'ObjectsManager: Unable to convert null or undefined data !' )\r\n        }\r\n\r\n        const objectType = data.type\r\n        let object       = null\r\n\r\n        // Todo: Use factory instead and allow user to register its own object type !!!\r\n        switch ( objectType ) {\r\n\r\n            case 'Object3D':\r\n                object = new Object3D()\r\n                this._fillBaseObjectsData( object, data )\r\n                break\r\n\r\n            case 'Scene':\r\n                object = new Scene()\r\n                this._fillBaseObjectsData( object, data )\r\n                if ( isDefined( data.background ) ) {\r\n\r\n                    if ( Number.isInteger( data.background ) ) {\r\n\r\n                        object.background = new Color( data.background )\r\n\r\n                    }\r\n\r\n                }\r\n                if ( isDefined( data.fog ) ) {\r\n\r\n                    if ( data.fog.type === 'Fog' ) {\r\n\r\n                        object.fog = new Fog( data.fog.color, data.fog.near, data.fog.far )\r\n\r\n                    } else if ( data.fog.type === 'FogExp2' ) {\r\n\r\n                        object.fog = new FogExp2( data.fog.color, data.fog.density )\r\n\r\n                    }\r\n\r\n                }\r\n                object.overrideMaterial = data.overrideMaterial\r\n                object.autoUpdate       = data.autoUpdate\r\n                break\r\n\r\n            case 'PerspectiveCamera':\r\n                object = new PerspectiveCamera()\r\n                this._fillBaseObjectsData( object, data )\r\n                object.fov    = data.fov\r\n                object.aspect = data.aspect\r\n                object.near   = data.near\r\n                object.far    = data.far\r\n                if ( isDefined( data.focus ) ) {\r\n                    object.focus = data.focus\r\n                }\r\n                if ( isDefined( data.zoom ) ) {\r\n                    object.zoom = data.zoom\r\n                }\r\n                if ( isDefined( data.filmGauge ) ) {\r\n                    object.filmGauge = data.filmGauge\r\n                }\r\n                if ( isDefined( data.filmOffset ) ) {\r\n                    object.filmOffset = data.filmOffset\r\n                }\r\n                if ( isDefined( data.view ) ) {\r\n                    object.view = Object.assign( {}, data.view )\r\n                }\r\n                break\r\n\r\n            case 'OrthographicCamera':\r\n                object = new OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far )\r\n                this._fillBaseObjectsData( object, data )\r\n                break\r\n\r\n            case 'AmbientLight':\r\n                object = new AmbientLight( data.color, data.intensity )\r\n                this._fillBaseObjectsData( object, data )\r\n                break\r\n\r\n            case 'DirectionalLight':\r\n                object = new DirectionalLight( data.color, data.intensity )\r\n                this._fillBaseObjectsData( object, data )\r\n                break\r\n\r\n            case 'PointLight':\r\n                object = new PointLight( data.color, data.intensity, data.distance, data.decay )\r\n                this._fillBaseObjectsData( object, data )\r\n                break\r\n\r\n            case 'RectAreaLight':\r\n                object = new RectAreaLight( data.color, data.intensity, data.width, data.height )\r\n                this._fillBaseObjectsData( object, data )\r\n                break\r\n\r\n            case 'SpotLight':\r\n                object = new SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay )\r\n                this._fillBaseObjectsData( object, data )\r\n                break\r\n\r\n            case 'HemisphereLight':\r\n                object = new HemisphereLight( data.color, data.groundColor, data.intensity )\r\n                this._fillBaseObjectsData( object, data )\r\n                break\r\n\r\n            case 'SkinnedMesh':\r\n                object = new SkinnedMesh()\r\n                this._fillBaseObjectsData( object, data )\r\n                object.geometry          = data.geometry\r\n                object.material          = data.material\r\n                object.drawMode          = data.drawMode\r\n                object.bindMode          = data.bindMode\r\n                object.bindMatrix        = data.bindMatrix\r\n                object.bindMatrixInverse = data.bindMatrixInverse\r\n                break\r\n\r\n            case 'Mesh':\r\n                object = new Mesh()\r\n                this._fillBaseObjectsData( object, data )\r\n                object.geometry = data.geometry\r\n                object.material = data.material\r\n                object.drawMode = data.drawMode\r\n                break\r\n\r\n            case 'LOD':\r\n                object = new LOD()\r\n                this._fillBaseObjectsData( object, data )\r\n                object.levels = data.levels\r\n                break\r\n\r\n            case 'Line':\r\n                object = new Line()\r\n                this._fillBaseObjectsData( object, data )\r\n                object.geometry = data.geometry\r\n                object.material = data.material\r\n                object.drawMode = data.drawMode\r\n                break\r\n\r\n            case 'LineLoop':\r\n                object = new LineLoop()\r\n                this._fillBaseObjectsData( object, data )\r\n                object.geometry = data.geometry\r\n                object.material = data.material\r\n                object.drawMode = data.drawMode\r\n                break\r\n\r\n            case 'LineSegments':\r\n                object = new LineSegments()\r\n                this._fillBaseObjectsData( object, data )\r\n                object.geometry = data.geometry\r\n                object.material = data.material\r\n                object.drawMode = data.drawMode\r\n                break\r\n\r\n            case 'Points':\r\n                object = new Points()\r\n                this._fillBaseObjectsData( object, data )\r\n                object.geometry = data.geometry\r\n                object.material = data.material\r\n                object.drawMode = data.drawMode\r\n                break\r\n\r\n            case 'Sprite':\r\n                object = new Sprite()\r\n                this._fillBaseObjectsData( object, data )\r\n                object.material = data.material\r\n                break\r\n\r\n            case 'Group':\r\n                object = new Group()\r\n                this._fillBaseObjectsData( object, data )\r\n                break\r\n\r\n            default:\r\n                throw new Error( `TObjectsManager: Unknown object of type: ${objectType}` )\r\n                break\r\n\r\n        }\r\n\r\n        return object\r\n\r\n    }\r\n\r\n    _fillBaseObjectsData ( object, data ) {\r\n\r\n        // Common object properties\r\n        object._id = data._id\r\n\r\n        if ( isDefined( data.uuid ) ) {\r\n            object.uuid = data.uuid\r\n        }\r\n\r\n        if ( isDefined( data.name ) ) {\r\n            object.name = data.name\r\n        }\r\n\r\n        // IMPLICIT\r\n        //        if ( isDefined( data.type ) ) {\r\n        //            object.type = data.type\r\n        //        }\r\n\r\n        if ( isDefined( data.parent ) ) {\r\n            object.parent = data.parent\r\n        }\r\n\r\n        if ( isNotEmptyArray( data.children ) ) {\r\n            object.children = data.children\r\n        }\r\n\r\n        if ( isDefined( data.up ) ) {\r\n            object.up.x = data.up.x\r\n            object.up.y = data.up.y\r\n            object.up.z = data.up.z\r\n        }\r\n\r\n        if ( isDefined( data.position ) ) {\r\n\r\n            if ( this._projectionSystem === 'zBack' ) {\r\n\r\n                object.position.x = data.position.x / this._globalScale\r\n                object.position.y = data.position.z / this._globalScale\r\n                object.position.z = -data.position.y / this._globalScale\r\n\r\n            } else {\r\n\r\n                object.position.x = data.position.x / this._globalScale\r\n                object.position.y = data.position.y / this._globalScale\r\n                object.position.z = data.position.z / this._globalScale\r\n\r\n            }\r\n\r\n        }\r\n\r\n        if ( isDefined( data.rotation ) ) {\r\n\r\n            if ( this._projectionSystem === 'zBack' ) {\r\n\r\n                object.rotation.x     = data.rotation.x\r\n                object.rotation.y     = data.rotation.z\r\n                object.rotation.z     = -data.rotation.y\r\n                object.rotation.order = data.rotation.order\r\n\r\n            } else {\r\n\r\n                object.rotation.x     = data.rotation.x\r\n                object.rotation.y     = data.rotation.y\r\n                object.rotation.z     = data.rotation.z\r\n                object.rotation.order = data.rotation.order\r\n\r\n            }\r\n\r\n        }\r\n\r\n        if ( isDefined( data.quaternion ) ) {\r\n\r\n            if ( this._projectionSystem === 'zBack' ) {\r\n\r\n                object.quaternion.x = data.quaternion.x\r\n                object.quaternion.y = data.quaternion.z\r\n                object.quaternion.z = -data.quaternion.y\r\n                object.quaternion.w = data.quaternion.w\r\n\r\n            } else {\r\n\r\n                object.quaternion.x = data.quaternion.x\r\n                object.quaternion.y = data.quaternion.y\r\n                object.quaternion.z = data.quaternion.z\r\n                object.quaternion.w = data.quaternion.w\r\n\r\n            }\r\n\r\n        }\r\n\r\n        if ( isDefined( data.scale ) ) {\r\n\r\n            if ( data.scale.x !== 0 && data.scale.y !== 0 && data.scale.z !== 0 ) {\r\n                object.scale.x = data.scale.x\r\n                object.scale.y = data.scale.y\r\n                object.scale.z = data.scale.z\r\n            } else {\r\n                console.warn( 'Try to assign null scale !' )\r\n            }\r\n\r\n        }\r\n\r\n        if ( isDefined( data.modelViewMatrix ) && isNotEmptyArray( data.modelViewMatrix ) ) {\r\n            object.modelViewMatrix.fromArray( data.modelViewMatrix )\r\n        }\r\n\r\n        if ( isDefined( data.normalMatrix ) && isNotEmptyArray( data.normalMatrix ) ) {\r\n            object.normalMatrix.fromArray( data.normalMatrix )\r\n        }\r\n\r\n        if ( isDefined( data.matrix ) && isNotEmptyArray( data.matrix ) ) {\r\n            object.matrix.fromArray( data.matrix )\r\n        }\r\n\r\n        if ( isDefined( data.matrixWorld ) && isNotEmptyArray( data.matrixWorld ) ) {\r\n            object.matrixWorld.fromArray( data.matrixWorld )\r\n        }\r\n\r\n        if ( isDefined( data.matrixAutoUpdate ) ) {\r\n            object.matrixAutoUpdate = data.matrixAutoUpdate\r\n        }\r\n\r\n        if ( isDefined( data.matrixWorldNeedsUpdate ) ) {\r\n            object.matrixWorldNeedsUpdate = data.matrixWorldNeedsUpdate\r\n        }\r\n\r\n        if ( isDefined( data.layers ) ) {\r\n            object.layers.mask = data.layers\r\n        }\r\n\r\n        if ( isDefined( data.visible ) ) {\r\n            object.visible = data.visible\r\n        }\r\n\r\n        if ( isDefined( data.castShadow ) ) {\r\n            object.castShadow = data.castShadow\r\n        }\r\n\r\n        if ( isDefined( data.receiveShadow ) ) {\r\n            object.receiveShadow = data.receiveShadow\r\n        }\r\n\r\n        if ( isDefined( data.frustumCulled ) ) {\r\n            object.frustumCulled = data.frustumCulled\r\n        }\r\n\r\n        if ( isDefined( data.renderOrder ) ) {\r\n            object.renderOrder = data.renderOrder\r\n        }\r\n\r\n        if ( isDefined( data.userData ) ) {\r\n            object.userData = data.userData\r\n        }\r\n\r\n    }\r\n\r\n    //// Callback\r\n\r\n    fillObjects3D ( objects, onSuccess, onProgress, onError ) {\r\n\r\n        const self = this\r\n\r\n        // Get objects that need geometry or materials\r\n        const objectsArray = []\r\n        for ( let id in objects ) {\r\n\r\n            const object = objects[ id ]\r\n            if ( object.geometry || object.material ) {\r\n                objectsArray.push( objects[ id ] )\r\n            }\r\n\r\n        }\r\n\r\n        // In case no objects need to be filled return result\r\n        if ( objectsArray.length === 0 ) {\r\n            onSuccess( objects )\r\n            return\r\n        }\r\n\r\n        // Else fill geometries and materials for filtered objects\r\n        let geometriesMap = undefined\r\n        this._retrieveGeometriesOf( objectsArray, ( geometries ) => {\r\n            geometriesMap = geometries\r\n            onEndDataFetching()\r\n        }, onProgress, onError )\r\n\r\n        let materialsMap = undefined\r\n        this._retrieveMaterialsOf( objectsArray, ( materials ) => {\r\n            materialsMap = materials\r\n            onEndDataFetching()\r\n        }, onProgress, onError )\r\n\r\n        function onEndDataFetching () {\r\n\r\n            if ( !geometriesMap || !materialsMap ) { return }\r\n\r\n            for ( let key in objects ) {\r\n                const mesh = objects[ key ]\r\n                self.applyGeometry( mesh, geometriesMap )\r\n                self.applyMaterials( mesh, materialsMap )\r\n            }\r\n\r\n            // Don't forget to return all input object to callback,\r\n            // else some ids won't never be considered as processed !\r\n            onSuccess( objects )\r\n\r\n        }\r\n\r\n    }\r\n\r\n    _retrieveGeometriesOf ( meshes, onSuccess, onProgress, onError ) {\r\n\r\n        const geometriesIds = meshes.map( object => object.geometry )\r\n                                    .filter( ( value, index, self ) => {\r\n                                        return value && self.indexOf( value ) === index\r\n                                    } )\r\n\r\n        if ( geometriesIds.length === 0 ) {\r\n            onSuccess( {} )\r\n            return\r\n        }\r\n\r\n        this._geometriesProvider.read(\r\n            geometriesIds,\r\n            null,\r\n            onSuccess,\r\n            onProgress,\r\n            onError\r\n        )\r\n\r\n    }\r\n\r\n    _retrieveMaterialsOf ( meshes, onSuccess, onProgress, onError ) {\r\n\r\n        const materialsArray       = meshes.map( object => object.material )\r\n        const concatMaterialsArray = [].concat.apply( [], materialsArray )\r\n        const materialsIds         = concatMaterialsArray.filter( ( value, index, self ) => {\r\n            return value && self.indexOf( value ) === index\r\n        } )\r\n\r\n        if ( materialsIds.length === 0 ) {\r\n            onSuccess( {} )\r\n            return\r\n        }\r\n\r\n        this._materialsProvider.read(\r\n            materialsIds,\r\n            null,\r\n            onSuccess,\r\n            onProgress,\r\n            onError\r\n        )\r\n\r\n    }\r\n\r\n    /*\r\n     ///// PROMISE\r\n\r\n     async fillObjects3DByPromises ( objects, onSuccess, onProgress, onError ) {\r\n\r\n     const self         = this\r\n     const objectsArray = []\r\n     for ( let id in objects ) {\r\n     objectsArray.push( objects[ id ] )\r\n     }\r\n\r\n     const [ geometriesMap, materialsMap ] = await Promise.all( [\r\n     this._getGeometriesPromiseOf( objectsArray, onProgress, onError ),\r\n     this._getMaterialsPromiseOf( objectsArray, onProgress, onError )\r\n     ] )\r\n\r\n     for ( let key in objects ) {\r\n     const mesh = objects[ key ]\r\n     self.applyGeometry( mesh, geometriesMap )\r\n     self.applyMaterials( mesh, materialsMap )\r\n     }\r\n\r\n     // Don't forget to return all input object to callback,\r\n     // else some ids won't never be considered as processed !\r\n     onSuccess( objects )\r\n\r\n     }\r\n\r\n     _getGeometriesPromiseOf ( meshes, onProgress, onError ) {\r\n\r\n     const self = this\r\n\r\n     return new Promise( function ( resolve, reject ) {\r\n\r\n     const geometriesIds = meshes.map( object => object.geometry )\r\n     .filter( ( value, index, self ) => {\r\n     return value && self.indexOf( value ) === index\r\n     } )\r\n\r\n     if ( geometriesIds.length === 0 ) {\r\n     resolve( {} )\r\n     return\r\n     }\r\n\r\n     self._geometriesProvider.read(\r\n     geometriesIds,\r\n     null,\r\n     geometries => {\r\n     resolve( geometries )\r\n     },\r\n     onProgress,\r\n     onError\r\n     )\r\n\r\n     } )\r\n\r\n     }\r\n\r\n     _getMaterialsPromiseOf ( meshes, onProgress, onError ) {\r\n\r\n     const self = this\r\n\r\n     return new Promise( function ( resolve, reject ) {\r\n\r\n     const materialsArray       = meshes.map( object => object.material )\r\n     const concatMaterialsArray = [].concat.apply( [], materialsArray )\r\n     const materialsIds         = concatMaterialsArray.filter( ( value, index, self ) => {\r\n     return value && self.indexOf( value ) === index\r\n     } )\r\n\r\n     if ( materialsIds.length === 0 ) {\r\n     resolve( {} )\r\n     return\r\n     }\r\n\r\n     self._materialsProvider.read(\r\n     materialsIds,\r\n     null,\r\n     materials => {\r\n     resolve( materials )\r\n     },\r\n     onProgress,\r\n     onError\r\n     )\r\n\r\n     } )\r\n\r\n     }\r\n\r\n     ///// ASYNC\r\n\r\n     async fillObjects3D ( objects, onSuccess, onProgress, onError ) {\r\n\r\n     const self         = this\r\n     const objectsArray = []\r\n     for ( let id in objects ) {\r\n\r\n     const object = objects[ id ]\r\n     if ( object.geometry || object.material ) {\r\n     objectsArray.push( objects[ id ] )\r\n     }\r\n\r\n     }\r\n\r\n     if ( objectsArray.length === 0 ) {\r\n     onSuccess( objects )\r\n     return\r\n     }\r\n\r\n     let geometriesMap = undefined\r\n     this._retrieveGeometriesOf( objectsArray, ( geometries ) => {\r\n     geometriesMap = geometries\r\n     onEndDataFetching()\r\n     }, onProgress, onError )\r\n\r\n     let materialsMap = undefined\r\n     this._retrieveMaterialsOf( objectsArray, ( materials ) => {\r\n     materialsMap = materials\r\n     onEndDataFetching()\r\n     }, onProgress, onError )\r\n\r\n     function onEndDataFetching () {\r\n\r\n     if ( !geometriesMap || !materialsMap ) { return }\r\n\r\n     for ( let key in objects ) {\r\n     const mesh = objects[ key ]\r\n     self.applyGeometry( mesh, geometriesMap )\r\n     self.applyMaterials( mesh, materialsMap )\r\n     }\r\n\r\n     // Don't forget to return all input object to callback,\r\n     // else some ids won't never be considered as processed !\r\n     onSuccess( objects )\r\n\r\n     }\r\n\r\n     }\r\n\r\n     _retrieveGeometriesOf ( meshes, onSucess, onProgress, onError ) {\r\n\r\n     const geometriesIds = meshes.map( object => object.geometry )\r\n     .filter( ( value, index, self ) => {\r\n     return value && self.indexOf( value ) === index\r\n     } )\r\n\r\n     if ( geometriesIds.length === 0 ) {\r\n     onSucess( {} )\r\n     return\r\n     }\r\n\r\n     this._geometriesProvider.read(\r\n     geometriesIds,\r\n     null,\r\n     onSucess,\r\n     onProgress,\r\n     onError\r\n     )\r\n\r\n     }\r\n\r\n     _retrieveMaterialsOf ( meshes, onSucess, onProgress, onError ) {\r\n\r\n     const materialsArray       = meshes.map( object => object.material )\r\n     const concatMaterialsArray = [].concat.apply( [], materialsArray )\r\n     const materialsIds         = concatMaterialsArray.filter( ( value, index, self ) => {\r\n     return value && self.indexOf( value ) === index\r\n     } )\r\n\r\n     if ( materialsIds.length === 0 ) {\r\n     onSucess( {} )\r\n     return\r\n     }\r\n\r\n     this._materialsProvider.read(\r\n     materialsIds,\r\n     null,\r\n     onSucess,\r\n     onProgress,\r\n     onError\r\n     )\r\n\r\n     }\r\n\r\n     /////////////\r\n     */\r\n\r\n    applyGeometry ( object, geometries ) {\r\n\r\n        const geometryId = object.geometry\r\n        if ( !geometryId ) {\r\n            return\r\n        }\r\n\r\n        const geometry = geometries[ geometryId ]\r\n        if ( !geometry ) {\r\n            console.error( 'Unable to retrieve geometry !!!' )\r\n            return\r\n        }\r\n\r\n        object.geometry = geometry\r\n\r\n    }\r\n\r\n    applyMaterials ( object, materials ) {\r\n\r\n        const materialIds = object.material\r\n        if ( !materialIds ) {\r\n            return\r\n        }\r\n\r\n        if ( Array.isArray( materialIds ) ) {\r\n\r\n            if ( materialIds.length === 1 ) {\r\n\r\n                const materialId = materialIds[ 0 ]\r\n                const material   = materials[ materialId ]\r\n                if ( !material ) {\r\n                    console.error( 'Unable to retrieve material !!!' )\r\n                    return null\r\n                }\r\n\r\n                object.material = material.clone()\r\n\r\n            } else {\r\n\r\n                object.material = []\r\n                for ( let materialIndex = 0, numberOfMaterial = materialIds.length ; materialIndex < numberOfMaterial ; materialIndex++ ) {\r\n                    const materialId = materialIds[ materialIndex ]\r\n                    const material   = materials[ materialId ]\r\n                    if ( !material ) {\r\n                        console.error( 'Unable to retrieve material !!!' )\r\n                        return null\r\n                    }\r\n\r\n                    object.material.push( material.clone() )\r\n                }\r\n            }\r\n\r\n        } else if ( typeof materialIds === 'string' ) {\r\n\r\n            const material = materials[ materialIds ]\r\n            if ( !material ) {\r\n                console.error( 'Unable to retrieve material !!!' )\r\n                return\r\n            }\r\n\r\n            object.material = material.clone()\r\n\r\n        } else {\r\n\r\n            console.error( 'Invalid material ids, expected string or array of string' )\r\n\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport { ObjectsManager }\r\n"],"names":["FRONT","Vector3","BACK","UP","DOWN","RIGHT","LEFT","State","toEnum","None","Rotating","Panning","Rolling","Zooming","Moving","CameraControlMode","FirstPerson","Orbit","Fly","Path","PI_2","Math","PI","STATE","NONE","ROTATE","ZOOM","PAN","xVector","yVector","CameraPathController","parameters","_parameters","camera","target","Object3D","mode","domElement","window","self","this","currentState","cameraJump","paths","pathsMap","Map","currentPath","undefined","currentPathIndex","currentPathPosition","document","forwardControl","children","backwardControl","timeoutId","enabled","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","keyPanSpeed","verticalOffset","keysCodes","forwardKeys","Keys","Z","UP_ARROW","backwardKeys","S","BOTTOM_ARROW","mouseQuat","x","Quaternion","y","moveForward","TLogger","log","indexOfNextPath","get","update","dispatchEvent","type","moveBackward","indexOfPreviousPath","onKeyDown","event","pathCurrentPoint","getPointAt","pathDirection","sub","normalize","negate","dotProduct","getWorldDirection","dot","includes","keyCode","preventDefault","warn","onKeyUp","onMouseDown","button","mouseButtons","ORBIT","onMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","orientation","max","min","rotate","onMouseUp","MOUSE","MIDDLE","newPosition","position","z","setFromAxisAngle","quaternion","copy","multiply","dispose","removeEventListener","addEventListener","clearTimeout","setTimeout","bind","Object","assign","prototype","EventDispatcher","_camera","value","isNull","Error","isUndefined","Camera","constructor","name","[object Object]","path","getLength","nameOfFirstPathToFollow","pathToFollow","numberOfPaths","length","firstPath","startFirstPath","endFirstPath","secondPath","startSecondPath","endSecondPath","firstPathIndex","closestStartDistance","Infinity","closestEndDistance","indexOfClosestStartPath","indexOfClosestEndPath","secondPathIndex","distanceTo","set","setPath","quat","asin","nextPosition","getNextPathPosition","lookAt","setMouseQuat","numberOfPoints","currentPathPoints","closestPointIndex","closestPath","closestPathIndex","currentDistance","closestDistance","pathIndex","numberOfPath","floor","getSpacedPoints","pointIndex","lookAtPath","LineGeometry","BufferGeometry","pointA","pointB","super","addAttribute","Float32BufferAttribute","ClippingBox","LineSegments","geometry","EdgesGeometry","BoxBufferGeometry","material","LineBasicMaterial","color","normalPlanes","normalRightSide","normalLeftSide","normalFrontSide","normalBackSide","normalTopSide","normalBottomSide","planes","rightSidePlane","Plane","clone","leftSidePlane","frontSidePlane","backSidePlane","topSidePlane","bottomSidePlane","_boundingBox","Box3","computeBoundingSphere","boundingSphere","applyMatrix4","matrixWorld","state","objects","isNotDefined","i","push","traverse","object","materials","isArray","materialIndex","numberOfMaterial","clippingPlanes","size","scale","setFromObject","constant","HighlightableMaterial","MeshBasicMaterial","isHighlightableMaterial","depthTest","depthWrite","fog","side","DoubleSide","transparent","oldColor","highlighted","lum","_r","r","_g","g","_b","b","setRGB","HighlightableLineMaterial","linewidth","AbstractHitbox","Mesh","visible","isHitbox","CylindricaHitbox","cylinderGeometry","CylinderBufferGeometry","translate","isCylindricaHitbox","PlanarHitbox","planeBufferGeometry","setIndex","isPlanarHitbox","LozengeHitbox","positionBufferAttribute","lozengeBufferGeometry","OctahedricalHitbox","OctahedronBufferGeometry","isOctahedricalHitbox","TorusHitbox","TorusBufferGeometry","isTorusHitbox","AbstractHandle","hitbox","isHandle","baseQuaternion","line","child","setHex","_hitbox","add","childIndex","numberOfChildren","childMaterial","highlight","raycaster","intersects","intersections","intersectObject","distance","axis","angle","cameraDirection","TranslateHandle","direction","isTranslateHandle","lineGeometry","lineMaterial","Line","coneGeometry","ConeBufferGeometry","coneMaterial","cone","_direction","radians","acos","flipDirection","ScaleHandle","isScaleHandle","boxGeometry","boxMaterial","box","PlaneHandle","isPlaneHandle","lineBufferGeometry","planeMaterial","opacity","plane","xAxis","yAxis","zAxis","xDirection","yDirection","zDirection","xDot","yDot","zDot","rotateOnAxis","degreesToRadians","setX","setY","setZ","LozengeHandle","lozengeMaterial","lozenge","tempDirection","OctahedricalHandle","isOmnidirectionalHandle","octahedronGeometry","octahedronMaterial","octahedron","edgesGeometry","edgesMaterial","edges","AbstractGizmo","isGizmo","handles","planeGeometry","PlaneBufferGeometry","intersectPlane","gizmoMap","parent","element","isNotArray","renderOrder","rotation","tag","updateMatrix","tempGeometry","applyMatrix","matrix","setupGizmos","handleGizmos","key","currentHandle","cameraPosition","updateIntersectPlane","TranslateGizmo","isTranslateGizmo","X","Y","XY","setScale","YZ","setRotationFromAxisAndAngle","XZ","XYZ","init","ScaleGizmo","isScaleGizmo","ClippingModes","Translate","Rotate","Scale","BufferGeometriesManager","TDataBaseManager","call","basePath","CurvesManager","create","data","onError","texture","Scene","defineProperties","_onJson","jsonData","onSuccess","onProgress","datas","isObject","results","result","dataIndex","numberOfDatas","convert","_id","curveType","curve","ArcCurve","CatmullRomCurve3","CubicBezierCurve","CubicBezierCurve3","Curve","CurvePath","EllipseCurve","LineCurve","LineCurve3","QuadraticBezierCurve","QuadraticBezierCurve3","SplineCurve","Shape","fromJSON","err","ArrayType","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","GeometriesManager","projectionSystem","globalScale","computeNormals","computeBoundingBox","_computeBoundingBox","TypeError","isNotBoolean","_computeBoundingSphere","_computeNormals","_projectionSystem","_globalScale","ProgressEvent","lengthComputable","loaded","total","geometryType","isBufferGeometry","_convertJsonToBufferGeometry","computeVertexNormals","isGeometry","_convertJsonToGeometry","computeFaceNormals","boundingBox","types","BoxGeometry","CircleGeometry","CylinderGeometry","ConeGeometry","DodecahedronGeometry","ExtrudeGeometry","Geometry","IcosahedronGeometry","LatheGeometry","OctahedronGeometry","ParametricGeometry","PlaneGeometry","PolyhedronGeometry","RingGeometry","ShapeGeometry","TetrahedronGeometry","TextGeometry","TorusGeometry","TorusKnotGeometry","TubeGeometry","SphereGeometry","WireframeGeometry","uuid","vertices","vertex","index","numberOfVertices","faces","face","faceIndex","numberOfFaces","Face3","a","c","normal","morphTargets","morphNormals","skinWeights","skinIndices","lineDistances","elementsNeedUpdate","verticesNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","bufferGeometryType","bufferGeometry","CircleBufferGeometry","DodecahedronBufferGeometry","ExtrudeBufferGeometry","IcosahedronBufferGeometry","LatheBufferGeometry","ParametricBufferGeometry","PolyhedronBufferGeometry","RingBufferGeometry","TetrahedronBufferGeometry","TextBufferGeometry","TorusKnotBufferGeometry","TubeBufferGeometry","SphereBufferGeometry","InstancedBufferGeometry","dataIndexes","array","arrayBuffer","__convertBase64ToArrayBuffer","typedArray","__convertArrayBufferToTypedArray","BufferAttribute","itemSize","normalized","dataAttributes","attributes","positionAttributes","positionArray","pi","numPos","posIndex","normalAttributes","uvAttributes","uv","isDefined","groups","shapes","map","jsonShape","curveSegments","dataView","DataView","dataByteLength","byteLength","getUint8","offset","getInt8","getInt16","getUint16","getInt32","getUint32","getFloat32","getFloat64","RangeError","base64","chars","lookup","charCodeAt","base64Length","bufferLength","arraybuffer","ArrayBuffer","bytes","encoded1","encoded2","encoded3","encoded4","pointer","TexturesManager","textureType","DEFAULT_IMAGE","ImageLoader","load","MaterialsManager","texturesPath","texturesProvider","TextureLoader","generateMipmap","autoFillTextures","_texturesPath","isNotString","isEmptyString","isBlankString","_texturesProvider","_generateMipmap","_autoFillTextures","fillTextures","MeshPhongMaterial","_fillBaseMaterialData","_setColor","specular","shininess","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalScale","_setVector2","displacementMap","displacementScale","displacementBias","specularMap","alphaMap","envMap","combine","reflectivity","refractionRatio","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","skinning","MeshLambertMaterial","PointsMaterial","sizeAttenuation","isString","lights","blending","flatShading","vertexColors","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","clipIntersection","clipShadows","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaTest","premultipliedAlpha","overdraw","userData","needsUpdate","vec2","Vector2","Color","texturesMap","_retrieveTexturesOf","textures","textureKey","availableTextures","localCache","id","numberOfAvailableTextures","mapType","isNotEmptyString","texturePath","cachedResult","image","generateMipmaps","magFilter","LinearFilter","minFilter","OrbitControlsHelper","RADIUS","RADIALS","CIRCLES","DIVISIONS","color1","color2","colors","v","j","sin","cos","colorBufferAttribute","VertexColors","radius","radials","circles","divisions","innerColor","outerColor","_createInternalGeometry","_createInternalMaterial","_intervalId","clearInterval","setInterval","logger","DefaultLogger","_handlers","onMouseEnter","_onMouseEnter","onMouseLeave","_onMouseLeave","_onMouseDown","_onMouseMove","onMouseWheel","_onMouseWheel","_onMouseUp","onDblClick","_onDblClick","onTouchStart","_onTouchStart","onTouchEnd","_onTouchEnd","onTouchCancel","_onTouchCancel","onTouchLeave","_onTouchLeave","onTouchMove","_onTouchMove","_onKeyDown","_onKeyUp","_paths","_trackPath","_cameraJump","_currentPathPosition","_currentPathOffset","_currentPathIndex","_currentPath","_maxJump","_lockedTarget","previousTouches","canMove","moveSpeed","canFront","frontMinimum","frontMaximum","frontMinSpeed","frontSpeed","frontMaxSpeed","frontAcceleration","canBack","backMinimum","backMaximum","backMinSpeed","backSpeed","backMaxSpeed","backAcceleration","canUp","upMinimum","upMaximum","upMinSpeed","upSpeed","upMaxSpeed","upAcceleration","canDown","downMinimum","downMaximum","downMinSpeed","downSpeed","downMaxSpeed","downAcceleration","canLeft","leftMinimum","leftMaximum","leftMinSpeed","leftSpeed","leftMaxSpeed","leftAcceleration","canRight","rightMinimum","rightMaximum","rightMinSpeed","rightSpeed","rightMaxSpeed","rightAcceleration","canRotate","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","rotateMinSpeed","rotateMaxSpeed","rotateAcceleration","canPan","panMinimum","panMaximum","panMinSpeed","panSpeed","panMaxSpeed","panAcceleration","canRoll","rollMinimum","rollMaximum","rollMinSpeed","rollSpeed","rollMaxSpeed","rollAcceleration","canZoom","zoomMinimum","zoomMaximum","zoomMinSpeed","zoomMaxSpeed","zoomAcceleration","canLookAt","actionsMap","front","back","DOWN_ARROW","up","A","PAGE_UP","down","E","PAGE_DOWN","left","Q","LEFT_ARROW","right","D","RIGHT_ARROW","Mouse","pan","roll","R","T","zoom","WHEEL","lookAtFront","NUMPAD_2","lookAtFrontLeft","NUMPAD_3","lookAtFrontRight","NUMPAD_1","lookAtBack","NUMPAD_8","lookAtBackLeft","NUMPAD_9","lookAtBackRight","NUMPAD_7","lookAtUp","NUMPAD_5","lookAtDown","NUMPAD_0","lookAtLeft","NUMPAD_6","lookAtRight","NUMPAD_4","_state","_target","_mode","_initPathDisplacement","trackPath","_domElement","Window","HTMLDocument","HTMLDivElement","HTMLCanvasElement","impose","capture","once","passive","newCameraPosition","newTargetPosition","cancelable","stopImmediatePropagation","keyEvent","actionMap","_front","_consumeEvent","_back","_up","_down","_left","_right","_rotate","_pan","_roll","_zoom","_lookAt","touchEvent","touches","currentTouches","changedTouches","numberOfPreviousTouches","numberOfCurrentTouches","previousTouchA","clientX","clientY","previousTouchB","previousGap","previousCenter","addVectors","divideScalar","previousDirection","subVectors","currentTouchA","currentTouchB","currentGap","currentCenter","currentDirection","deltaPan","deltaZoom","deltaRoll","deltaRotate","mouseEvent","focus","blur","delta","wheelDelta","deltaY","applyQuaternion","displacement","_getPathDisplacement","multiplyScalar","targetPosition","targetToCamera","normalizedX","normalizedY","cameraToTargetDirection","dotProductUp","dotProductRight","lockedTargetPostion","setTargetPosition","spherical","Spherical","setFromVector3","newTheta","theta","newPhi","phi","setFromSpherical","setCameraPosition","applyAxisAngle","fov","updateProjectionMatrix","distanceBetweenCameraAndTarget","cameraNextPosition","currentCameraToNextCameraDirection","targetToCurrentCameraDirection","targetToNextCameraDirection","dotCurrentDirection","dotNextDirection","nextCameraToTargetSquaredDistance","distanceToSquared","isEmptyArray","nextPositiveOffset","positiveOffset","positivePathPosition","positiveDisplacement","positiveDirection","positiveDot","nextNegativeOffset","negativeOffset","negativePathPosition","negativeDisplacement","negativeDirection","negativeDot","pathExtremityMap","_getDirectionsMap","indexOfBestPath","bestDisplacement","bestDotProduct","isFromStart","forEach","pathExtremity","startDisplacement","startDirection","startDot","endDisplacement","endDirection","endDot","currentIndex","jump","maxDistance","reduce","start","end","objectsToClip","_objectsToClipBoundingBox","_clippingBox","translationSnap","scaleSnap","rotationSnap","_dragging","_firstPoint","_secondPoint","_mouseDisplacement","_offset","_raycaster","Raycaster","_pointerVector","_directionToMouse","_cameraPosition","_cameraDirection","_worldPosition","_worldRotation","Euler","_gizmos","_currentGizmo","_currentHandle","_events","change","mouseEnter","mouseLeave","mouseDown","mouseUp","objectChange","setMode","widthPlus","widthMinus","heightPlus","heightMinus","depthPlus","depthMinus","_objectsToClip","makeEmpty","expandByObject","getSize","round","updateClipping","applyClippingTo","getWorldPosition","altActive","altKey","ctrlActive","ctrlKey","metaActive","metaKey","shiftActive","shiftKey","_translateZ","_translateX","_translateY","_scaleZ","_scaleX","_scaleY","defaultPrevented","planeIntersect","intersectObjects","point","intersect","handle","currentHandleName","_translate","isRotateHandle","abs","_scale","clientRect","getBoundingClientRect","width","top","height","setFromCamera","deltaX","deltaZ","changeAmout","responseType","ResponseType","Json","bunchSize","requestAggregationTime","requestsConcurrency","objectType","_parseFilaire","_parsePoint","positions","JSON","parse","geojson","coordinates","acc","val","concat","numero_bloc","parseFloat","attribut","geometriesProvider","materialsProvider","autoFillObjects3D","_geometriesProvider","_materialsProvider","_autoFillObjects3D","fillObjects3D","_fillBaseObjectsData","background","Number","isInteger","Fog","near","far","FogExp2","density","overrideMaterial","autoUpdate","PerspectiveCamera","aspect","filmGauge","filmOffset","view","OrthographicCamera","bottom","AmbientLight","intensity","DirectionalLight","PointLight","decay","RectAreaLight","SpotLight","penumbra","HemisphereLight","groundColor","SkinnedMesh","drawMode","bindMode","bindMatrix","bindMatrixInverse","LOD","levels","LineLoop","Points","Sprite","Group","isNotEmptyArray","order","w","console","modelViewMatrix","fromArray","normalMatrix","matrixAutoUpdate","matrixWorldNeedsUpdate","layers","mask","castShadow","receiveShadow","frustumCulled","objectsArray","geometriesMap","_retrieveGeometriesOf","geometries","onEndDataFetching","materialsMap","mesh","applyGeometry","applyMaterials","_retrieveMaterialsOf","meshes","geometriesIds","filter","indexOf","read","materialsArray","materialsIds","apply","geometryId","error","materialIds","Array","isRotateGizmo","facing","arc","pickerGizmos","tube","radialSegments","tubularSegments"],"mappings":"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"}